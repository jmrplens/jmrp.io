[{"filePath":"/var/www/jmrp.io_astro/dist/blog/implementing-content-security-policy-nginx/index.html","messages":[{"ruleId":"parser-error","severity":2,"message":"failed to tokenize \"/ integrit...\", expected attribute, \">\" or \"/>\".","offset":34201,"line":132,"column":146,"size":1,"selector":null}],"errorCount":1,"warningCount":0,"source":"<!DOCTYPE html><html lang=\"en\"> <head><!-- Global Metadata --><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"><link rel=\"icon\" type=\"image/webp\" href=\"/_astro/favicon.Bl59ql0s_Z1PAOVL.webp\"><link rel=\"apple-touch-icon\" href=\"/_astro/apple-touch-icon.BniYwoUE_1qR5s1.webp\"><!-- DNS Prefetch for external resources --><link rel=\"dns-prefetch\" href=\"https://www.google.com\"><link rel=\"manifest\" href=\"/site.webmanifest\"><link rel=\"sitemap\" href=\"/sitemap.xml\"><link rel=\"alternate\" type=\"application/rss+xml\" title=\"JMRP Blog RSS Feed\" href=\"/rss.xml\"><meta name=\"generator\" content=\"Astro v5.16.6\"><meta name=\"theme-color\" content=\"#B509AC\"><meta name=\"robots\" content=\"index, follow\"><!-- SEO --><meta name=\"keywords\" content=\"R&#38;D, Embedded Systems, Acoustics, Software Engineer, Portfolio, CV, Metamaterials, Research\"><meta name=\"author\" content=\"José Manuel Requena Plens\"><meta name=\"fediverse:creator\" content=\"@jmrplens@mstdn.jmrp.io\"><link rel=\"canonical\" href=\"https://jmrp.io/blog/implementing-content-security-policy-nginx/\"><!-- Primary Meta Tags --><title>Mastering Content Security Policy (CSP) with Nginx: A Deep Dive | José Manuel Requena Plens</title><meta name=\"title\" content=\"Mastering Content Security Policy (CSP) with Nginx: A Deep Dive\"><meta name=\"description\" content=\"A comprehensive guide to implementing a strict Content Security Policy (CSP) on Nginx for both static and dynamic sites, covering nonces, hashes, and security best practices.\"><!-- Open Graph / Facebook --><meta property=\"og:type\" content=\"article\"><meta property=\"og:url\" content=\"https://jmrp.io/blog/implementing-content-security-policy-nginx/\"><meta property=\"og:title\" content=\"Mastering Content Security Policy (CSP) with Nginx: A Deep Dive\"><meta property=\"og:description\" content=\"A comprehensive guide to implementing a strict Content Security Policy (CSP) on Nginx for both static and dynamic sites, covering nonces, hashes, and security best practices.\"><meta property=\"og:image\" content=\"https://jmrp.io/_astro/mehome_landscape.Bz-Z1lGS_3nO6F.webp\"><meta property=\"og:image:width\" content=\"1200\"><meta property=\"og:image:height\" content=\"630\"><meta property=\"og:locale\" content=\"en_US\"><meta property=\"og:site_name\" content=\"José Manuel Requena Plens\"><!-- Article Specific OG Tags --><meta property=\"article:published_time\" content=\"2025-12-18T00:00:00.000Z\"><meta property=\"article:author\" content=\"José Manuel Requena Plens\"><meta property=\"article:tag\" content=\"nginx\"><meta property=\"article:tag\" content=\"security\"><meta property=\"article:tag\" content=\"csp\"><meta property=\"article:tag\" content=\"webdev\"><meta property=\"article:tag\" content=\"astro\"><!-- Twitter --><meta property=\"twitter:card\" content=\"summary_large_image\"><meta property=\"twitter:site\" content=\"@jmrplens\"><meta property=\"twitter:creator\" content=\"@jmrplens\"><meta property=\"twitter:url\" content=\"https://jmrp.io/blog/implementing-content-security-policy-nginx/\"><meta property=\"twitter:title\" content=\"Mastering Content Security Policy (CSP) with Nginx: A Deep Dive\"><meta property=\"twitter:description\" content=\"A comprehensive guide to implementing a strict Content Security Policy (CSP) on Nginx for both static and dynamic sites, covering nonces, hashes, and security best practices.\"><meta property=\"twitter:image\" content=\"https://jmrp.io/_astro/mehome_landscape.Bz-Z1lGS_3nO6F.webp\"><!-- JSON-LD --><script type=\"application/ld+json\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"https://jmrp.io/#website\",\"url\":\"https://jmrp.io\",\"name\":\"José M. Requena Plens\",\"description\":\"Academic and R&D Portfolio of José Manuel Requena Plens. Specializing in Embedded Systems, Acoustics, and Industrial Software Development.\",\"inLanguage\":\"en_US\",\"publisher\":{\"@type\":\"Person\",\"@id\":\"https://jmrp.io/#person\",\"name\":\"José Manuel Requena Plens\",\"url\":\"https://jmrp.io\",\"sameAs\":[\"https://twitter.com/jmrplens\"]}},{\"@type\":\"SiteNavigationElement\",\"name\":\"Home\",\"url\":\"https://jmrp.io/\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"CV\",\"url\":\"https://jmrp.io/cv\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Publications\",\"url\":\"https://jmrp.io/publications\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Repositories\",\"url\":\"https://jmrp.io/github\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Blog\",\"url\":\"https://jmrp.io/blog\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Services\",\"url\":\"https://jmrp.io/services\"},{\"@type\":\"BlogPosting\",\"@id\":\"https://jmrp.io/blog/implementing-content-security-policy-nginx#article\",\"headline\":\"Mastering Content Security Policy (CSP) with Nginx: A Deep Dive\",\"description\":\"A comprehensive guide to implementing a strict Content Security Policy (CSP) on Nginx for both static and dynamic sites, covering nonces, hashes, and security best practices.\",\"datePublished\":\"2025-12-18T00:00:00.000Z\",\"dateModified\":\"2025-12-18T00:00:00.000Z\",\"author\":{\"@type\":\"Person\",\"@id\":\"https://jmrp.io/#person\"},\"image\":\"https://jmrp.io/default-blog-cover.jpg\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https://jmrp.io/blog/implementing-content-security-policy-nginx\"}},{\"@type\":\"BreadcrumbList\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Blog\",\"item\":\"https://jmrp.io/blog\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Mastering Content Security Policy (CSP) with Nginx: A Deep Dive\",\"item\":\"https://jmrp.io/blog/implementing-content-security-policy-nginx\"}]}]}</script><script>\n            // Critical: Execute immediately to prevent FOUC\n            (function () {\n                const e = () => {\n                    if (\n                        typeof localStorage !== \"undefined\" &&\n                        localStorage.getItem(\"theme\")\n                    )\n                        return localStorage.getItem(\"theme\");\n                    return window.matchMedia(\"(prefers-color-scheme: light)\")\n                        .matches\n                        ? \"light\"\n                        : \"dark\";\n                };\n                const t = e();\n                document.documentElement.setAttribute(\"data-theme\", t);\n                if (t === \"light\") {\n                    document.documentElement.classList.add(\"light-mode\");\n                    document.documentElement.classList.remove(\"dark-mode\");\n                } else {\n                    document.documentElement.classList.add(\"dark-mode\");\n                    document.documentElement.classList.remove(\"light-mode\");\n                }\n            })();\n        </script><link rel=\"stylesheet\" href=\"/_astro/_slug_.DiOAQi95.css\" integrity=\"sha384-rwpS27cEV/5OO+XjtGT7RNbKonLSUHpWgri/68CS7DFcJ3TYe8cXBbq0L2DW4rBE\" crossorigin=\"anonymous\">\n<style>.callout[data-astro-cid-mrmim4ef]{display:flex;gap:1rem;padding:1rem 1.25rem;background:var(--callout-bg);border-left:4px solid var(--callout-color);border-radius:.5rem;margin:1.5rem 0}.icon[data-astro-cid-mrmim4ef]{color:var(--callout-color);flex-shrink:0;margin-top:.1rem}.content[data-astro-cid-mrmim4ef]{color:var(--color-text-body);font-size:.95rem;line-height:1.6}.content[data-astro-cid-mrmim4ef] p:last-child{margin-bottom:0}.content[data-astro-cid-mrmim4ef] p:first-child{margin-top:0}\nui-tabs{display:block;margin:1.5rem 0;background:var(--color-bg-subtle);border:var(--border-1);border-radius:var(--radius-md);overflow:hidden;position:relative}ui-tabs .tab-headers{display:flex;background:var(--color-bg-secondary);border-bottom:var(--border-1);overflow-x:auto;overflow-y:hidden;scrollbar-width:thin}ui-tabs .tab-headers::-webkit-scrollbar{height:4px}ui-tabs .tab-headers button{appearance:none;background:transparent;border:none;padding:.75rem 1.25rem;color:var(--color-text-muted);font-size:.9rem;font-weight:var(--fw-medium);cursor:pointer;transition:all .2s;border-bottom:2px solid transparent;white-space:nowrap;flex-shrink:0;border-right:var(--border-1)}ui-tabs .tab-headers button:hover{color:var(--color-text-body);background:#ffffff05}ui-tabs .tab-headers button[aria-selected=true]{color:var(--color-primary);border-bottom-color:var(--color-primary);background:var(--color-bg-subtle);margin-bottom:-1px}ui-tabs .tab-content{padding:0;max-width:100%;position:relative}.tab-panel{padding:1.5rem}.tab-panel.no-padding{padding:0}ui-tabs :global(pre),ui-tabs :global(.expressive-code),ui-tabs :global(.mermaid){max-width:100%!important;overflow-x:auto!important}ui-tabs img,ui-tabs svg{max-width:100%;height:auto}\n.tab-panel[data-astro-cid-nsrqe3q4]{position:relative}.tab-panel[data-astro-cid-nsrqe3q4] .panel-copy-button{position:absolute;top:.5rem;right:.5rem;z-index:10}.tab-panel[data-astro-cid-nsrqe3q4] .expressive-code .copy{display:none!important}\n</style>\n<link rel=\"stylesheet\" href=\"/_astro/_slug_.rqAQJTsE.css\" integrity=\"sha384-XyhFlbhFiwU+7U7btu+NULThYHNtd3UbBL7848dqcQzCYbnTTccV9m3ZsEKsgHAo\" crossorigin=\"anonymous\">\n<style>.copy-button[data-astro-cid-74lkg7sv]{position:absolute;top:.5rem;right:.5rem;background-color:var(--color-bg-subtle, rgba(255, 255, 255, .1));border:var(--border-1, 1px solid rgba(255, 255, 255, .1));border-radius:4px;padding:.3rem .5rem;cursor:pointer;opacity:.8;transition:all .2s ease;display:flex;align-items:center;justify-content:center;min-width:32px;min-height:32px;z-index:10}.copy-button[data-astro-cid-74lkg7sv]:hover{opacity:1;background-color:var(--color-bg-secondary, #222)}.copy-button[data-astro-cid-74lkg7sv]:active{transform:scale(.95)}.copy-icon[data-astro-cid-74lkg7sv],.success-icon[data-astro-cid-74lkg7sv]{font-size:1.2rem;width:1.2rem;height:1.2rem;color:var(--color-text-muted, #888);display:block}.success-icon[data-astro-cid-74lkg7sv]{color:var(--color-success, #2ea043)}.hidden[data-astro-cid-74lkg7sv]{display:none}\n</style><style>.compare-code-wrapper[data-astro-cid-s2ie7g3f]{display:grid;grid-template-columns:1fr;gap:1.5rem;margin:2rem 0}@media(min-width:768px){.compare-code-wrapper[data-astro-cid-s2ie7g3f]{grid-template-columns:1fr 1fr}}.compare-block[data-astro-cid-s2ie7g3f]{border-radius:var(--radius-md);overflow:hidden;border:var(--border-1)}.compare-block[data-astro-cid-s2ie7g3f].bad{border-color:#dc2626;background-color:#dc26260d}.compare-block[data-astro-cid-s2ie7g3f].good{border-color:#16a34a;background-color:#16a34a0d}:root[data-theme=dark] .compare-block[data-astro-cid-s2ie7g3f].bad{border-color:#b91c1c;background-color:#b91c1c0d}:root[data-theme=dark] .compare-block[data-astro-cid-s2ie7g3f].good{border-color:#15803d;background-color:#15803d0d}.header[data-astro-cid-s2ie7g3f]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;font-weight:700;font-size:.9rem;border-bottom:1px solid inherit}.bad[data-astro-cid-s2ie7g3f] .header[data-astro-cid-s2ie7g3f]{background-color:#dc2626;color:#fff}.good[data-astro-cid-s2ie7g3f] .header[data-astro-cid-s2ie7g3f]{background-color:#047857;color:#fff}:root[data-theme=dark] .bad[data-astro-cid-s2ie7g3f] .header[data-astro-cid-s2ie7g3f]{background-color:#b91c1c}:root[data-theme=dark] .good[data-astro-cid-s2ie7g3f] .header[data-astro-cid-s2ie7g3f]{background-color:#059669}.icon[data-astro-cid-s2ie7g3f]{font-size:1.25rem}.content[data-astro-cid-s2ie7g3f]{position:relative;padding:0;font-size:.9rem}.content[data-astro-cid-s2ie7g3f] .compare-copy-button{position:absolute;top:.5rem;right:.5rem;z-index:10}.content[data-astro-cid-s2ie7g3f] pre{margin:0!important;border:none!important;background:transparent!important;border-radius:0!important}.content[data-astro-cid-s2ie7g3f] .expressive-code{margin:0!important;border:none!important;border-radius:0!important}.content[data-astro-cid-s2ie7g3f] .expressive-code .copy{display:none!important}\n</style><style>.file-content-wrapper[data-astro-cid-q77ummtg]{border:var(--border-1);border-radius:var(--radius-md);margin:1.5rem 0;overflow:hidden;background-color:var(--color-bg-secondary)}.file-header[data-astro-cid-q77ummtg]{display:flex;align-items:center;justify-content:space-between;gap:.5rem;padding:.5rem 1rem;background-color:var(--color-bg-subtle);border-bottom:var(--border-1);font-family:var(--font-mono);font-size:.85rem;color:var(--color-text-muted);min-height:48px}.file-info[data-astro-cid-q77ummtg]{display:flex;align-items:center;gap:.5rem}.file-icon[data-astro-cid-q77ummtg]{font-size:1.3rem}.file-name[data-astro-cid-q77ummtg]{font-weight:500}.file-body[data-astro-cid-q77ummtg] pre{margin:0!important;border-radius:0 0 var(--radius-md) var(--radius-md)!important;border:none!important;box-shadow:none!important}.file-body[data-astro-cid-q77ummtg] .expressive-code .copy{display:none!important}.file-header-copy-btn{position:static!important;background-color:transparent!important;border:1px solid var(--color-border)!important;opacity:.7}.file-header-copy-btn:hover{opacity:1;background-color:var(--color-bg-secondary)!important;border-color:var(--color-text-muted)!important}\n</style><style>.key-point[data-astro-cid-qhz4ifqf]{display:flex;align-items:flex-start;gap:1rem;background-color:var(--color-bg-subtle);border:var(--border-1);border-left:4px solid var(--color-primary);border-radius:var(--radius-md);padding:1.25rem;margin:1.5rem 0;color:var(--color-text-body)}.icon-wrapper[data-astro-cid-qhz4ifqf]{color:var(--color-primary);font-size:1.5rem;margin-top:.1rem}.content-wrapper[data-astro-cid-qhz4ifqf]{flex:1}.content-wrapper[data-astro-cid-qhz4ifqf] p{margin:0}.content-wrapper[data-astro-cid-qhz4ifqf] p:not(:last-child){margin-bottom:1rem}\n</style><style nonce=\"NGINX_CSP_NONCE\">.ec-4bcb7326{--0:#E1E4E8;--1:#24292E}.ec-8c20c241{--0:#85E89D;--1:#1E7734}.ec-a8d21843{--0:#B392F0;--1:#6F42C1}.ec-8ce8e394{--0:#9ECBFF;--1:#032F62}.ec-60e18f03{--0:#99A0A6;--1:#616972}.ec-3f830706{--0:#F97583;--1:#BF3441}.ec-1db2f9ab{--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic}.ec-efe5505b{--0:#79B8FF;--1:#005CC5}.ec-e8e3777f{--callout-color: var(--color-primary);--callout-bg: rgba(59, 130, 246, 0.1);}.ec-e985ffc4{--callout-color: #f59e0b;--callout-bg: rgba(245, 158, 11, 0.1);}.ec-5d53542d{--callout-color: #10b981;--callout-bg: rgba(16, 185, 129, 0.1);}</style></head> <body> <a href=\"#main-content\" class=\"skip-link\">Skip to content</a> <header data-astro-cid-3ef6ksr2> <nav class=\"container\" aria-label=\"Main Navigation\" data-astro-cid-3ef6ksr2> <a href=\"/\" class=\"logo\" aria-label=\"Home - JMRP\" data-astro-cid-3ef6ksr2> <span class=\"text-mono\" data-astro-cid-3ef6ksr2>&lt;JMRP /&gt;</span> </a> <div class=\"nav-right\" data-astro-cid-3ef6ksr2> <button id=\"menu-toggle\" type=\"button\" aria-label=\"Toggle Navigation\" aria-expanded=\"false\" class=\"menu-toggle\" data-astro-cid-3ef6ksr2> <span class=\"icon-container\" data-astro-cid-3ef6ksr2> <svg width=\"0.88em\" height=\"1em\" class=\"icon-bars\" data-astro-cid-3ef6ksr2=\"true\" data-icon=\"fa-solid:bars\">   <symbol id=\"ai:fa-solid:bars\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16m0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16m0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16\"/></symbol><use href=\"#ai:fa-solid:bars\"></use>  </svg> <svg width=\"0.69em\" height=\"1em\" class=\"icon-times\" data-astro-cid-3ef6ksr2=\"true\" data-icon=\"fa-solid:times\">   <symbol id=\"ai:fa-solid:times\" viewBox=\"0 0 352 512\"><path fill=\"currentColor\" d=\"m242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28L75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256L9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48z\"/></symbol><use href=\"#ai:fa-solid:times\"></use>  </svg> </span> </button> <ul id=\"nav-links\" class=\"nav-links\" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href=\"/\" data-astro-cid-3ef6ksr2>Home</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/cv\" data-astro-cid-3ef6ksr2>CV</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/publications\" data-astro-cid-3ef6ksr2>Publications</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/github\" data-astro-cid-3ef6ksr2>Repositories</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/blog\" data-astro-cid-3ef6ksr2>Blog</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/services\" data-astro-cid-3ef6ksr2>Services</a> </li> </ul> <button id=\"theme-toggle\" type=\"button\" class=\"theme-toggle\" aria-label=\"Toggle Dark Mode\" data-astro-cid-x3pjskd3> <span class=\"icon-sun\" data-astro-cid-x3pjskd3><svg width=\"1em\" height=\"1em\" data-astro-cid-x3pjskd3=\"true\" data-icon=\"fa-solid:sun\">   <symbol id=\"ai:fa-solid:sun\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96s96-43.1 96-96s-43.1-96-96-96m246.4 80.5l-94.7-47.3l33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5l-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4l-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3l-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5l47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7l100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4l94.7-47.3c13-6.5 13-24.7.2-31.1m-155.9 106c-49.9 49.9-131.1 49.9-181 0s-49.9-131.1 0-181s131.1-49.9 181 0s49.9 131.1 0 181\"/></symbol><use href=\"#ai:fa-solid:sun\"></use>  </svg></span> <span class=\"icon-moon\" data-astro-cid-x3pjskd3><svg width=\"1em\" height=\"1em\" data-astro-cid-x3pjskd3=\"true\" data-icon=\"fa-solid:moon\">   <symbol id=\"ai:fa-solid:moon\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M283.211 512c78.962 0 151.079-35.925 198.857-94.792c7.068-8.708-.639-21.43-11.562-19.35c-124.203 23.654-238.262-71.576-238.262-196.954c0-72.222 38.662-138.635 101.498-174.394c9.686-5.512 7.25-20.197-3.756-22.23A258 258 0 0 0 283.211 0c-141.309 0-256 114.511-256 256c0 141.309 114.511 256 256 256\"/></symbol><use href=\"#ai:fa-solid:moon\"></use>  </svg></span> </button>  <script src=\"/scripts/theme-toggle.js\" defer integrity=\"sha384-M6hHR0O8w+S63LqO9ItN9zQlQdmiaYlOvLLYHYLnm3iXQ4ZsFxSNLYvy1/14IgjX\" crossorigin=\"anonymous\"></script> </div> </nav> </header> <script src=\"/scripts/header.js\" defer integrity=\"sha384-Ntm3HR4so5CFACgs5lCmTess3N9BzWTqnZxLITG7D0Hn11Hor3eLdasEsegKvG0b\" crossorigin=\"anonymous\"></script>  <main id=\"main-content\" data-pagefind-body>  <article class=\"post-content\" data-astro-cid-7jjqptxk> <header class=\"post-header\" data-astro-cid-7jjqptxk> <div class=\"content-wrapper\" data-astro-cid-7jjqptxk> <a href=\"/blog\" class=\"back-link\" data-astro-cid-7jjqptxk> <svg width=\"1em\" height=\"1em\" data-astro-cid-7jjqptxk=\"true\" data-icon=\"mdi:arrow-left\">   <symbol id=\"ai:mdi:arrow-left\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M20 11v2H8l5.5 5.5l-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5L8 11z\"/></symbol><use href=\"#ai:mdi:arrow-left\"></use>  </svg> Back to Blog\n</a> <div class=\"meta\" data-astro-cid-7jjqptxk> <time datetime=\"2025-12-18T00:00:00.000Z\" data-astro-cid-7jjqptxk> December 18, 2025 </time> <span class=\"separator\" data-astro-cid-7jjqptxk>•</span> <div class=\"tags\" data-astro-cid-7jjqptxk> <span class=\"tag\" data-astro-cid-7jjqptxk>#nginx</span><span class=\"tag\" data-astro-cid-7jjqptxk>#security</span><span class=\"tag\" data-astro-cid-7jjqptxk>#csp</span><span class=\"tag\" data-astro-cid-7jjqptxk>#webdev</span><span class=\"tag\" data-astro-cid-7jjqptxk>#astro</span> </div> </div> <h1 data-astro-cid-7jjqptxk>Mastering Content Security Policy (CSP) with Nginx: A Deep Dive</h1> <p class=\"lead\" data-astro-cid-7jjqptxk>A comprehensive guide to implementing a strict Content Security Policy (CSP) on Nginx for both static and dynamic sites, covering nonces, hashes, and security best practices.</p> </div> </header> <div class=\"layout-grid content-wrapper\" data-astro-cid-7jjqptxk> <aside class=\"toc-sidebar\" data-astro-cid-7jjqptxk> <nav class=\"toc\" aria-label=\"Table of Contents\" data-astro-cid-7jjqptxk> <h2 data-astro-cid-7jjqptxk>Table of Contents</h2> <ul data-astro-cid-7jjqptxk> <li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#why-do-we-need-csp-the-threat-landscape\" data-astro-cid-7jjqptxk> Why Do We Need CSP? The Threat Landscape </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#1-cross-site-scripting-xss\" data-astro-cid-7jjqptxk> 1. Cross-Site Scripting (XSS) </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#2-data-injection--exfiltration\" data-astro-cid-7jjqptxk> 2. Data Injection &amp; Exfiltration </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#3-clickjacking-ui-redressing\" data-astro-cid-7jjqptxk> 3. Clickjacking (UI Redressing) </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#4-packet-sniffing-mixed-content\" data-astro-cid-7jjqptxk> 4. Packet Sniffing (Mixed Content) </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#the-challenge-static-content-vs-dynamic-security\" data-astro-cid-7jjqptxk> The Challenge: Static Content vs. Dynamic Security </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#the-solution-nginx-sub-filter--placeholders\" data-astro-cid-7jjqptxk> The Solution: Nginx Sub-Filter &amp; Placeholders </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#1-the-placeholder\" data-astro-cid-7jjqptxk> 1. The Placeholder </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#2-the-injection-nginx\" data-astro-cid-7jjqptxk> 2. The Injection (Nginx) </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#the-transformation\" data-astro-cid-7jjqptxk> The Transformation </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#anatomy-of-a-strict-csp\" data-astro-cid-7jjqptxk> Anatomy of a Strict CSP </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#1-the-safety-net-default-src\" data-astro-cid-7jjqptxk> 1. The Safety Net: default-src </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#2-the-danger-zone-script-src\" data-astro-cid-7jjqptxk> 2. The Danger Zone: script-src </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#3-styling-style-src\" data-astro-cid-7jjqptxk> 3. Styling: style-src </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#4-external-integrations--connections\" data-astro-cid-7jjqptxk> 4. External Integrations &amp; Connections </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#common-pitfalls--bad-directives\" data-astro-cid-7jjqptxk> Common Pitfalls &amp; “Bad” Directives </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#sha-hashes-trusting-the-immutable\" data-astro-cid-7jjqptxk> SHA Hashes: Trusting the Immutable </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#validation--testing\" data-astro-cid-7jjqptxk> Validation &amp; Testing </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#my-results\" data-astro-cid-7jjqptxk> My Results </a> </li> </ul> </nav> <button class=\"desktop-toc-btn toc-trigger\" aria-label=\"Open Table of Contents\" data-astro-cid-7jjqptxk> <svg width=\"1em\" height=\"1em\" data-astro-cid-7jjqptxk=\"true\" data-icon=\"mdi:format-list-bulleted\">   <symbol id=\"ai:mdi:format-list-bulleted\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M7 5h14v2H7zm0 8v-2h14v2zM4 4.5A1.5 1.5 0 0 1 5.5 6A1.5 1.5 0 0 1 4 7.5A1.5 1.5 0 0 1 2.5 6A1.5 1.5 0 0 1 4 4.5m0 6A1.5 1.5 0 0 1 5.5 12A1.5 1.5 0 0 1 4 13.5A1.5 1.5 0 0 1 2.5 12A1.5 1.5 0 0 1 4 10.5M7 19v-2h14v2zm-3-2.5A1.5 1.5 0 0 1 5.5 18A1.5 1.5 0 0 1 4 19.5A1.5 1.5 0 0 1 2.5 18A1.5 1.5 0 0 1 4 16.5\"/></symbol><use href=\"#ai:mdi:format-list-bulleted\"></use>  </svg> <span data-astro-cid-7jjqptxk>Contents</span> </button> </aside> <div class=\"prose\" data-astro-cid-7jjqptxk> <p>In the modern web, security cannot be an afterthought. Cross-Site Scripting (XSS) remains one of the most prevalent vulnerabilities, allow and execute. <strong><a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP\" rel=\"external noopener\" target=\"_blank\">Content Security Policy (CSP)</a></strong> is the most effective countermeasure against these attacks, acting as a whitelist that tells the browser exactly which resources are allowed to load and execute.</p>\n<p>However, implementing a strict CSP—especially on static sites generated by tools like <strong>Astro</strong>, <strong>Next.js</strong>, <strong>Jekyll</strong>, or <strong>Hugo</strong>—can be challenging. How do you use cryptographic nonces when your HTML is pre-built?</p>\n<p>In this deep dive, I will explain how to implement an A+ rated CSP using <a href=\"https://nginx.org/en/docs/http/ngx_http_sub_module.html\" rel=\"external noopener\" target=\"_blank\">Nginx</a>, specifically focusing on the advanced techniques used on this very website (<code>jmrp.io</code>).</p>\n<h2 id=\"why-do-we-need-csp-the-threat-landscape\">Why Do We Need CSP? The Threat Landscape</h2>\n<p>Before diving into the code, it’s crucial to understand <em>what</em> we are protecting against. CSP is not just a “nice to have”; it is a critical defense layer against several specific types of attacks.</p>\n<h3 id=\"1-cross-site-scripting-xss\">1. <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Cross-site_scripting\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Learn more about Cross-Site Scripting (XSS) on MDN Web Docs\">Cross-Site Scripting (XSS)</a></h3>\n<p><strong>What is it?</strong> XSS occurs when an attacker injects malicious code (usually JavaScript) into a legitimate website.</p>\n<ul>\n<li><strong>The Risk:</strong> If an attacker can execute their script in your user’s browser, they can steal session cookies (account hijacking), redirect the user to a phishing site, or perform actions on the user’s behalf.</li>\n<li><strong>How CSP Helps:</strong> By defining a <code>script-src</code> whitelist, CSP tells the browser: “Only execute scripts from <em>this</em> domain or scripts that have <em>this</em> specific nonce.” Even if an attacker injects <code>&lt;script&gt;alert(&#39;Hacked&#39;)&lt;/script&gt;</code>, the browser will refuse to run it because it lacks the valid nonce.</li>\n</ul>\n<h3 id=\"2-data-injection--exfiltration\">2. Data Injection &amp; <a href=\"https://www.cloudflare.com/learning/security/what-is-data-exfiltration/\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Learn more about Data Exfiltration on Cloudflare Learning\">Exfiltration</a></h3>\n<p><strong>What is it?</strong> Attackers might try to load external resources (like tracking pixels) or send sensitive data (like keystrokes) to their own servers.</p>\n<ul>\n<li><strong>The Risk:</strong> Unsolicited tracking or theft of private user data entered into forms.</li>\n<li><strong>How CSP Helps:</strong> Directives like <code>connect-src</code> and <code>img-src</code> limit where the browser can send data. If an attacker tries to send your credit card number to <code>malicious-site.com</code>, CSP blocks the connection.</li>\n</ul>\n<h3 id=\"3-clickjacking-ui-redressing\">3. <a href=\"https://owasp.org/www-community/attacks/Clickjacking\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Read about Clickjacking attacks on OWASP\">Clickjacking</a> (UI Redressing)</h3>\n<p><strong>What is it?</strong> An attacker embeds your website inside an invisible <code>&lt;iframe&gt;</code> on their own site. They then trick users into clicking buttons on your site (like “Delete Account” or “Transfer Money”) thinking they are clicking something else.</p>\n<ul>\n<li><strong>How CSP Helps:</strong> The <code>frame-ancestors</code> directive effectively replaces the older <code>X-Frame-Options</code> header. Setting it to <code>&#39;none&#39;</code> ensures your site cannot be embedded anywhere, completely neutralizing this attack.</li>\n</ul>\n<h3 id=\"4-packet-sniffing-mixed-content\">4. Packet Sniffing (<a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Defenses/Mixed_content\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Learn about Mixed Content security on MDN Web Docs\">Mixed Content</a>)</h3>\n<p><strong>What is it?</strong> Loading insecure (HTTP) resources on a secure (HTTPS) page.</p>\n<ul>\n<li><strong>The Risk:</strong> An attacker on the same network (like a public Wi-Fi) can see or modify the insecure content.</li>\n<li><strong>How CSP Helps:</strong> The <code>upgrade-insecure-requests</code> directive forces the browser to try and load all resources over HTTPS, even if the code specifically asks for HTTP.</li>\n</ul>\n<hr/>\n<h2 id=\"the-challenge-static-content-vs-dynamic-security\">The Challenge: Static Content vs. Dynamic Security</h2>\n<p>A robust CSP relies on <strong>nonces</strong> (numbers used once)—random, unpredictable tokens generated for <em>every single request</em>.</p>\n<ol>\n<li>The server generates a token: <code>nonce=&quot;abc123...&quot;</code>.</li>\n<li>The server sends this token in the <code>Content-Security-Policy</code> header.</li>\n<li>The server puts the <em>same</em> token on <code>&lt;script&gt;</code> tags: <code>&lt;script nonce=&quot;abc123...&quot;&gt;</code>.</li>\n<li>The browser executes the script only if the header and tag match.</li>\n</ol>\n<p><strong>The Problem:</strong> Static Site Generators (SSG) build HTML files <em>once</em> at build time. They cannot predict the random nonce that Nginx will generate weeks later when a user visits the site.</p>\n<h2 id=\"the-solution-nginx-sub-filter--placeholders\">The Solution: Nginx Sub-Filter &amp; Placeholders</h2>\n<p>The elegant solution used on <code>jmrp.io</code> involves a partnership between the static build and the web server.</p>\n<h3 id=\"1-the-placeholder\">1. The Placeholder</h3>\n<p>In our source code (Astro, React, plain HTML), we don’t use a random number. We use a known, static string as a placeholder. I use <code>NGINX_NONCE_CSP</code>.</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: src/layouts/BaseLayout.astro\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"simple-icons:astro\">   <symbol id=\"ai:simple-icons:astro\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M8.358 20.162c-1.186-1.07-1.532-3.316-1.038-4.944c.856 1.026 2.043 1.352 3.272 1.535c1.897.283 3.76.177 5.522-.678c.202-.098.388-.229.608-.36c.166.473.209.95.151 1.437c-.14 1.185-.738 2.1-1.688 2.794c-.38.277-.782.525-1.175.787c-1.205.804-1.531 1.747-1.078 3.119l.044.148a3.16 3.16 0 0 1-1.407-1.188a3.3 3.3 0 0 1-.544-1.815c-.004-.32-.004-.642-.048-.958c-.106-.769-.472-1.113-1.161-1.133c-.707-.02-1.267.411-1.415 1.09c-.012.053-.028.104-.045.165zm-5.961-4.445s3.24-1.575 6.49-1.575l2.451-7.565c.092-.366.36-.614.662-.614s.57.248.662.614l2.45 7.565c3.85 0 6.491 1.575 6.491 1.575L16.088.727C15.93.285 15.663 0 15.303 0H8.697c-.36 0-.615.285-.784.727z\"/></symbol><use href=\"#ai:simple-icons:astro\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>src/layouts/BaseLayout.astro</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <symbol id=\"ai:mdi:clipboard-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-7 0a1 1 0 0 1 1 1a1 1 0 0 1-1 1a1 1 0 0 1-1-1a1 1 0 0 1 1-1M7 7h10V5h2v14H5V5h2z\"/></symbol><use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <symbol id=\"ai:mdi:check\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z\"/></symbol><use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.gmn06.css\"/ integrity=\"sha384-EvHBk7y/jI5X+qm7VnzfLWepclRlgAWQZD7xfwjGdJOb58CEIXGsErTVXjAJLdik\" crossorigin=\"anonymous\"><script type=\"module\" src=\"/_astro/ec.g1fg5.js\" integrity=\"sha384-M8ULzGSeei5Lc7d69Yvkm78ffAvmiqFZWToXjWVNFj1ueVvYDx5gZpo/aRwGXOLr\" crossorigin=\"anonymous\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"html\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;</span><span class=\"ec-8c20c241\">script</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">is:inline</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">nonce</span><span class=\"ec-4bcb7326\">=</span><span class=\"ec-8ce8e394\">&quot;NGINX_NONCE_CSP&quot;</span><span class=\"ec-4bcb7326\">&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span class=\"ec-60e18f03\">// Your critical inline script console.log(&quot;Hello from a secure inline</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">  </span></span><span class=\"ec-4bcb7326\">script</span><span class=\"ec-3f830706\">!</span><span class=\"ec-8ce8e394\">&quot;)</span><span class=\"ec-1db2f9ab\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;/</span><span class=\"ec-8c20c241\">script</span><span class=\"ec-4bcb7326\">&gt;</span></div></div></code></pre></figure></div> </div> </div> \n<h3 id=\"2-the-injection-nginx\">2. The Injection (Nginx)</h3>\n<p>We configure Nginx to generate a request ID and search-and-replace our placeholder with this ID before sending the response to the user.</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: /etc/nginx/sites-available/jmrp.io.conf\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <symbol id=\"ai:devicon:nginx\" viewBox=\"0 0 128 128\"><path fill=\"#090\" d=\"M24.5 50.5c-1.5 0-2.5 1.2-2.5 2.7v14.1l-15.9-16c-.8-.8-2.2-1-3.2-.6S1 52.1 1 53.2v20.7c0 1.5 1.5 2.7 3 2.7s3-1.2 3-2.7V59.8l16.1 16c.5.5 1.2.8 1.9.8c.3 0 .4-.1.7-.2c1-.4 1.3-1.4 1.3-2.5V53.3c0-1.5-1-2.8-2.5-2.8m19.7 11.8c-1.4 0-2.7 1.4-2.7 2.8s1.3 2.8 2.7 2.8l6.6.4l-1.5 3.7h-8.5l-4.2-7.9l4.3-8.1H50l2.1 4h5.5L54 52.1l-.8-1.1H37.6l-.7 1.2L31 62.5l-.7 1.3l.7 1.3l5.8 10.3l.8 1.6h15.1l.7-1.7l4.3-9l1.9-4.3h-4.4zM65 50.5c-1.4 0-3 1.3-3 2.7V60h6v-6.7c0-1.5-1.6-2.8-3-2.8m30.4.3c-1-.4-2.4-.2-3.1.6L76 67.4V53.3c0-1.5-1-2.7-2.5-2.7S71 51.8 71 53.3V74c0 1.1.7 2.1 1.7 2.5c.3.1.7.2 1 .2c.7 0 1.6-.3 2.1-.8l16.2-16V74c0 1.5 1 2.7 2.5 2.7S97 75.5 97 74V53.3c0-1.1-.6-2.1-1.6-2.5m21.8 12.8l8.4-8.4c1.1-1.1 1.1-2.8 0-3.8c-1.1-1.1-2.8-1.1-3.8 0l-8.4 8.4l-8.4-8.4c-1.1-1.1-2.8-1.1-3.8 0c-1.1 1.1-1.1 2.8 0 3.8l8.4 8.4l-8.4 8.4c-1.1 1.1-1.1 2.8 0 3.8c.5.5 1.2.8 1.9.8s1.4-.3 1.9-.8l8.4-8.4l8.4 8.4c.5.5 1.2.8 1.9.8s1.4-.3 1.9-.8c1.1-1.1 1.1-2.8 0-3.8zM62 73.9c0 1.4 1.5 2.7 3 2.7c1.4 0 3-1.3 3-2.7V62h-6z\"/></symbol><use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>/etc/nginx/sites-available/jmrp.io.conf</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">server</span><span class=\"ec-4bcb7326\"> {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># 1. Use the unique Request ID as our CSP Nonce</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># This ID is unique per request and random enough for CSP</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">set </span><span class=\"ec-4bcb7326\">$cspNonce $request_id;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># 2. Configure the sub_filter module</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># This replaces the string &#39;NGINX_NONCE_CSP&#39; with the actual variable content</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># Note: Requires ngx_http_sub_module (usually included in full/extras builds)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">sub_filter_once </span><span class=\"ec-efe5505b\">off</span><span class=\"ec-4bcb7326\">;             </span><span class=\"ec-60e18f03\"># Replace all occurrences</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">sub_filter_types </span><span class=\"ec-4bcb7326\">*;              </span><span class=\"ec-60e18f03\"># Apply to all content types (JS, HTML, etc.)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">sub_filter </span><span class=\"ec-4bcb7326\">NGINX_NONCE_CSP $cspNonce;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># 3. Add the CSP Header</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># We reference the same variable ($cspNonce) in the header</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">add_header </span><span class=\"ec-4bcb7326\">Content-Security-Policy </span><span class=\"ec-8ce8e394\">&quot;script-src &#39;self&#39; &#39;nonce-$</span><span class=\"ec-4bcb7326\">cspNonce</span><span class=\"ec-8ce8e394\">&#39; ...&quot;</span><span class=\"ec-4bcb7326\"> always;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<div class=\"key-point\" role=\"note\" data-astro-cid-qhz4ifqf> <div class=\"icon-wrapper\" aria-hidden=\"true\" data-astro-cid-qhz4ifqf> <svg width=\"1em\" height=\"1em\" class=\"key-icon\" data-astro-cid-qhz4ifqf=\"true\" data-icon=\"mdi:check-decagram\">   <symbol id=\"ai:mdi:check-decagram\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"m23 12l-2.44-2.78l.34-3.68l-3.61-.82l-1.89-3.18L12 3L8.6 1.54L6.71 4.72l-3.61.81l.34 3.68L1 12l2.44 2.78l-.34 3.69l3.61.82l1.89 3.18L12 21l3.4 1.46l1.89-3.18l3.61-.82l-.34-3.68zm-13 5l-4-4l1.41-1.41L10 14.17l6.59-6.59L18 9z\"/></symbol><use href=\"#ai:mdi:check-decagram\"></use>  </svg> </div> <div class=\"content-wrapper\" data-astro-cid-qhz4ifqf> <p><strong>Why this works:</strong> The browser receives a valid HTML file with a matching nonce in the header and the body, completely unaware that Nginx modified the HTML on the fly. This allows us to have the performance of a static site with the security of a dynamic one.</p> </div> </div> \n<h3 id=\"the-transformation\">The Transformation</h3>\n<p>Here is what happens “on the wire” when Nginx processes a request:</p>\n<script lang=\"ts\">\n    class TabsComponent extends HTMLElement {\n        connectedCallback() {\n            // Use requestAnimationFrame to ensure the children are fully parsed\n            // connectedCallback fires before child elements are available\n            requestAnimationFrame(() => {\n                this.initializeTabs();\n            });\n        }\n\n        initializeTabs() {\n            const headers = this.querySelector(\".tab-headers\");\n            const panels = this.querySelectorAll(\".tab-panel\");\n\n            if (!headers || panels.length === 0) return;\n\n            // Generate unique IDs for ARIA\n            const uniqueId = Math.random().toString(36).substring(2, 9);\n\n            panels.forEach((panel, index) => {\n                const title =\n                    panel.getAttribute(\"data-label\") || `Tab ${index + 1}`;\n                const panelId = `panel-${uniqueId}-${index}`;\n                const tabId = `tab-${uniqueId}-${index}`;\n\n                // Setup Panel ARIA\n                panel.setAttribute(\"id\", panelId);\n                panel.setAttribute(\"role\", \"tabpanel\");\n                panel.setAttribute(\"aria-labelledby\", tabId);\n\n                // Create Tab Button\n                const button = document.createElement(\"button\");\n                button.textContent = title;\n                button.id = tabId;\n                button.role = \"tab\";\n                button.setAttribute(\"aria-controls\", panelId);\n                button.setAttribute(\n                    \"aria-selected\",\n                    index === 0 ? \"true\" : \"false\",\n                );\n                button.setAttribute(\"tabindex\", index === 0 ? \"0\" : \"-1\");\n\n                button.addEventListener(\"click\", () => {\n                    // Deactivate all\n                    headers.querySelectorAll(\"button\").forEach((b) => {\n                        b.setAttribute(\"aria-selected\", \"false\");\n                        b.setAttribute(\"tabindex\", \"-1\");\n                    });\n                    panels.forEach((p) => {\n                        if (p instanceof HTMLElement) p.style.display = \"none\";\n                    });\n\n                    // Activate clicked\n                    button.setAttribute(\"aria-selected\", \"true\");\n                    button.setAttribute(\"tabindex\", \"0\");\n\n                    // Show corresponding panel\n                    if (panel instanceof HTMLElement)\n                        panel.style.display = \"block\";\n                });\n\n                // Keyboard navigation\n                button.addEventListener(\"keydown\", (e) => {\n                    if (e.key === \"ArrowRight\") {\n                        e.preventDefault();\n                        const next = button.nextElementSibling;\n                        if (next instanceof HTMLElement) {\n                            next.click();\n                            next.focus();\n                        }\n                    }\n                    if (e.key === \"ArrowLeft\") {\n                        e.preventDefault();\n                        const prev = button.previousElementSibling;\n                        if (prev instanceof HTMLElement) {\n                            prev.click();\n                            prev.focus();\n                        }\n                    }\n                });\n\n                headers.appendChild(button);\n\n                // Initial state - hide all except first\n                if (panel instanceof HTMLElement) {\n                    panel.style.display = index === 0 ? \"block\" : \"none\";\n                }\n            });\n        }\n    }\n\n    customElements.define(\"ui-tabs\", TabsComponent);\n</script> <ui-tabs> <div class=\"tab-headers\" role=\"tablist\" aria-label=\"Tabbed Content\"></div> <div class=\"tab-content\"> <div class=\"tab-panel copy-container\" data-label=\"Before (File on Disk)\" data-astro-cid-nsrqe3q4> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"html\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\">&lt;!-- What is stored in /var/www/... --&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;</span><span class=\"ec-8c20c241\">script</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">nonce</span><span class=\"ec-4bcb7326\">=</span><span class=\"ec-8ce8e394\">&quot;NGINX_NONCE_CSP&quot;</span><span class=\"ec-4bcb7326\">&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">  </span></span><span class=\"ec-4bcb7326\">console.</span><span class=\"ec-a8d21843\">log</span><span class=\"ec-4bcb7326\">(</span><span class=\"ec-8ce8e394\">&#39;Static Placeholder&#39;</span><span class=\"ec-4bcb7326\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;/</span><span class=\"ec-8c20c241\">script</span><span class=\"ec-4bcb7326\">&gt;</span></div></div></code></pre></figure></div>  </div> <div class=\"tab-panel copy-container\" data-label=\"After (Sent to Browser)\" data-astro-cid-nsrqe3q4> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"html\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\">&lt;!-- What the user actually receives --&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;</span><span class=\"ec-8c20c241\">script</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">nonce</span><span class=\"ec-4bcb7326\">=</span><span class=\"ec-8ce8e394\">&quot;a1b2c3d4e5f6g7h8i9j0...&quot;</span><span class=\"ec-4bcb7326\">&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">  </span></span><span class=\"ec-4bcb7326\">console.</span><span class=\"ec-a8d21843\">log</span><span class=\"ec-4bcb7326\">(</span><span class=\"ec-8ce8e394\">&#39;Static Placeholder&#39;</span><span class=\"ec-4bcb7326\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;/</span><span class=\"ec-8c20c241\">script</span><span class=\"ec-4bcb7326\">&gt;</span></div></div></code></pre></figure></div>  </div>  </div> </ui-tabs> \n<h2 id=\"anatomy-of-a-strict-csp\">Anatomy of a Strict CSP</h2>\n<p>Let’s break down the directives used in a production-ready policy. A weak CSP provides a false sense of security, so understanding these is crucial.</p>\n<h3 id=\"1-the-safety-net-default-src\">1. The Safety Net: <code>default-src</code></h3>\n<div class=\"code-wrapper copy-container\" data-astro-cid-vkvmcqta> <pre data-astro-cid-vkvmcqta><code class=\"language-nginx\" data-astro-cid-vkvmcqta><p>default-src ‘none’;</p></code></pre> <button class=\"copy-button code-copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<p><strong>Recommendation:</strong> Always start with <code>&#39;none&#39;</code>. This ensures that any directive you forget to configure defaults to “block” rather than “allow”. It forces you to be explicit about what you trust.</p>\n<h3 id=\"2-the-danger-zone-script-src\">2. The Danger Zone: <code>script-src</code></h3>\n<p>This is where XSS is prevented or allowed.</p>\n<ul>\n<li><strong><code>&#39;self&#39;</code></strong>: Allows scripts from your own domain.</li>\n<li><strong><code>&#39;nonce-$cspNonce&#39;</code></strong>: Allows inline scripts with the correct token.</li>\n<li><strong><code>&#39;strict-dynamic&#39;</code></strong> (Advanced): If a trusted script loads another script, trust that one too.</li>\n<li><strong><code>&#39;unsafe-inline&#39;</code></strong> (AVOID): Allows <em>all</em> inline scripts. This effectively disables XSS protection.</li>\n<li><strong><code>&#39;unsafe-eval&#39;</code></strong>: Allows <code>eval()</code>. Avoid unless absolutely necessary (some older libraries require it).</li>\n</ul>\n<div class=\"compare-code-wrapper\" data-astro-cid-s2ie7g3f> <div class=\"compare-block bad\" data-astro-cid-s2ie7g3f> <div class=\"header\" data-astro-cid-s2ie7g3f> <svg width=\"1em\" height=\"1em\" class=\"icon\" data-astro-cid-s2ie7g3f=\"true\" data-icon=\"mdi:close-circle-outline\">   <symbol id=\"ai:mdi:close-circle-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8m0-18C6.47 2 2 6.47 2 12s4.47 10 10 10s10-4.47 10-10S17.53 2 12 2m2.59 6L12 10.59L9.41 8L8 9.41L10.59 12L8 14.59L9.41 16L12 13.41L14.59 16L16 14.59L13.41 12L16 9.41z\"/></symbol><use href=\"#ai:mdi:close-circle-outline\"></use>  </svg> <span data-astro-cid-s2ie7g3f>Vulnerable (Blocked)</span> </div> <div class=\"content copy-container\" data-astro-cid-s2ie7g3f> <div><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"html\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\">&lt;!-- Blocked by CSP --&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;</span><span class=\"ec-8c20c241\">script</span><span class=\"ec-4bcb7326\">&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span class=\"ec-a8d21843\">alert</span><span class=\"ec-4bcb7326\">(</span><span class=\"ec-8ce8e394\">&#39;XSS Attack!&#39;</span><span class=\"ec-4bcb7326\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;/</span><span class=\"ec-8c20c241\">script</span><span class=\"ec-4bcb7326\">&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\">&lt;!-- Also Blocked (Event Handlers) --&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;</span><span class=\"ec-8c20c241\">button</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">onclick</span><span class=\"ec-4bcb7326\">=</span><span class=\"ec-8ce8e394\">&quot;</span><span class=\"ec-a8d21843\">doSomething</span><span class=\"ec-8ce8e394\">()&quot;</span><span class=\"ec-4bcb7326\">&gt;Click Me&lt;/</span><span class=\"ec-8c20c241\">button</span><span class=\"ec-4bcb7326\">&gt;</span></div></div></code></pre></figure></div></div> <button class=\"copy-button compare-copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> </div> <div class=\"compare-block good\" data-astro-cid-s2ie7g3f> <div class=\"header\" data-astro-cid-s2ie7g3f> <svg width=\"1em\" height=\"1em\" class=\"icon\" data-astro-cid-s2ie7g3f=\"true\" data-icon=\"mdi:check-circle-outline\">   <symbol id=\"ai:mdi:check-circle-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10s10-4.5 10-10S17.5 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8m4.59-12.42L10 14.17l-2.59-2.58L6 13l4 4l8-8z\"/></symbol><use href=\"#ai:mdi:check-circle-outline\"></use>  </svg> <span data-astro-cid-s2ie7g3f>Secure (Allowed)</span> </div> <div class=\"content copy-container\" data-astro-cid-s2ie7g3f> <div><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"html\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\">&lt;!-- Allowed (Matches Header) --&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;</span><span class=\"ec-8c20c241\">script</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">nonce</span><span class=\"ec-4bcb7326\">=</span><span class=\"ec-8ce8e394\">&quot;NGINX_NONCE_CSP&quot;</span><span class=\"ec-4bcb7326\">&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">  </span></span><span class=\"ec-4bcb7326\">document.</span><span class=\"ec-a8d21843\">getElementById</span><span class=\"ec-4bcb7326\">(</span><span class=\"ec-8ce8e394\">&#39;btn&#39;</span><span class=\"ec-4bcb7326\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">.</span><span class=\"ec-a8d21843\">addEventListener</span><span class=\"ec-4bcb7326\">(</span><span class=\"ec-8ce8e394\">&#39;click&#39;</span><span class=\"ec-4bcb7326\">, doSomething);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">&lt;/</span><span class=\"ec-8c20c241\">script</span><span class=\"ec-4bcb7326\">&gt;</span></div></div></code></pre></figure></div></div> <button class=\"copy-button compare-copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> </div> </div> \n<h3 id=\"3-styling-style-src\">3. Styling: <code>style-src</code></h3>\n<p>Styles are generally less dangerous than scripts, but can still be used for phishing (overlaying content) or data exfiltration.</p>\n<ul>\n<li><strong><code>&#39;self&#39;</code></strong>: Your own CSS files.</li>\n<li><strong><code>&#39;unsafe-inline&#39;</code></strong>: Often required for JS frameworks that inject styles dynamically.</li>\n<li><strong><code>&#39;unsafe-hashes&#39;</code></strong>: A middle ground. Allows specific inline styles (identified by their SHA-256 hash) without opening the floodgates.</li>\n</ul>\n<div class=\"callout callout-info ec-e8e3777f\" data-astro-cid-mrmim4ef> <div class=\"icon ec-e8e3777f\" data-astro-cid-mrmim4ef> <svg width=\"24\" height=\"24\" data-astro-cid-mrmim4ef=\"true\" data-icon=\"mdi:information-outline\">   <symbol id=\"ai:mdi:information-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M11 9h2V7h-2m1 13c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8m0-18A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2m-1 15h2v-6h-2z\"/></symbol><use href=\"#ai:mdi:information-outline\"></use>  </svg> </div> <div class=\"content ec-e8e3777f\" data-astro-cid-mrmim4ef> <p><strong><code>unsafe-inline</code> vs <code>unsafe-hashes</code></strong>: <a href=\"https://content-security-policy.com/unsafe-inline/\" rel=\"external noopener\" target=\"_blank\">unsafe-inline</a> allows <em>any</em> inline style block. <code>unsafe-hashes</code> allows only specific inline styles or event handlers that match a known hash. The latter is far more secure but requires maintaining a list of hashes.</p> </div> </div> \n<h3 id=\"4-external-integrations--connections\">4. External Integrations &amp; Connections</h3>\n<p>Modern sites rarely live in isolation. You likely use Google Analytics, Fonts, or CDNs.</p>\n<ul>\n<li><strong><code>connect-src</code></strong>: Controls where your app can send data (AJAX, WebSockets, <code>fetch</code>).\n<ul>\n<li><em>Example:</em> <code>connect-src &#39;self&#39; https://api.github.com;</code></li>\n</ul>\n</li>\n<li><strong><code>img-src</code></strong>: Controls image sources.\n<ul>\n<li><em>Example:</em> <code>img-src &#39;self&#39; data: https://res.cloudinary.com;</code></li>\n</ul>\n</li>\n<li><strong><code>form-action</code></strong>: <strong>Critical for anti-phishing.</strong> Controls where forms can submit data.\n<ul>\n<li><em>Recommendation:</em> <code>form-action &#39;self&#39;;</code> (Only allow forms to post to your own server).</li>\n</ul>\n</li>\n<li><strong><code>frame-ancestors</code></strong>: <strong>Critical for anti-clickjacking.</strong> Controls who can embed <em>your</em> site in an iframe.\n<ul>\n<li><em>Recommendation:</em> <code>frame-ancestors &#39;none&#39;;</code> (Nobody can embed me).</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"common-pitfalls--bad-directives\">Common Pitfalls &amp; “Bad” Directives</h2>\n<p>Not all CSP directives increase security. Some are escape hatches that should be used sparingly.</p>\n<div class=\"compare-code-wrapper\" data-astro-cid-s2ie7g3f> <div class=\"compare-block bad\" data-astro-cid-s2ie7g3f> <div class=\"header\" data-astro-cid-s2ie7g3f> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"icon\" data-astro-cid-s2ie7g3f=\"true\" data-icon=\"mdi:close-circle-outline\">   <use href=\"#ai:mdi:close-circle-outline\"></use>  </svg> <span data-astro-cid-s2ie7g3f>Insecure Configuration</span> </div> <div class=\"content copy-container\" data-astro-cid-s2ie7g3f> <div><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\"># Allows any inline script</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\"># Allows loading scripts from ANY HTTPS URL</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">script-</span><span class=\"ec-3f830706\">src</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&#39;self&#39;</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&#39;unsafe-inline&#39;</span><span class=\"ec-4bcb7326\"> https:;</span></div></div></code></pre></figure></div></div> <button class=\"copy-button compare-copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> </div> <div class=\"compare-block good\" data-astro-cid-s2ie7g3f> <div class=\"header\" data-astro-cid-s2ie7g3f> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"icon\" data-astro-cid-s2ie7g3f=\"true\" data-icon=\"mdi:check-circle-outline\">   <use href=\"#ai:mdi:check-circle-outline\"></use>  </svg> <span data-astro-cid-s2ie7g3f>Strict Configuration</span> </div> <div class=\"content copy-container\" data-astro-cid-s2ie7g3f> <div><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\"># Only allows specific, trusted scripts</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\"># Rejects everything else</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">script-</span><span class=\"ec-3f830706\">src</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&#39;self&#39;</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&#39;nonce-$</span><span class=\"ec-4bcb7326\">cspNonce</span><span class=\"ec-8ce8e394\">&#39;</span><span class=\"ec-4bcb7326\">;</span></div></div></code></pre></figure></div></div> <button class=\"copy-button compare-copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> </div> </div> \n<div class=\"callout callout-warning ec-e985ffc4\" data-astro-cid-mrmim4ef> <div class=\"icon ec-e985ffc4\" data-astro-cid-mrmim4ef> <svg width=\"24\" height=\"24\" data-astro-cid-mrmim4ef=\"true\" data-icon=\"mdi:alert-outline\">   <symbol id=\"ai:mdi:alert-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M12 2L1 21h22M12 6l7.53 13H4.47M11 10v4h2v-4m-2 6v2h2v-2\"/></symbol><use href=\"#ai:mdi:alert-outline\"></use>  </svg> </div> <div class=\"content ec-e985ffc4\" data-astro-cid-mrmim4ef> <p><strong>Avoid <code>https:</code> in <code>script-src</code>:</strong> Allowing <code>https:</code> essentially trusts <em>the entire internet</em>. <code>malicious-site.com</code> uses HTTPS too!</p> </div> </div> \n<h2 id=\"sha-hashes-trusting-the-immutable\">SHA Hashes: Trusting the Immutable</h2>\n<p>Sometimes you can’t add a nonce to a script (e.g., a third-party library that inserts a specific inline script). In this case, you can whitelist the <strong>hash</strong> of the script’s content.</p>\n<p>If Nginx blocks a script, the browser console will often tell you the required hash:</p>\n<blockquote>\n<p>Refused to execute inline script because it violates the following Content Security Policy directive… The hash of the script is <code>&#39;sha256-AbCdEf...&#39;</code>.</p>\n</blockquote>\n<p>You can then add <code>&#39;sha256-AbCdEf...&#39;</code> to your <code>script-src</code>.</p>\n<h2 id=\"validation--testing\">Validation &amp; Testing</h2>\n<p>A broken CSP breaks your site. Never deploy a strict policy to production without testing.</p>\n<ol>\n<li><strong>Report-Only Mode:</strong> Use <code>Content-Security-Policy-Report-Only</code> header first. Browsers will report violations to the console (or a <code>report-uri</code>) but won’t block anything.</li>\n<li><strong><a href=\"https://observatory.mozilla.org/\" rel=\"external noopener\" target=\"_blank\">Mozilla Observatory</a></strong>: The gold standard for grading your headers.</li>\n<li><strong><a href=\"https://csp-evaluator.withgoogle.com/\" rel=\"external noopener\" target=\"_blank\">Google CSP Evaluator</a></strong>: Helps find logical holes in your policy (like trusting widely compromised CDNs).</li>\n</ol>\n<h3 id=\"my-results\">My Results</h3>\n<p>After tuning the policy for <code>jmrp.io</code>, removing unsafe directives, and implementing the Nginx nonce injection:</p>\n<div class=\"callout callout-success ec-5d53542d\" data-astro-cid-mrmim4ef> <div class=\"icon ec-5d53542d\" data-astro-cid-mrmim4ef> <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" data-astro-cid-mrmim4ef=\"true\" data-icon=\"mdi:check-circle-outline\">   <use href=\"#ai:mdi:check-circle-outline\"></use>  </svg> </div> <div class=\"content ec-5d53542d\" data-astro-cid-mrmim4ef> <p><strong>Score: 140/100 (A+)</strong> on <a href=\"https://observatory.mozilla.org/analyze/jmrp.io\" rel=\"external noopener\" target=\"_blank\">Mozilla Observatory</a>.</p> </div> </div> \n<p>This setup proves that you don’t need to sacrifice security for the convenience of a static site generator. With a few lines of Nginx configuration, you can achieve top-tier protection.</p> <div class=\"references-section\" data-astro-cid-rn7nvbl4><div class=\"header\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" class=\"header-icon\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:book-open-page-variant-outline\">   <symbol id=\"ai:mdi:book-open-page-variant-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"m19 1l-5 5v11l5-4.5zm2 4v13.5c-1.1-.35-2.3-.5-3.5-.5c-1.7 0-4.15.65-5.5 1.5V6c-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5c.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5c1.35-.85 3.8-1.5 5.5-1.5c1.65 0 3.35.3 4.75 1.05c.1.05.15.05.25.05c.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1M10 18.41C8.75 18.09 7.5 18 6.5 18c-1.06 0-2.32.19-3.5.5V7.13c.91-.4 2.14-.63 3.5-.63s2.59.23 3.5.63z\"/></symbol><use href=\"#ai:mdi:book-open-page-variant-outline\"></use>  </svg><h3 data-astro-cid-rn7nvbl4>Further Reading & Resources</h3></div><div class=\"references-grid\" data-astro-cid-rn7nvbl4><a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <symbol id=\"ai:mdi:web\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2\"/></symbol><use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Content Security Policy (CSP)</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>developer.mozilla.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <symbol id=\"ai:mdi:arrow-top-right\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M5 17.59L15.59 7H9V5h10v10h-2V8.41L6.41 19z\"/></symbol><use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://nginx.org/en/docs/http/ngx_http_sub_module.html\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/nginx_org.webp\" alt=\"nginx.org favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Nginx</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>nginx.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://content-security-policy.com/unsafe-inline/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>unsafe-inline</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>content-security-policy.com</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://observatory.mozilla.org/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Mozilla Observatory</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>observatory.mozilla.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://csp-evaluator.withgoogle.com/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Google CSP Evaluator</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>csp-evaluator.withgoogle.com</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://observatory.mozilla.org/analyze/jmrp.io\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Mozilla Observatory</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>observatory.mozilla.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Cross-site_scripting\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Cross-Site Scripting (XSS)</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>developer.mozilla.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://www.cloudflare.com/learning/security/what-is-data-exfiltration/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/www_cloudflare_com.webp\" alt=\"www.cloudflare.com favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Exfiltration</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>www.cloudflare.com</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://owasp.org/www-community/attacks/Clickjacking\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Clickjacking</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>owasp.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Defenses/Mixed_content\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Mixed Content</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>developer.mozilla.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a></div></div> </div> </div> </article> <button id=\"toc-toggle-btn\" type=\"button\" class=\"toc-fab toc-trigger mobile-only\" aria-label=\"Table of Contents\" aria-haspopup=\"true\" aria-expanded=\"false\" data-astro-cid-ozdpo5e6><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"toc-icon\" data-astro-cid-ozdpo5e6=\"true\" data-icon=\"mdi:format-list-bulleted\">   <use href=\"#ai:mdi:format-list-bulleted\"></use>  </svg></button><div id=\"toc-drawer\" class=\"toc-drawer\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"toc-title\" aria-hidden=\"true\" inert data-astro-cid-ozdpo5e6><div class=\"toc-header\" data-astro-cid-ozdpo5e6><h2 id=\"toc-title\" data-astro-cid-ozdpo5e6>Table of Contents</h2><button id=\"toc-close-btn\" type=\"button\" class=\"toc-close\" aria-label=\"Close\" data-astro-cid-ozdpo5e6><svg width=\"1em\" height=\"1em\" data-astro-cid-ozdpo5e6=\"true\" data-icon=\"mdi:close\">   <symbol id=\"ai:mdi:close\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z\"/></symbol><use href=\"#ai:mdi:close\"></use>  </svg></button></div><nav class=\"toc-content\" data-astro-cid-ozdpo5e6><ul data-astro-cid-ozdpo5e6><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#why-do-we-need-csp-the-threat-landscape\" data-astro-cid-ozdpo5e6>Why Do We Need CSP? The Threat Landscape</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#1-cross-site-scripting-xss\" data-astro-cid-ozdpo5e6>1. Cross-Site Scripting (XSS)</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#2-data-injection--exfiltration\" data-astro-cid-ozdpo5e6>2. Data Injection &amp; Exfiltration</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#3-clickjacking-ui-redressing\" data-astro-cid-ozdpo5e6>3. Clickjacking (UI Redressing)</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#4-packet-sniffing-mixed-content\" data-astro-cid-ozdpo5e6>4. Packet Sniffing (Mixed Content)</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#the-challenge-static-content-vs-dynamic-security\" data-astro-cid-ozdpo5e6>The Challenge: Static Content vs. Dynamic Security</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#the-solution-nginx-sub-filter--placeholders\" data-astro-cid-ozdpo5e6>The Solution: Nginx Sub-Filter &amp; Placeholders</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#1-the-placeholder\" data-astro-cid-ozdpo5e6>1. The Placeholder</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#2-the-injection-nginx\" data-astro-cid-ozdpo5e6>2. The Injection (Nginx)</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#the-transformation\" data-astro-cid-ozdpo5e6>The Transformation</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#anatomy-of-a-strict-csp\" data-astro-cid-ozdpo5e6>Anatomy of a Strict CSP</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#1-the-safety-net-default-src\" data-astro-cid-ozdpo5e6>1. The Safety Net: default-src</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#2-the-danger-zone-script-src\" data-astro-cid-ozdpo5e6>2. The Danger Zone: script-src</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#3-styling-style-src\" data-astro-cid-ozdpo5e6>3. Styling: style-src</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#4-external-integrations--connections\" data-astro-cid-ozdpo5e6>4. External Integrations &amp; Connections</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#common-pitfalls--bad-directives\" data-astro-cid-ozdpo5e6>Common Pitfalls &amp; “Bad” Directives</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#sha-hashes-trusting-the-immutable\" data-astro-cid-ozdpo5e6>SHA Hashes: Trusting the Immutable</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#validation--testing\" data-astro-cid-ozdpo5e6>Validation &amp; Testing</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#my-results\" data-astro-cid-ozdpo5e6>My Results</a></li></ul></nav></div><div id=\"toc-backdrop\" class=\"toc-backdrop\" data-astro-cid-ozdpo5e6></div><script type=\"module\">function r(){const n=document.querySelectorAll(\".toc-trigger\"),e=document.getElementById(\"toc-drawer\"),s=document.getElementById(\"toc-close-btn\"),o=document.getElementById(\"toc-backdrop\"),i=e?.querySelectorAll(\"a\");if(!n.length||!e||!o)return;let d=null;const a=()=>{d=document.activeElement,e.classList.add(\"open\"),o.classList.add(\"open\"),n.forEach(t=>t.setAttribute(\"aria-expanded\",\"true\")),e.setAttribute(\"aria-hidden\",\"false\"),e.removeAttribute(\"inert\"),s&&s.focus(),window.innerWidth<1024&&(document.body.style.overflow=\"hidden\")},c=()=>{d?d.focus():n.length>0?n[0].focus():document.activeElement?.blur(),e.classList.remove(\"open\"),o.classList.remove(\"open\"),n.forEach(t=>t.setAttribute(\"aria-expanded\",\"false\")),e.setAttribute(\"aria-hidden\",\"true\"),e.setAttribute(\"inert\",\"\"),document.body.style.overflow=\"\"};n.forEach(t=>t.addEventListener(\"click\",a)),s?.addEventListener(\"click\",c),o.addEventListener(\"click\",c),i?.forEach(t=>{t.addEventListener(\"click\",()=>{c()})}),document.addEventListener(\"keydown\",t=>{t.key===\"Escape\"&&e.classList.contains(\"open\")&&c()})}document.addEventListener(\"DOMContentLoaded\",r);document.addEventListener(\"astro:after-swap\",r);</script>   </main> <footer data-astro-cid-sz7xmlte> <div class=\"container\" data-astro-cid-sz7xmlte> <p data-astro-cid-sz7xmlte>\n&copy; 2025 José Manuel Requena Plens. All rights reserved.\n</p> <div class=\"social-links\" data-astro-cid-sz7xmlte> <a href=\"https://github.com/jmrplens\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"GitHub\" title=\"GitHub\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"0.97em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-brands:github\">   <symbol id=\"ai:fa-brands:github\" viewBox=\"0 0 496 512\"><path fill=\"currentColor\" d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2\"/></symbol><use href=\"#ai:fa-brands:github\"></use>  </svg>   </a><a href=\"https://linkedin.com/in/jmrplens\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"LinkedIn\" title=\"LinkedIn\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"0.88em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-brands:linkedin\">   <symbol id=\"ai:fa-brands:linkedin\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9z\"/></symbol><use href=\"#ai:fa-brands:linkedin\"></use>  </svg>   </a><a href=\"https://mstdn.jmrp.io/@jmrplens\" target=\"_blank\" rel=\"me\" aria-label=\"Mastodon\" title=\"Mastodon\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"0.88em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-brands:mastodon\">   <symbol id=\"ai:fa-brands:mastodon\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M433 179.11c0-97.2-63.71-125.7-63.71-125.7c-62.52-28.7-228.56-28.4-290.48 0c0 0-63.72 28.5-63.72 125.7c0 115.7-6.6 259.4 105.63 289.1c40.51 10.7 75.32 13 103.33 11.4c50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.5 102.5 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7c56.12-6.7 105-41.3 111.23-72.9c9.8-49.8 9-121.5 9-121.5m-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175c25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5l11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1c23.71 27.3 18.4 53 18.4 175z\"/></symbol><use href=\"#ai:fa-brands:mastodon\"></use>  </svg>   </a><a href=\"https://scholar.google.com/citations?user=9b0kPaUAAAAJ\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Google Scholar\" title=\"Google Scholar\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"1.25em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-solid:graduation-cap\">   <symbol id=\"ai:fa-solid:graduation-cap\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87c.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6M352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47z\"/></symbol><use href=\"#ai:fa-solid:graduation-cap\"></use>  </svg>   </a><a href=\"https://matrix.to/#/@jmrplens:matrix.jmrp.io\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Matrix\" title=\"Matrix\" class=\"social-btn\" data-astro-cid-sz7xmlte>  <svg width=\"1em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"simple-icons:matrix\">   <symbol id=\"ai:simple-icons:matrix\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M.632.55v22.9H2.28V24H0V0h2.28v.55zm7.043 7.26v1.157h.033a3.3 3.3 0 0 1 1.117-1.024c.433-.245.936-.365 1.5-.365q.81.002 1.481.314c.448.208.785.582 1.02 1.108q.382-.562 1.034-.992q.651-.43 1.546-.43q.679 0 1.26.167c.388.11.716.286.993.53c.276.245.489.559.646.951q.229.587.23 1.417v5.728h-2.349V11.52q0-.43-.032-.812a1.8 1.8 0 0 0-.18-.66a1.1 1.1 0 0 0-.438-.448q-.292-.165-.785-.166q-.498 0-.803.189a1.4 1.4 0 0 0-.48.499a2 2 0 0 0-.231.696a6 6 0 0 0-.06.785v4.768h-2.35v-4.8q.002-.38-.018-.752a2.1 2.1 0 0 0-.143-.688a1.05 1.05 0 0 0-.415-.503c-.194-.125-.476-.19-.854-.19q-.168 0-.439.074c-.18.051-.36.143-.53.282a1.64 1.64 0 0 0-.439.595q-.18.39-.18 1.02v4.966H5.46V7.81zm15.693 15.64V.55H21.72V0H24v24h-2.28v-.55z\"/></symbol><use href=\"#ai:simple-icons:matrix\"></use>  </svg>  </a> </div> </div> </footer>   </body> </html> <script type=\"module\">document.addEventListener(\"DOMContentLoaded\",()=>{const o=document.querySelector(\".toc\");if(!o)return;new IntersectionObserver(e=>{e.forEach(s=>{s.isIntersecting?document.body.classList.remove(\"desktop-toc-visible\"):document.body.classList.add(\"desktop-toc-visible\")})},{rootMargin:`-${getComputedStyle(document.documentElement).getPropertyValue(\"--header-height\").trim()} 0px 0px 0px`,threshold:0}).observe(o)});document.addEventListener(\"DOMContentLoaded\",()=>{const o=document.querySelector(\".prose\");if(!o)return;o.querySelectorAll(\".expressive-code\").forEach(e=>{if(e.closest(\".file-content-wrapper\")||e.closest(\".tab-panel\")||e.closest(\".compare-block\"))return;const s=e.querySelector(\".copy\");if(s instanceof HTMLElement&&(s.style.display=\"none\"),e.querySelector(\".custom-code-copy-btn\"))return;const t=document.createElement(\"button\");t.className=\"custom-code-copy-btn\",t.setAttribute(\"aria-label\",\"Copy to clipboard\"),t.innerHTML=`\n                <svg class=\"copy-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\">\n                    <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\" />\n                </svg>\n                <svg class=\"success-icon hidden\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\">\n                    <path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\" />\n                </svg>\n            `,t.addEventListener(\"click\",()=>{const r=e.querySelector(\"code\"),i=r?r.textContent:null;if(!i){console.warn(\"No code element found in block.\");return}navigator.clipboard.writeText(i).then(()=>{const n=t.querySelector(\".copy-icon\"),c=t.querySelector(\".success-icon\");n instanceof HTMLElement&&c instanceof HTMLElement&&(n.classList.add(\"hidden\"),c.classList.remove(\"hidden\"),setTimeout(()=>{n.classList.remove(\"hidden\"),c.classList.add(\"hidden\")},2e3))},n=>{console.error(\"Failed to copy:\",n)})}),e instanceof HTMLElement&&(e.style.position=\"relative\"),e.appendChild(t)})});</script> "},{"filePath":"/var/www/jmrp.io_astro/dist/blog/secure-nginx-client-certificates/index.html","messages":[{"ruleId":"parser-error","severity":2,"message":"failed to tokenize \"/ integrit...\", expected attribute, \">\" or \"/>\".","offset":39878,"line":227,"column":146,"size":1,"selector":null}],"errorCount":1,"warningCount":0,"source":"<!DOCTYPE html><html lang=\"en\"> <head><!-- Global Metadata --><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"><link rel=\"icon\" type=\"image/webp\" href=\"/_astro/favicon.Bl59ql0s_Z1PAOVL.webp\"><link rel=\"apple-touch-icon\" href=\"/_astro/apple-touch-icon.BniYwoUE_1qR5s1.webp\"><!-- DNS Prefetch for external resources --><link rel=\"dns-prefetch\" href=\"https://www.google.com\"><link rel=\"manifest\" href=\"/site.webmanifest\"><link rel=\"sitemap\" href=\"/sitemap.xml\"><link rel=\"alternate\" type=\"application/rss+xml\" title=\"JMRP Blog RSS Feed\" href=\"/rss.xml\"><meta name=\"generator\" content=\"Astro v5.16.6\"><meta name=\"theme-color\" content=\"#B509AC\"><meta name=\"robots\" content=\"index, follow\"><!-- SEO --><meta name=\"keywords\" content=\"R&#38;D, Embedded Systems, Acoustics, Software Engineer, Portfolio, CV, Metamaterials, Research\"><meta name=\"author\" content=\"José Manuel Requena Plens\"><meta name=\"fediverse:creator\" content=\"@jmrplens@mstdn.jmrp.io\"><link rel=\"canonical\" href=\"https://jmrp.io/blog/secure-nginx-client-certificates/\"><!-- Primary Meta Tags --><title>Securing Nginx with Client Certificates (mTLS) | José Manuel Requena Plens</title><meta name=\"title\" content=\"Securing Nginx with Client Certificates (mTLS)\"><meta name=\"description\" content=\"A comprehensive guide on implementing Mutual TLS (mTLS) with Nginx. Learn how to create your own Certificate Authority, generate client certificates, and configure your Linux server to restrict access to only authorized devices.\"><!-- Open Graph / Facebook --><meta property=\"og:type\" content=\"article\"><meta property=\"og:url\" content=\"https://jmrp.io/blog/secure-nginx-client-certificates/\"><meta property=\"og:title\" content=\"Securing Nginx with Client Certificates (mTLS)\"><meta property=\"og:description\" content=\"A comprehensive guide on implementing Mutual TLS (mTLS) with Nginx. Learn how to create your own Certificate Authority, generate client certificates, and configure your Linux server to restrict access to only authorized devices.\"><meta property=\"og:image\" content=\"https://jmrp.io/_astro/mehome_landscape.Bz-Z1lGS_3nO6F.webp\"><meta property=\"og:image:width\" content=\"1200\"><meta property=\"og:image:height\" content=\"630\"><meta property=\"og:locale\" content=\"en_US\"><meta property=\"og:site_name\" content=\"José Manuel Requena Plens\"><!-- Article Specific OG Tags --><meta property=\"article:published_time\" content=\"2025-12-16T00:00:00.000Z\"><meta property=\"article:modified_time\" content=\"2025-12-16T00:00:00.000Z\"><meta property=\"article:author\" content=\"José Manuel Requena Plens\"><meta property=\"article:tag\" content=\"nginx\"><meta property=\"article:tag\" content=\"security\"><meta property=\"article:tag\" content=\"linux\"><meta property=\"article:tag\" content=\"certificates\"><meta property=\"article:tag\" content=\"tutorial\"><!-- Twitter --><meta property=\"twitter:card\" content=\"summary_large_image\"><meta property=\"twitter:site\" content=\"@jmrplens\"><meta property=\"twitter:creator\" content=\"@jmrplens\"><meta property=\"twitter:url\" content=\"https://jmrp.io/blog/secure-nginx-client-certificates/\"><meta property=\"twitter:title\" content=\"Securing Nginx with Client Certificates (mTLS)\"><meta property=\"twitter:description\" content=\"A comprehensive guide on implementing Mutual TLS (mTLS) with Nginx. Learn how to create your own Certificate Authority, generate client certificates, and configure your Linux server to restrict access to only authorized devices.\"><meta property=\"twitter:image\" content=\"https://jmrp.io/_astro/mehome_landscape.Bz-Z1lGS_3nO6F.webp\"><!-- JSON-LD --><script type=\"application/ld+json\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"https://jmrp.io/#website\",\"url\":\"https://jmrp.io\",\"name\":\"José M. Requena Plens\",\"description\":\"Academic and R&D Portfolio of José Manuel Requena Plens. Specializing in Embedded Systems, Acoustics, and Industrial Software Development.\",\"inLanguage\":\"en_US\",\"publisher\":{\"@type\":\"Person\",\"@id\":\"https://jmrp.io/#person\",\"name\":\"José Manuel Requena Plens\",\"url\":\"https://jmrp.io\",\"sameAs\":[\"https://twitter.com/jmrplens\"]}},{\"@type\":\"SiteNavigationElement\",\"name\":\"Home\",\"url\":\"https://jmrp.io/\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"CV\",\"url\":\"https://jmrp.io/cv\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Publications\",\"url\":\"https://jmrp.io/publications\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Repositories\",\"url\":\"https://jmrp.io/github\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Blog\",\"url\":\"https://jmrp.io/blog\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Services\",\"url\":\"https://jmrp.io/services\"},{\"@type\":\"BlogPosting\",\"@id\":\"https://jmrp.io/blog/secure-nginx-client-certificates#article\",\"headline\":\"Securing Nginx with Client Certificates (mTLS)\",\"description\":\"A comprehensive guide on implementing Mutual TLS (mTLS) with Nginx. Learn how to create your own Certificate Authority, generate client certificates, and configure your Linux server to restrict access to only authorized devices.\",\"datePublished\":\"2025-12-16T00:00:00.000Z\",\"dateModified\":\"2025-12-16T00:00:00.000Z\",\"author\":{\"@type\":\"Person\",\"@id\":\"https://jmrp.io/#person\"},\"image\":\"https://jmrp.io/default-blog-cover.jpg\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https://jmrp.io/blog/secure-nginx-client-certificates\"}},{\"@type\":\"BreadcrumbList\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Blog\",\"item\":\"https://jmrp.io/blog\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Securing Nginx with Client Certificates (mTLS)\",\"item\":\"https://jmrp.io/blog/secure-nginx-client-certificates\"}]}]}</script><script>\n            // Critical: Execute immediately to prevent FOUC\n            (function () {\n                const e = () => {\n                    if (\n                        typeof localStorage !== \"undefined\" &&\n                        localStorage.getItem(\"theme\")\n                    )\n                        return localStorage.getItem(\"theme\");\n                    return window.matchMedia(\"(prefers-color-scheme: light)\")\n                        .matches\n                        ? \"light\"\n                        : \"dark\";\n                };\n                const t = e();\n                document.documentElement.setAttribute(\"data-theme\", t);\n                if (t === \"light\") {\n                    document.documentElement.classList.add(\"light-mode\");\n                    document.documentElement.classList.remove(\"dark-mode\");\n                } else {\n                    document.documentElement.classList.add(\"dark-mode\");\n                    document.documentElement.classList.remove(\"light-mode\");\n                }\n            })();\n        </script><link rel=\"stylesheet\" href=\"/_astro/_slug_.DiOAQi95.css\" integrity=\"sha384-rwpS27cEV/5OO+XjtGT7RNbKonLSUHpWgri/68CS7DFcJ3TYe8cXBbq0L2DW4rBE\" crossorigin=\"anonymous\">\n<style>.callout[data-astro-cid-mrmim4ef]{display:flex;gap:1rem;padding:1rem 1.25rem;background:var(--callout-bg);border-left:4px solid var(--callout-color);border-radius:.5rem;margin:1.5rem 0}.icon[data-astro-cid-mrmim4ef]{color:var(--callout-color);flex-shrink:0;margin-top:.1rem}.content[data-astro-cid-mrmim4ef]{color:var(--color-text-body);font-size:.95rem;line-height:1.6}.content[data-astro-cid-mrmim4ef] p:last-child{margin-bottom:0}.content[data-astro-cid-mrmim4ef] p:first-child{margin-top:0}\nui-tabs{display:block;margin:1.5rem 0;background:var(--color-bg-subtle);border:var(--border-1);border-radius:var(--radius-md);overflow:hidden;position:relative}ui-tabs .tab-headers{display:flex;background:var(--color-bg-secondary);border-bottom:var(--border-1);overflow-x:auto;overflow-y:hidden;scrollbar-width:thin}ui-tabs .tab-headers::-webkit-scrollbar{height:4px}ui-tabs .tab-headers button{appearance:none;background:transparent;border:none;padding:.75rem 1.25rem;color:var(--color-text-muted);font-size:.9rem;font-weight:var(--fw-medium);cursor:pointer;transition:all .2s;border-bottom:2px solid transparent;white-space:nowrap;flex-shrink:0;border-right:var(--border-1)}ui-tabs .tab-headers button:hover{color:var(--color-text-body);background:#ffffff05}ui-tabs .tab-headers button[aria-selected=true]{color:var(--color-primary);border-bottom-color:var(--color-primary);background:var(--color-bg-subtle);margin-bottom:-1px}ui-tabs .tab-content{padding:0;max-width:100%;position:relative}.tab-panel{padding:1.5rem}.tab-panel.no-padding{padding:0}ui-tabs :global(pre),ui-tabs :global(.expressive-code),ui-tabs :global(.mermaid){max-width:100%!important;overflow-x:auto!important}ui-tabs img,ui-tabs svg{max-width:100%;height:auto}\n.tab-panel[data-astro-cid-nsrqe3q4]{position:relative}.tab-panel[data-astro-cid-nsrqe3q4] .panel-copy-button{position:absolute;top:.5rem;right:.5rem;z-index:10}.tab-panel[data-astro-cid-nsrqe3q4] .expressive-code .copy{display:none!important}\n</style>\n<link rel=\"stylesheet\" href=\"/_astro/_slug_.rqAQJTsE.css\" integrity=\"sha384-XyhFlbhFiwU+7U7btu+NULThYHNtd3UbBL7848dqcQzCYbnTTccV9m3ZsEKsgHAo\" crossorigin=\"anonymous\">\n<style>.copy-button[data-astro-cid-74lkg7sv]{position:absolute;top:.5rem;right:.5rem;background-color:var(--color-bg-subtle, rgba(255, 255, 255, .1));border:var(--border-1, 1px solid rgba(255, 255, 255, .1));border-radius:4px;padding:.3rem .5rem;cursor:pointer;opacity:.8;transition:all .2s ease;display:flex;align-items:center;justify-content:center;min-width:32px;min-height:32px;z-index:10}.copy-button[data-astro-cid-74lkg7sv]:hover{opacity:1;background-color:var(--color-bg-secondary, #222)}.copy-button[data-astro-cid-74lkg7sv]:active{transform:scale(.95)}.copy-icon[data-astro-cid-74lkg7sv],.success-icon[data-astro-cid-74lkg7sv]{font-size:1.2rem;width:1.2rem;height:1.2rem;color:var(--color-text-muted, #888);display:block}.success-icon[data-astro-cid-74lkg7sv]{color:var(--color-success, #2ea043)}.hidden[data-astro-cid-74lkg7sv]{display:none}\n</style><style>.collapsible-wrapper[data-astro-cid-hbmamkfo]{border:var(--border-1);border-radius:var(--radius-md);margin:1.5rem 0;background-color:var(--color-bg-secondary)}.collapsible-wrapper[data-astro-cid-hbmamkfo][open]{border-color:var(--color-primary)}summary[data-astro-cid-hbmamkfo]{display:flex;justify-content:space-between;align-items:center;padding:.8rem 1rem;cursor:pointer;font-weight:500;list-style:none;color:var(--color-text);transition:background-color .2s}summary[data-astro-cid-hbmamkfo]::-webkit-details-marker{display:none}.collapsible-wrapper[data-astro-cid-hbmamkfo][open]>summary[data-astro-cid-hbmamkfo]{border-bottom:var(--border-1);background-color:var(--color-bg-subtle)}.summary-text[data-astro-cid-hbmamkfo]{font-family:var(--font-mono);font-size:.9rem}.icon-wrapper[data-astro-cid-hbmamkfo]{transition:transform .2s ease-in-out}.collapsible-wrapper[data-astro-cid-hbmamkfo][open]>summary[data-astro-cid-hbmamkfo] .icon-wrapper[data-astro-cid-hbmamkfo]{transform:rotate(180deg)}.collapsible-content[data-astro-cid-hbmamkfo]{padding:1rem;border-top:var(--border-1)}.collapsible-wrapper[data-astro-cid-hbmamkfo][open] .collapsible-content[data-astro-cid-hbmamkfo]{border-top:none}\n</style><style>.file-content-wrapper[data-astro-cid-q77ummtg]{border:var(--border-1);border-radius:var(--radius-md);margin:1.5rem 0;overflow:hidden;background-color:var(--color-bg-secondary)}.file-header[data-astro-cid-q77ummtg]{display:flex;align-items:center;justify-content:space-between;gap:.5rem;padding:.5rem 1rem;background-color:var(--color-bg-subtle);border-bottom:var(--border-1);font-family:var(--font-mono);font-size:.85rem;color:var(--color-text-muted);min-height:48px}.file-info[data-astro-cid-q77ummtg]{display:flex;align-items:center;gap:.5rem}.file-icon[data-astro-cid-q77ummtg]{font-size:1.3rem}.file-name[data-astro-cid-q77ummtg]{font-weight:500}.file-body[data-astro-cid-q77ummtg] pre{margin:0!important;border-radius:0 0 var(--radius-md) var(--radius-md)!important;border:none!important;box-shadow:none!important}.file-body[data-astro-cid-q77ummtg] .expressive-code .copy{display:none!important}.file-header-copy-btn{position:static!important;background-color:transparent!important;border:1px solid var(--color-border)!important;opacity:.7}.file-header-copy-btn:hover{opacity:1;background-color:var(--color-bg-secondary)!important;border-color:var(--color-text-muted)!important}\n</style><style>.terminal-command-wrapper[data-astro-cid-sxp3owl6]{position:relative;background-color:var(--color-bg-secondary);border-radius:var(--radius-md);padding:.75rem 1rem;margin:1.5rem 0;border:var(--border-1);overflow:hidden;display:flex;align-items:center;justify-content:space-between;gap:1rem}.command-container[data-astro-cid-sxp3owl6]{display:flex;align-items:baseline;overflow-x:auto;-ms-overflow-style:none;scrollbar-width:none;flex-grow:1;min-width:0;padding-right:.5rem;border-radius:var(--radius-sm);transition:outline .2s}.command-container[data-astro-cid-sxp3owl6]:focus{outline:2px solid var(--color-primary);outline-offset:2px}.terminal-command-wrapper .copy-button{position:static!important;background-color:var(--color-bg-subtle)!important;border:1px solid var(--color-border)!important;flex-shrink:0;margin:0}.command-container[data-astro-cid-sxp3owl6]::-webkit-scrollbar{display:none}.prompt[data-astro-cid-sxp3owl6]{color:var(--color-text-muted);margin-right:.75rem;font-family:var(--font-mono);font-size:.9em}.command-container[data-astro-cid-sxp3owl6] pre[data-astro-cid-sxp3owl6]{margin:0;padding:0;background:none!important;border:none;flex-grow:1;overflow:visible}\n</style><style>.terminal-output-wrapper[data-astro-cid-ho3flt46]{border:var(--border-1);border-radius:var(--radius-md);margin:1.5rem 0;background-color:var(--color-bg-secondary);overflow:hidden}.output-header[data-astro-cid-ho3flt46]{display:flex;align-items:center;gap:.5rem;padding:.6rem 1rem;border-bottom:var(--border-1);font-family:var(--font-mono);font-size:.85rem;color:var(--color-text-muted)}.output-icon[data-astro-cid-ho3flt46]{font-size:1.1rem}.output-body[data-astro-cid-ho3flt46]{padding:1rem;font-family:var(--font-mono);font-size:.85em;color:var(--color-text-muted);overflow-x:auto}.output-body[data-astro-cid-ho3flt46] .expressive-code .copy,.custom-code-copy-btn{display:none!important}.output-body[data-astro-cid-ho3flt46] pre{margin:0!important;padding:0!important;background:none!important;border:none!important;font-size:inherit!important;color:inherit!important}.output-body[data-astro-cid-ho3flt46] code{font-size:inherit!important;color:inherit!important;background-color:transparent!important}\n</style><style nonce=\"NGINX_CSP_NONCE\">.ec-37fd8859{fill: none%3b}.ec-a8d21843{--0:#B392F0;--1:#6F42C1}.ec-3f830706{--0:#F97583;--1:#BF3441}.ec-4bcb7326{--0:#E1E4E8;--1:#24292E}.ec-2b7f17df{--0:#e1e4e8;--1:#24292e}.ec-efe5505b{--0:#79B8FF;--1:#005CC5}.ec-60e18f03{--0:#99A0A6;--1:#616972}.ec-48863b4a{--0:#FFAB70;--1:#AE4B07}.ec-8ce8e394{--0:#9ECBFF;--1:#032F62}.ec-e985ffc4{--callout-color: #f59e0b;--callout-bg: rgba(245, 158, 11, 0.1);}.ec-e8e3777f{--callout-color: var(--color-primary);--callout-bg: rgba(59, 130, 246, 0.1);}</style></head> <body> <a href=\"#main-content\" class=\"skip-link\">Skip to content</a> <header data-astro-cid-3ef6ksr2> <nav class=\"container\" aria-label=\"Main Navigation\" data-astro-cid-3ef6ksr2> <a href=\"/\" class=\"logo\" aria-label=\"Home - JMRP\" data-astro-cid-3ef6ksr2> <span class=\"text-mono\" data-astro-cid-3ef6ksr2>&lt;JMRP /&gt;</span> </a> <div class=\"nav-right\" data-astro-cid-3ef6ksr2> <button id=\"menu-toggle\" type=\"button\" aria-label=\"Toggle Navigation\" aria-expanded=\"false\" class=\"menu-toggle\" data-astro-cid-3ef6ksr2> <span class=\"icon-container\" data-astro-cid-3ef6ksr2> <svg width=\"0.88em\" height=\"1em\" class=\"icon-bars\" data-astro-cid-3ef6ksr2=\"true\" data-icon=\"fa-solid:bars\">   <symbol id=\"ai:fa-solid:bars\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16m0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16m0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16\"/></symbol><use href=\"#ai:fa-solid:bars\"></use>  </svg> <svg width=\"0.69em\" height=\"1em\" class=\"icon-times\" data-astro-cid-3ef6ksr2=\"true\" data-icon=\"fa-solid:times\">   <symbol id=\"ai:fa-solid:times\" viewBox=\"0 0 352 512\"><path fill=\"currentColor\" d=\"m242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28L75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256L9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48z\"/></symbol><use href=\"#ai:fa-solid:times\"></use>  </svg> </span> </button> <ul id=\"nav-links\" class=\"nav-links\" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href=\"/\" data-astro-cid-3ef6ksr2>Home</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/cv\" data-astro-cid-3ef6ksr2>CV</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/publications\" data-astro-cid-3ef6ksr2>Publications</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/github\" data-astro-cid-3ef6ksr2>Repositories</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/blog\" data-astro-cid-3ef6ksr2>Blog</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/services\" data-astro-cid-3ef6ksr2>Services</a> </li> </ul> <button id=\"theme-toggle\" type=\"button\" class=\"theme-toggle\" aria-label=\"Toggle Dark Mode\" data-astro-cid-x3pjskd3> <span class=\"icon-sun\" data-astro-cid-x3pjskd3><svg width=\"1em\" height=\"1em\" data-astro-cid-x3pjskd3=\"true\" data-icon=\"fa-solid:sun\">   <symbol id=\"ai:fa-solid:sun\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96s96-43.1 96-96s-43.1-96-96-96m246.4 80.5l-94.7-47.3l33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5l-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4l-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3l-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5l47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7l100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4l94.7-47.3c13-6.5 13-24.7.2-31.1m-155.9 106c-49.9 49.9-131.1 49.9-181 0s-49.9-131.1 0-181s131.1-49.9 181 0s49.9 131.1 0 181\"/></symbol><use href=\"#ai:fa-solid:sun\"></use>  </svg></span> <span class=\"icon-moon\" data-astro-cid-x3pjskd3><svg width=\"1em\" height=\"1em\" data-astro-cid-x3pjskd3=\"true\" data-icon=\"fa-solid:moon\">   <symbol id=\"ai:fa-solid:moon\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M283.211 512c78.962 0 151.079-35.925 198.857-94.792c7.068-8.708-.639-21.43-11.562-19.35c-124.203 23.654-238.262-71.576-238.262-196.954c0-72.222 38.662-138.635 101.498-174.394c9.686-5.512 7.25-20.197-3.756-22.23A258 258 0 0 0 283.211 0c-141.309 0-256 114.511-256 256c0 141.309 114.511 256 256 256\"/></symbol><use href=\"#ai:fa-solid:moon\"></use>  </svg></span> </button>  <script src=\"/scripts/theme-toggle.js\" defer integrity=\"sha384-M6hHR0O8w+S63LqO9ItN9zQlQdmiaYlOvLLYHYLnm3iXQ4ZsFxSNLYvy1/14IgjX\" crossorigin=\"anonymous\"></script> </div> </nav> </header> <script src=\"/scripts/header.js\" defer integrity=\"sha384-Ntm3HR4so5CFACgs5lCmTess3N9BzWTqnZxLITG7D0Hn11Hor3eLdasEsegKvG0b\" crossorigin=\"anonymous\"></script>  <main id=\"main-content\" data-pagefind-body>  <article class=\"post-content\" data-astro-cid-7jjqptxk> <header class=\"post-header\" data-astro-cid-7jjqptxk> <div class=\"content-wrapper\" data-astro-cid-7jjqptxk> <a href=\"/blog\" class=\"back-link\" data-astro-cid-7jjqptxk> <svg width=\"1em\" height=\"1em\" data-astro-cid-7jjqptxk=\"true\" data-icon=\"mdi:arrow-left\">   <symbol id=\"ai:mdi:arrow-left\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M20 11v2H8l5.5 5.5l-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5L8 11z\"/></symbol><use href=\"#ai:mdi:arrow-left\"></use>  </svg> Back to Blog\n</a> <div class=\"meta\" data-astro-cid-7jjqptxk> <time datetime=\"2025-12-16T00:00:00.000Z\" data-astro-cid-7jjqptxk> December 16, 2025 </time> <span class=\"separator\" data-astro-cid-7jjqptxk>•</span> <div class=\"tags\" data-astro-cid-7jjqptxk> <span class=\"tag\" data-astro-cid-7jjqptxk>#nginx</span><span class=\"tag\" data-astro-cid-7jjqptxk>#security</span><span class=\"tag\" data-astro-cid-7jjqptxk>#linux</span><span class=\"tag\" data-astro-cid-7jjqptxk>#certificates</span><span class=\"tag\" data-astro-cid-7jjqptxk>#tutorial</span> </div> </div> <h1 data-astro-cid-7jjqptxk>Securing Nginx with Client Certificates (mTLS)</h1> <p class=\"lead\" data-astro-cid-7jjqptxk>A comprehensive guide on implementing Mutual TLS (mTLS) with Nginx. Learn how to create your own Certificate Authority, generate client certificates, and configure your Linux server to restrict access to only authorized devices.</p> </div> </header> <div class=\"layout-grid content-wrapper\" data-astro-cid-7jjqptxk> <aside class=\"toc-sidebar\" data-astro-cid-7jjqptxk> <nav class=\"toc\" aria-label=\"Table of Contents\" data-astro-cid-7jjqptxk> <h2 data-astro-cid-7jjqptxk>Table of Contents</h2> <ul data-astro-cid-7jjqptxk> <li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#how-it-works\" data-astro-cid-7jjqptxk> How it Works </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#the-full-logic-flow\" data-astro-cid-7jjqptxk> The Full Logic Flow </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#strategies-and-use-cases\" data-astro-cid-7jjqptxk> Strategies and Use Cases </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#prerequisites\" data-astro-cid-7jjqptxk> Prerequisites </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#step-1-create-your-certificate-authority-ca\" data-astro-cid-7jjqptxk> Step 1: Create Your Certificate Authority (CA) </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#1-create-a-minimal-opensslcnf\" data-astro-cid-7jjqptxk> 1. Create a Minimal openssl.cnf </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#2-generate-the-ca-key-and-certificate\" data-astro-cid-7jjqptxk> 2. Generate the CA Key and Certificate </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#step-2-generate-client-certificates\" data-astro-cid-7jjqptxk> Step 2: Generate Client Certificates </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#1-generate-user-private-key-and-csr\" data-astro-cid-7jjqptxk> 1. Generate User Private Key and CSR </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#2-sign-the-csr-with-your-ca\" data-astro-cid-7jjqptxk> 2. Sign the CSR with your CA </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#3-convert-to-pkcs12-p12\" data-astro-cid-7jjqptxk> 3. Convert to PKCS#12 (.p12) </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#step-3-configure-nginx\" data-astro-cid-7jjqptxk> Step 3: Configure Nginx </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#test-and-reload\" data-astro-cid-7jjqptxk> Test and Reload </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#step-4-advanced-access-control\" data-astro-cid-7jjqptxk> Step 4: Advanced Access Control </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#step-5-revoking-certificates-crl\" data-astro-cid-7jjqptxk> Step 5: Revoking Certificates (CRL) </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#1-revoke-a-certificate\" data-astro-cid-7jjqptxk> 1. Revoke a Certificate </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#2-generate-the-crl-file\" data-astro-cid-7jjqptxk> 2. Generate the CRL File </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#3-configure-nginx-to-check-the-crl\" data-astro-cid-7jjqptxk> 3. Configure Nginx to Check the CRL </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#step-6-installing-certificates-on-clients\" data-astro-cid-7jjqptxk> Step 6: Installing Certificates on Clients </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#troubleshooting\" data-astro-cid-7jjqptxk> Troubleshooting </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#400-bad-request-no-required-ssl-certificate\" data-astro-cid-7jjqptxk> 400 Bad Request (No required SSL certificate…) </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#400-bad-request-the-ssl-certificate-error\" data-astro-cid-7jjqptxk> 400 Bad Request (The SSL certificate error…) </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#403-forbidden\" data-astro-cid-7jjqptxk> 403 Forbidden </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#certificate-connection-dialog-loop\" data-astro-cid-7jjqptxk> ”Certificate Connection” Dialog loop </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#conclusion\" data-astro-cid-7jjqptxk> Conclusion </a> </li> </ul> </nav> <button class=\"desktop-toc-btn toc-trigger\" aria-label=\"Open Table of Contents\" data-astro-cid-7jjqptxk> <svg width=\"1em\" height=\"1em\" data-astro-cid-7jjqptxk=\"true\" data-icon=\"mdi:format-list-bulleted\">   <symbol id=\"ai:mdi:format-list-bulleted\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M7 5h14v2H7zm0 8v-2h14v2zM4 4.5A1.5 1.5 0 0 1 5.5 6A1.5 1.5 0 0 1 4 7.5A1.5 1.5 0 0 1 2.5 6A1.5 1.5 0 0 1 4 4.5m0 6A1.5 1.5 0 0 1 5.5 12A1.5 1.5 0 0 1 4 13.5A1.5 1.5 0 0 1 2.5 12A1.5 1.5 0 0 1 4 10.5M7 19v-2h14v2zm-3-2.5A1.5 1.5 0 0 1 5.5 18A1.5 1.5 0 0 1 4 19.5A1.5 1.5 0 0 1 2.5 18A1.5 1.5 0 0 1 4 16.5\"/></symbol><use href=\"#ai:mdi:format-list-bulleted\"></use>  </svg> <span data-astro-cid-7jjqptxk>Contents</span> </button> </aside> <div class=\"prose\" data-astro-cid-7jjqptxk> <p>Implementing <strong><a href=\"https://www.cloudflare.com/learning/access-management/what-is-mutual-tls/\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Learn more about Mutual TLS (mTLS) on Cloudflare\">Mutual TLS (mTLS)</a></strong> is one of the most robust ways to secure private web services. Unlike standard password authentication, mTLS requires the client (your browser/device) to present a valid certificate signed by your own Certificate Authority (CA).</p>\n<p>If the client doesn’t have the certificate, the Nginx server rejects the connection entirely—often before even serving the login page. This is perfect for securing private administration panels, NAS interfaces, or internal tools like the one running on <code>secure.example.com</code>.</p>\n<p>In this guide, I’ll walk you through creating a bespoke Certificate Authority, generating client certificates, configuring Nginx, and handling advanced scenarios like <strong>revoking access</strong> for lost devices or restricting specific users. You can find more deep-dive tutorials from providers like <a href=\"https://smallstep.com/hello-mtls\" rel=\"external noopener\" target=\"_blank\">Smallstep’s Hello mTLS</a>..</p>\n<h2 id=\"how-it-works\">How it Works</h2>\n<p>Before diving into the commands, let’s look at the handshake process.</p>\n<h3 id=\"the-full-logic-flow\">The Full Logic Flow</h3>\n<img alt height=\"454\" id=\"mermaid-0\"  src=\"/assets/extracted/564ddc0053f749de.svg\" width=\"602\"/>\n<h2 id=\"strategies-and-use-cases\">Strategies and Use Cases</h2>\n<p>Why go through the trouble of managing certificates? It separates the concepts of <a href=\"https://www.okta.com/identity-101/authentication-vs-authorization/\" rel=\"external noopener\" target=\"_blank\">authentication and authorization</a> at the infrastructure level.</p>\n<ol>\n<li><strong>Zero Trust Access</strong>: Even if an attacker steals your password, they can’t access the site without the physical file (the private key/certificate) installed on their device.</li>\n<li><strong>Reduction of Attack Surface</strong>: “Script kiddies” and bots scanning for vulnerabilities (like open WordPress login pages) will simply receive a 400 Bad Request or connection reset. They won’t even see the application.</li>\n<li><strong>Seamless Experience</strong>: Once installed, the browser handles the handshake automatically. No need to type 2FA codes every time.</li>\n</ol>\n<h2 id=\"prerequisites\">Prerequisites</h2>\n<ul>\n<li>A Linux server (Debian/Ubuntu/CentOS) with Nginx installed.</li>\n<li>Access to the terminal.</li>\n<li>The <a href=\"https://docs.openssl.org/\" rel=\"external noopener\" target=\"_blank\"><code>openssl</code></a> command-line tool installed (standard on almost all Linux distros).</li>\n</ul>\n<hr/>\n<h2 id=\"step-1-create-your-certificate-authority-ca\">Step 1: Create Your Certificate Authority (CA)</h2>\n<p>First, we need to become our own Authority. To ensure we can properly revoke certificates later, we need a consistent configuration and database.</p>\n<p>Create a directory to store your keys safely and set up the CA database:</p>\n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>#</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: mkdir -p /etc/nginx/client-certs &#38;&#38; cd /etc/nginx/client-certs\" data-astro-cid-sxp3owl6>mkdir -p /etc/nginx/client-certs &amp;&amp; cd /etc/nginx/client-certs</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <symbol id=\"ai:mdi:clipboard-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-7 0a1 1 0 0 1 1 1a1 1 0 0 1-1 1a1 1 0 0 1-1-1a1 1 0 0 1 1-1M7 7h10V5h2v14H5V5h2z\"/></symbol><use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <symbol id=\"ai:mdi:check\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z\"/></symbol><use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>#</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: mkdir -p newcerts &#38;&#38; touch index.txt &#38;&#38; echo 1000 > serial\" data-astro-cid-sxp3owl6>mkdir -p newcerts &amp;&amp; touch index.txt &amp;&amp; echo 1000 &gt; serial</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<h3 id=\"1-create-a-minimal-opensslcnf\">1. Create a Minimal <code>openssl.cnf</code></h3>\n<p>Create a file named <code>openssl.cnf</code> in this directory. This file ensures that <code>openssl ca</code> (used for signing and revocation) knows where your files are.</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: /etc/nginx/client-certs/openssl.cnf\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <symbol id=\"ai:devicon:nginx\" viewBox=\"0 0 128 128\"><path fill=\"#090\" d=\"M24.5 50.5c-1.5 0-2.5 1.2-2.5 2.7v14.1l-15.9-16c-.8-.8-2.2-1-3.2-.6S1 52.1 1 53.2v20.7c0 1.5 1.5 2.7 3 2.7s3-1.2 3-2.7V59.8l16.1 16c.5.5 1.2.8 1.9.8c.3 0 .4-.1.7-.2c1-.4 1.3-1.4 1.3-2.5V53.3c0-1.5-1-2.8-2.5-2.8m19.7 11.8c-1.4 0-2.7 1.4-2.7 2.8s1.3 2.8 2.7 2.8l6.6.4l-1.5 3.7h-8.5l-4.2-7.9l4.3-8.1H50l2.1 4h5.5L54 52.1l-.8-1.1H37.6l-.7 1.2L31 62.5l-.7 1.3l.7 1.3l5.8 10.3l.8 1.6h15.1l.7-1.7l4.3-9l1.9-4.3h-4.4zM65 50.5c-1.4 0-3 1.3-3 2.7V60h6v-6.7c0-1.5-1.6-2.8-3-2.8m30.4.3c-1-.4-2.4-.2-3.1.6L76 67.4V53.3c0-1.5-1-2.7-2.5-2.7S71 51.8 71 53.3V74c0 1.1.7 2.1 1.7 2.5c.3.1.7.2 1 .2c.7 0 1.6-.3 2.1-.8l16.2-16V74c0 1.5 1 2.7 2.5 2.7S97 75.5 97 74V53.3c0-1.1-.6-2.1-1.6-2.5m21.8 12.8l8.4-8.4c1.1-1.1 1.1-2.8 0-3.8c-1.1-1.1-2.8-1.1-3.8 0l-8.4 8.4l-8.4-8.4c-1.1-1.1-2.8-1.1-3.8 0c-1.1 1.1-1.1 2.8 0 3.8l8.4 8.4l-8.4 8.4c-1.1 1.1-1.1 2.8 0 3.8c.5.5 1.2.8 1.9.8s1.4-.3 1.9-.8l8.4-8.4l8.4 8.4c.5.5 1.2.8 1.9.8s1.4-.3 1.9-.8c1.1-1.1 1.1-2.8 0-3.8zM62 73.9c0 1.4 1.5 2.7 3 2.7c1.4 0 3-1.3 3-2.7V62h-6z\"/></symbol><use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>/etc/nginx/client-certs/openssl.cnf</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.gmn06.css\"/ integrity=\"sha384-EvHBk7y/jI5X+qm7VnzfLWepclRlgAWQZD7xfwjGdJOb58CEIXGsErTVXjAJLdik\" crossorigin=\"anonymous\"><script type=\"module\" src=\"/_astro/ec.g1fg5.js\" integrity=\"sha384-M8ULzGSeei5Lc7d69Yvkm78ffAvmiqFZWToXjWVNFj1ueVvYDx5gZpo/aRwGXOLr\" crossorigin=\"anonymous\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"ini\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-a8d21843\">[ ca ]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">default_ca</span><span class=\"ec-4bcb7326\"> = CA_default</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-a8d21843\">[ CA_default ]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">dir</span><span class=\"ec-4bcb7326\">             = .</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">database</span><span class=\"ec-4bcb7326\">        = $dir/index.txt</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">new_certs_dir</span><span class=\"ec-4bcb7326\">   = $dir/newcerts</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">certificate</span><span class=\"ec-4bcb7326\">     = $dir/ca.crt</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">serial</span><span class=\"ec-4bcb7326\">          = $dir/serial</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">private_key</span><span class=\"ec-4bcb7326\">     = $dir/ca.key</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">default_days</span><span class=\"ec-4bcb7326\">    = 365</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">default_crl_days</span><span class=\"ec-4bcb7326\">= 30</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">default_md</span><span class=\"ec-4bcb7326\">      = sha256</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">policy</span><span class=\"ec-4bcb7326\">          = policy_loose</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">copy_extensions</span><span class=\"ec-4bcb7326\"> = copy</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-a8d21843\">[ policy_loose ]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">countryName</span><span class=\"ec-4bcb7326\">             = optional</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">stateOrProvinceName</span><span class=\"ec-4bcb7326\">     = optional</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">localityName</span><span class=\"ec-4bcb7326\">            = optional</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">organizationName</span><span class=\"ec-4bcb7326\">        = optional</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">organizationalUnitName</span><span class=\"ec-4bcb7326\">  = optional</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">commonName</span><span class=\"ec-4bcb7326\">              = supplied</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">emailAddress</span><span class=\"ec-4bcb7326\">            = optional</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-a8d21843\">[ req ]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">distinguished_name</span><span class=\"ec-4bcb7326\"> = req_distinguished_name</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">prompt</span><span class=\"ec-4bcb7326\">             = no</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-a8d21843\">[ req_distinguished_name ]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">C</span><span class=\"ec-4bcb7326\">  = ES</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">ST</span><span class=\"ec-4bcb7326\"> = Valencia</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">L</span><span class=\"ec-4bcb7326\">  = Valencia</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">O</span><span class=\"ec-4bcb7326\">  = JMRP-IO-LAB</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">OU</span><span class=\"ec-4bcb7326\"> = IT Services</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">CN</span><span class=\"ec-4bcb7326\"> = JMRP-IO-LAB Root CA</span></div></div></code></pre></figure></div> </div> </div> \n<h3 id=\"2-generate-the-ca-key-and-certificate\">2. Generate the CA Key and Certificate</h3>\n<p>Now generate the root CA, which consists of a private key (<code>ca.key</code>) and a public certificate (<code>ca.crt</code>).</p>\n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>$</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: openssl req -new -x509 -nodes -days 3650 -out ca.crt -keyout ca.key -config openssl.cnf\" data-astro-cid-sxp3owl6>openssl req -new -x509 -nodes -days 3650 -out ca.crt -keyout ca.key -config openssl.cnf</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<details class=\"collapsible-wrapper\" data-astro-cid-hbmamkfo> <summary data-astro-cid-hbmamkfo> <span class=\"summary-text\" data-astro-cid-hbmamkfo>Example ca.key content</span> <div class=\"icon-wrapper\" aria-hidden=\"true\" data-astro-cid-hbmamkfo> <svg class=\"chevron\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" data-astro-cid-hbmamkfo> <polyline points=\"6 9 12 15 18 9\" data-astro-cid-hbmamkfo></polyline> </svg> </div> </summary> <div class=\"collapsible-content\" data-astro-cid-hbmamkfo> <div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: ca.key\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"mdi:key-variant\">   <symbol id=\"ai:mdi:key-variant\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M22 18v4h-4v-3h-3v-3h-3l-2.26-2.26c-.55.17-1.13.26-1.74.26a6 6 0 0 1-6-6a6 6 0 0 1 6-6a6 6 0 0 1 6 6c0 .61-.09 1.19-.26 1.74zM7 5a2 2 0 0 0-2 2a2 2 0 0 0 2 2a2 2 0 0 0 2-2a2 2 0 0 0-2-2\"/></symbol><use href=\"#ai:mdi:key-variant\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>ca.key</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">-----BEGIN PRIVATE KEY-----</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">(Your unique, long, private key text will be here)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">-----END PRIVATE KEY-----</span></div></div></code></pre></figure></div> </div> </div>  </div> </details> \n<details class=\"collapsible-wrapper\" data-astro-cid-hbmamkfo> <summary data-astro-cid-hbmamkfo> <span class=\"summary-text\" data-astro-cid-hbmamkfo>Example ca.crt content</span> <div class=\"icon-wrapper\" aria-hidden=\"true\" data-astro-cid-hbmamkfo> <svg class=\"chevron\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" data-astro-cid-hbmamkfo> <polyline points=\"6 9 12 15 18 9\" data-astro-cid-hbmamkfo></polyline> </svg> </div> </summary> <div class=\"collapsible-content\" data-astro-cid-hbmamkfo> <div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: ca.crt\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"mdi:certificate-outline\">   <symbol id=\"ai:mdi:certificate-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"m13 21l2-1l2 1v-7h-4m4-5V7l-2 1l-2-1v2l-2 1l2 1v2l2-1l2 1v-2l2-1m1-7H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h7v-2H4V5h16v10h-1v2h1a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-9 5H5V6h6m-2 5H5V9h4m2 5H5v-2h6Z\"/></symbol><use href=\"#ai:mdi:certificate-outline\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>ca.crt</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">-----BEGIN CERTIFICATE-----</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">MIIDqTCCApGgAwIBAgIUGXK4wXR7k/+3vuH7tS7NsTS13OUwDQYJKoZIhvcNAQEL</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">BQAwfTELMAkGA1UEBhMCRVMxETAPBgNVBAgMCFZhbGVuY2lhMREwDwYDVQQHDAhW</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">YWxlbmNpYTEUMBIGA1UECgwLSk1SUC1JTy1MQUIxFDASBgNVBAsMC0lUIFNlcnZp</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Y2VzMRwwGgYDVQQDDBNKTVJQLUlPLUxBQiBSb290IENBMB4XDTI1MTIxODAwNTkz</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">MFoXDTM1MTIxNjAwNTkzMFowfTELMAkGA1UEBhMCRVMxETAPBgNVBAgMCFZhbGVu</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Y2lhMREwDwYDVQQHDAhWYWxlbmNpYTEUMBIGA1UECgwLSk1SUC1JTy1MQUIxFDAS</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">BgNVBAsMC0lUIFNlcnZpY2VzMRwwGgYDVQQDDBNKTVJQLUlPLUxBQiBSb290IENB</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArZ5az+q02GgeSIdkxfm/</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">NSRl5ymjIjj/z8oek7UaZNMuHERleKghRjmaQngCsfYsBjf9MWwiil9nN03gzcTt</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">TWftgBuSnvFTzmvGGyZ3nhLJPJufB1vv3253sDPT1+wfTK5/5oWGVqpAm0ZJkS7+</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">kQuXr/KpD0jeQlNRqVPZjD94IKqCoHyHIzwkboKi5LZ20S/SvhNWCdddxP+mdqxb</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">sapKxLvE9+9jkCbngNU1Stglw4JxUesHvU5XgHl98tfGmedFy3NyAdFdVGhC9gzD</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">TTwLeu+LFn1nPcwKwz7pnregEd4XcDJRYWwhbEMJwpaHPVyZu0a3RfA3HitqD7fG</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">UQIDAQABoyEwHzAdBgNVHQ4EFgQUxM0JVaHLJ8EAthfjrrVlGzE6BswwDQYJKoZI</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">hvcNAQELBQADggEBAJw4N1HXIqjZp1fUiARAFjM/UqeKLwuON7oJWMHcqTLq3don</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">hbqrvif80STPzVdvIcMvfa+mjMAAkHETpj1GWDZcQ8TL0wAUsR1gjiRDrg1kZBx+</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">V/fo+WmEQDbn6581e0g7NxBwTXkoHT3bF4rbVcIPmx9/YfkcSQm8GKcyKan6TcZ7</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">emZW46QBbiohOw1znFmDaI+NHZoMzIYQLs1zP8td+xl1TTxbDekqp+jS9GYwBqHa</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">QOa0k/ZXcjFqpTopvlAb8AA8XsxVDcmAHfSItB8qNxwL8FnIIvlj/Yg9OGxraArJ</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">2fXleID8q60zmJik0fcTyVoBdEg6KWVAykEia+E=</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">-----END CERTIFICATE-----</span></div></div></code></pre></figure></div> </div> </div>  </div> </details> \n<p>You can verify your new CA certificate content:</p>\n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>$</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: openssl x509 -in ca.crt -text -noout\" data-astro-cid-sxp3owl6>openssl x509 -in ca.crt -text -noout</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<div class=\"terminal-output-wrapper\" role=\"log\" aria-live=\"polite\" aria-label=\"Terminal Output: Decoded CA Certificate\" data-astro-cid-ho3flt46> <div class=\"output-header\" aria-hidden=\"true\" data-astro-cid-ho3flt46> <svg width=\"1em\" height=\"1em\" class=\"output-icon\" data-astro-cid-ho3flt46=\"true\" data-icon=\"mdi:chevron-right-box-outline\">   <symbol id=\"ai:mdi:chevron-right-box-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.11 0 2-.89 2-2V5a2 2 0 0 0-2-2m0 16H5V5h14zM8.29 16.59L12.88 12L8.29 7.41L9.71 6l6 6l-6 6z\"/></symbol><use href=\"#ai:mdi:chevron-right-box-outline\"></use>  </svg> <span class=\"output-title\" data-astro-cid-ho3flt46>Decoded CA Certificate</span> </div> <div class=\"output-body\" data-astro-cid-ho3flt46> <pre data-astro-cid-ho3flt46><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Certificate:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">    </span></span><span class=\"ec-2b7f17df\">Data:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">        </span></span><span class=\"ec-2b7f17df\">Version: 3 (0x2)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">        </span></span><span class=\"ec-2b7f17df\">Serial Number:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">            </span></span><span class=\"ec-2b7f17df\">1a:c9:b8:c1:74:7b:93:ff:b7:be:e1:fb:b5:2e:cd:b1:34:b5:dd:ce</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">        </span></span><span class=\"ec-2b7f17df\">Signature Algorithm: sha256WithRSAEncryption</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">        </span></span><span class=\"ec-2b7f17df\">Issuer: C = ES, ST = Valencia, L = Valencia, O = JMRP-IO-LAB, OU = IT Services, CN = JMRP-IO-LAB Root CA</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">        </span></span><span class=\"ec-2b7f17df\">Validity</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">            </span></span><span class=\"ec-2b7f17df\">Not Before: Dec 18 00:59:30 2025 GMT</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">            </span></span><span class=\"ec-2b7f17df\">Not After : Dec 16 00:59:30 2035 GMT</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">        </span></span><span class=\"ec-2b7f17df\">Subject: C = ES, ST = Valencia, L = Valencia, O = JMRP-IO-LAB, OU = IT Services, CN = JMRP-IO-LAB Root CA</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">        </span></span><span class=\"ec-2b7f17df\">Subject Public Key Info:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">            </span></span><span class=\"ec-2b7f17df\">Public Key Algorithm: rsaEncryption</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">                </span></span><span class=\"ec-2b7f17df\">Public-Key: (4096 bit)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">                </span></span><span class=\"ec-2b7f17df\">Modulus:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">                    </span></span><span class=\"ec-2b7f17df\">00:ad:9e:5a:cf:ea:b4:d8:68:1e:48:87:64:c5:f9:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">                    </span></span><span class=\"ec-2b7f17df\">...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">                </span></span><span class=\"ec-2b7f17df\">Exponent: 65537 (0x10001)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">        </span></span><span class=\"ec-2b7f17df\">X509v3 extensions:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">            </span></span><span class=\"ec-2b7f17df\">X509v3 Subject Key Identifier:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">                </span></span><span class=\"ec-2b7f17df\">C4:CD:09:55:A1:CB:27:C1:00:B6:17:E3:AE:B5:65:1B:31:3A:06:CC</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">            </span></span><span class=\"ec-2b7f17df\">X509v3 Authority Key Identifier:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">                </span></span><span class=\"ec-2b7f17df\">C4:CD:09:55:A1:CB:27:C1:00:B6:17:E3:AE:B5:65:1B:31:3A:06:CC</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">            </span></span><span class=\"ec-2b7f17df\">X509v3 Basic Constraints: critical</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">                </span></span><span class=\"ec-2b7f17df\">CA:TRUE</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">    </span></span><span class=\"ec-2b7f17df\">Signature Algorithm: sha256WithRSAEncryption</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">    </span></span><span class=\"ec-2b7f17df\">Signature Value:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">        </span></span><span class=\"ec-2b7f17df\">9c:38:37:51:d7:22:a8:d9:a7:57:d4:88:04:40:16:33:3f:52:</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-2b7f17df\">        </span></span><span class=\"ec-2b7f17df\">...</span></div></div></code></pre></figure></div></pre> </div> </div> \n<hr/>\n<h2 id=\"step-2-generate-client-certificates\">Step 2: Generate Client Certificates</h2>\n<p>Now let’s create a certificate for a specific user.</p>\n<h3 id=\"1-generate-user-private-key-and-csr\">1. Generate User Private Key and CSR</h3>\n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>$</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: openssl req -new -newkey rsa:2048 -nodes -keyout user.key -out user.csr -subj &#34;/CN=jmrp.io-client&#34;\" data-astro-cid-sxp3owl6>openssl req -new -newkey rsa:2048 -nodes -keyout user.key -out user.csr -subj &quot;/CN=jmrp.io-client&quot;</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<h3 id=\"2-sign-the-csr-with-your-ca\">2. Sign the CSR with your CA</h3>\n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>$</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: openssl ca -config openssl.cnf -batch -in user.csr -out user.crt\" data-astro-cid-sxp3owl6>openssl ca -config openssl.cnf -batch -in user.csr -out user.crt</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<div class=\"terminal-output-wrapper\" role=\"log\" aria-live=\"polite\" aria-label=\"Terminal Output: Example 'openssl ca' Output\" data-astro-cid-ho3flt46> <div class=\"output-header\" aria-hidden=\"true\" data-astro-cid-ho3flt46> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"output-icon\" data-astro-cid-ho3flt46=\"true\" data-icon=\"mdi:chevron-right-box-outline\">   <use href=\"#ai:mdi:chevron-right-box-outline\"></use>  </svg> <span class=\"output-title\" data-astro-cid-ho3flt46>Example &#39;openssl ca&#39; Output</span> </div> <div class=\"output-body\" data-astro-cid-ho3flt46> <pre data-astro-cid-ho3flt46><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Using configuration from openssl.cnf</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Check that the request matches the signature</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Signature ok</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">The Subject&#39;s Distinguished Name is as follows</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">commonName            :ASN.1 12:&#39;jmrp.io-client&#39;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Certificate is to be certified until Dec 18 00:59:34 2026 GMT (365 days)</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Write out database with 1 new entries</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Database updated</span></div></div></code></pre></figure></div></pre> </div> </div> \n<p>This process creates <code>user.key</code> and <code>user.crt</code>.</p>\n<details class=\"collapsible-wrapper\" data-astro-cid-hbmamkfo> <summary data-astro-cid-hbmamkfo> <span class=\"summary-text\" data-astro-cid-hbmamkfo>Example user.key content</span> <div class=\"icon-wrapper\" aria-hidden=\"true\" data-astro-cid-hbmamkfo> <svg class=\"chevron\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" data-astro-cid-hbmamkfo> <polyline points=\"6 9 12 15 18 9\" data-astro-cid-hbmamkfo></polyline> </svg> </div> </summary> <div class=\"collapsible-content\" data-astro-cid-hbmamkfo> <div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: user.key\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"mdi:key-variant\">   <use href=\"#ai:mdi:key-variant\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>user.key</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">-----BEGIN PRIVATE KEY-----</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">(A different unique, long, private key text will be here)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">-----END PRIVATE KEY-----</span></div></div></code></pre></figure></div> </div> </div>  </div> </details> \n<details class=\"collapsible-wrapper\" data-astro-cid-hbmamkfo> <summary data-astro-cid-hbmamkfo> <span class=\"summary-text\" data-astro-cid-hbmamkfo>Example user.crt content</span> <div class=\"icon-wrapper\" aria-hidden=\"true\" data-astro-cid-hbmamkfo> <svg class=\"chevron\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" data-astro-cid-hbmamkfo> <polyline points=\"6 9 12 15 18 9\" data-astro-cid-hbmamkfo></polyline> </svg> </div> </summary> <div class=\"collapsible-content\" data-astro-cid-hbmamkfo> <div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: user.crt\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"mdi:certificate-outline\">   <use href=\"#ai:mdi:certificate-outline\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>user.crt</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">-----BEGIN CERTIFICATE-----</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">(The text for the user&#39;s certificate will be here. It will be</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">signed by your &quot;JMRP-IO-LAB Root CA&quot;.)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">-----END CERTIFICATE-----</span></div></div></code></pre></figure></div> </div> </div>  </div> </details> \n<h3 id=\"3-convert-to-pkcs12-p12\">3. Convert to PKCS#12 (.p12)</h3>\n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>$</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: openssl pkcs12 -export -out user.p12 -inkey user.key -in user.crt -certfile ca.crt\" data-astro-cid-sxp3owl6>openssl pkcs12 -export -out user.p12 -inkey user.key -in user.crt -certfile ca.crt</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<p>You will be asked to create an <strong>export password</strong>. This protects the file itself.</p>\n<hr/>\n<h2 id=\"step-3-configure-nginx\">Step 3: Configure Nginx</h2>\n<p>With the certificates generated, we need to tell Server Block to trust any client signed by our CA. All the directives used here are part of the <a href=\"https://nginx.org/en/docs/http/ngx_http_ssl_module.html\" rel=\"external noopener\" target=\"_blank\">Nginx SSL Module</a>.</p>\n<p>Edit your site configuration:</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: /etc/nginx/sites-available/secure.example.com.conf\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>/etc/nginx/sites-available/secure.example.com.conf</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">server</span><span class=\"ec-4bcb7326\"> {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">server_name </span><span class=\"ec-4bcb7326\">secure.example.com;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">listen </span><span class=\"ec-efe5505b\">443</span><span class=\"ec-4bcb7326\"> ssl;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ... other SSL settings ...</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ---------------------------------------------</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># Client Certificate Verification</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ---------------------------------------------</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># Path to the CA certificate we created in Step 1</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">ssl_client_certificate </span><span class=\"ec-4bcb7326\">/etc/nginx/client-certs/ca.crt;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># Enable verification</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">ssl_verify_client </span><span class=\"ec-efe5505b\">on</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># Optional: Verify chain depth</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">ssl_verify_depth </span><span class=\"ec-efe5505b\">2</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">/ </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># ... proxy settings ...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<h3 id=\"test-and-reload\">Test and Reload</h3>\n<p>Before applying, always check the configuration syntax:</p>\n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>#</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: sudo nginx -t\" data-astro-cid-sxp3owl6>sudo nginx -t</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>#</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: sudo systemctl reload nginx\" data-astro-cid-sxp3owl6>sudo systemctl reload nginx</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<p>Now, if you try to visit <code>https://secure.example.com</code> from a device <em>without</em> the certificate, Nginx will return a <strong>400 Bad Request (No required SSL certificate was sent)</strong>. The gate is closed!</p>\n<hr/>\n<h2 id=\"step-4-advanced-access-control\">Step 4: Advanced Access Control</h2>\n<p>By default, <strong>any</strong> client with a valid certificate signed by your CA can access the site. But what if you have multiple services and want to restrict “John” to <em>Service A</em> and “Alice” to <em>Service B</em>?</p>\n<p>You can use the <strong>Common Name (CN)</strong> from the certificate to authorize specific users.</p>\n<p>Open your Nginx config again. We will use the <code>map</code> directive (place this <strong>outside</strong> the <code>server</code> block, usually in <code>nginx.conf</code> or at the top of your site config):</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: /etc/nginx/nginx.conf\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>/etc/nginx/nginx.conf</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\"># Map the client certificate DN (Distinguished Name) to an access variable</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">map</span><span class=\"ec-4bcb7326\"> $</span><span class=\"ec-48863b4a\">ssl_client_s_dn</span><span class=\"ec-4bcb7326\"> $ssl_access_allowed {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-efe5505b\">default</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-efe5505b\">0</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># Format: /CN=CommonName</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-8ce8e394\">&quot;/CN=iphone-admin&quot;</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-efe5505b\">1</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-8ce8e394\">&quot;/CN=laptop-work&quot;</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-efe5505b\">1</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-8ce8e394\">&quot;/CN=ipad-home&quot;</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-efe5505b\">1</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<p>Then, inside your <code>server</code> block:</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: /etc/nginx/sites-available/secure.example.com.conf\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>/etc/nginx/sites-available/secure.example.com.conf</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">server</span><span class=\"ec-4bcb7326\"> {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ... ssl configuration ...</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">/ </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># First, ensure the cert is valid (already handled by ssl_verify_client)</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># Then check our custom map</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-3f830706\">if</span><span class=\"ec-4bcb7326\"> ($ssl_access_allowed </span><span class=\"ec-3f830706\">= </span><span class=\"ec-4bcb7326\">0) {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">            </span><span class=\"ec-3f830706\">return</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-efe5505b\">403</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&quot;Forbidden: You have a valid certificate, but are not authorized for this resource.&quot;</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">        </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># ... proxy_pass ...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<p>Now, creating a certificate for a friend won’t automatically grant them access to this specific site unless you add their CN to the whitelist.</p>\n<hr/>\n<h2 id=\"step-5-revoking-certificates-crl\">Step 5: Revoking Certificates (CRL)</h2>\n<p>What happens if you lose your phone? The certificate on it is still valid for a year. You need a way to <strong>revoke</strong> it effectively. This is done using a <strong>Certificate Revocation List (CRL)</strong>.</p>\n<h3 id=\"1-revoke-a-certificate\">1. Revoke a Certificate</h3>\n<p>Let’s say <code>user.crt</code> (from the lost phone) needs to be revoked.</p>\n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>$</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: openssl ca -config openssl.cnf -revoke user.crt\" data-astro-cid-sxp3owl6>openssl ca -config openssl.cnf -revoke user.crt</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<div class=\"terminal-output-wrapper\" role=\"log\" aria-live=\"polite\" aria-label=\"Terminal Output: Example 'openssl ca -revoke' Output\" data-astro-cid-ho3flt46> <div class=\"output-header\" aria-hidden=\"true\" data-astro-cid-ho3flt46> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"output-icon\" data-astro-cid-ho3flt46=\"true\" data-icon=\"mdi:chevron-right-box-outline\">   <use href=\"#ai:mdi:chevron-right-box-outline\"></use>  </svg> <span class=\"output-title\" data-astro-cid-ho3flt46>Example &#39;openssl ca -revoke&#39; Output</span> </div> <div class=\"output-body\" data-astro-cid-ho3flt46> <pre data-astro-cid-ho3flt46><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Using configuration from openssl.cnf</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Revoking Certificate 1000.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">Data Base Updated</span></div></div></code></pre></figure></div></pre> </div> </div> \n<h3 id=\"2-generate-the-crl-file\">2. Generate the CRL File</h3>\n<p>After revoking, you must generate the list itself so Nginx can read it:</p>\n<div class=\"terminal-command-wrapper copy-container\" data-astro-cid-sxp3owl6> <div class=\"command-container\" tabindex=\"0\" role=\"group\" aria-label=\"Terminal command\" data-astro-cid-sxp3owl6> <span class=\"prompt\" aria-hidden=\"true\" data-astro-cid-sxp3owl6>$</span> <pre data-astro-cid-sxp3owl6><code class=\"language-bash\" aria-label=\"Command: openssl ca -config openssl.cnf -gencrl -out crl.pem\" data-astro-cid-sxp3owl6>openssl ca -config openssl.cnf -gencrl -out crl.pem</code></pre> </div> <button class=\"copy-button\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> \n<p><em>Output: (No output usually means success)</em></p>\n<h3 id=\"3-configure-nginx-to-check-the-crl\">3. Configure Nginx to Check the CRL</h3>\n<p>Update your Nginx server block to check this list:</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: /etc/nginx/sites-available/secure.example.com.conf\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>/etc/nginx/sites-available/secure.example.com.conf</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-60e18f03\"># inside server block</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">ssl_crl </span><span class=\"ec-4bcb7326\">/etc/nginx/client-certs/crl.pem;</span></div></div></code></pre></figure></div> </div> </div> \n<p>Reload Nginx. Now, even if the “lost phone” presents its certificate, Nginx sees it in the CRL and blocks access.</p>\n<div class=\"callout callout-warning ec-e985ffc4\" data-astro-cid-mrmim4ef> <div class=\"icon ec-e985ffc4\" data-astro-cid-mrmim4ef> <svg width=\"24\" height=\"24\" data-astro-cid-mrmim4ef=\"true\" data-icon=\"mdi:alert-outline\">   <symbol id=\"ai:mdi:alert-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M12 2L1 21h22M12 6l7.53 13H4.47M11 10v4h2v-4m-2 6v2h2v-2\"/></symbol><use href=\"#ai:mdi:alert-outline\"></use>  </svg> </div> <div class=\"content ec-e985ffc4\" data-astro-cid-mrmim4ef> <p><strong>Maintenance:</strong> You must regenerate the <code>crl.pem</code> file and reload Nginx every time you revoke a certificate.</p> </div> </div> \n<hr/>\n<h2 id=\"step-6-installing-certificates-on-clients\">Step 6: Installing Certificates on Clients</h2>\n<p>Now you need to install the <code>.p12</code> file (generated in Step 2.3) onto your devices.</p>\n<div class=\"callout callout-info ec-e8e3777f\" data-astro-cid-mrmim4ef> <div class=\"icon ec-e8e3777f\" data-astro-cid-mrmim4ef> <svg width=\"24\" height=\"24\" data-astro-cid-mrmim4ef=\"true\" data-icon=\"mdi:information-outline\">   <symbol id=\"ai:mdi:information-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M11 9h2V7h-2m1 13c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8m0-18A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2m-1 15h2v-6h-2z\"/></symbol><use href=\"#ai:mdi:information-outline\"></use>  </svg> </div> <div class=\"content ec-e8e3777f\" data-astro-cid-mrmim4ef> <p><strong>Tip:</strong> Transfer the <code>.p12</code> file securely. Use AirDrop, a private USB, or a secure cloud folder. Avoid sending it via plain email if possible.</p> </div> </div> \n<script lang=\"ts\">\n    class TabsComponent extends HTMLElement {\n        connectedCallback() {\n            // Use requestAnimationFrame to ensure the children are fully parsed\n            // connectedCallback fires before child elements are available\n            requestAnimationFrame(() => {\n                this.initializeTabs();\n            });\n        }\n\n        initializeTabs() {\n            const headers = this.querySelector(\".tab-headers\");\n            const panels = this.querySelectorAll(\".tab-panel\");\n\n            if (!headers || panels.length === 0) return;\n\n            // Generate unique IDs for ARIA\n            const uniqueId = Math.random().toString(36).substring(2, 9);\n\n            panels.forEach((panel, index) => {\n                const title =\n                    panel.getAttribute(\"data-label\") || `Tab ${index + 1}`;\n                const panelId = `panel-${uniqueId}-${index}`;\n                const tabId = `tab-${uniqueId}-${index}`;\n\n                // Setup Panel ARIA\n                panel.setAttribute(\"id\", panelId);\n                panel.setAttribute(\"role\", \"tabpanel\");\n                panel.setAttribute(\"aria-labelledby\", tabId);\n\n                // Create Tab Button\n                const button = document.createElement(\"button\");\n                button.textContent = title;\n                button.id = tabId;\n                button.role = \"tab\";\n                button.setAttribute(\"aria-controls\", panelId);\n                button.setAttribute(\n                    \"aria-selected\",\n                    index === 0 ? \"true\" : \"false\",\n                );\n                button.setAttribute(\"tabindex\", index === 0 ? \"0\" : \"-1\");\n\n                button.addEventListener(\"click\", () => {\n                    // Deactivate all\n                    headers.querySelectorAll(\"button\").forEach((b) => {\n                        b.setAttribute(\"aria-selected\", \"false\");\n                        b.setAttribute(\"tabindex\", \"-1\");\n                    });\n                    panels.forEach((p) => {\n                        if (p instanceof HTMLElement) p.style.display = \"none\";\n                    });\n\n                    // Activate clicked\n                    button.setAttribute(\"aria-selected\", \"true\");\n                    button.setAttribute(\"tabindex\", \"0\");\n\n                    // Show corresponding panel\n                    if (panel instanceof HTMLElement)\n                        panel.style.display = \"block\";\n                });\n\n                // Keyboard navigation\n                button.addEventListener(\"keydown\", (e) => {\n                    if (e.key === \"ArrowRight\") {\n                        e.preventDefault();\n                        const next = button.nextElementSibling;\n                        if (next instanceof HTMLElement) {\n                            next.click();\n                            next.focus();\n                        }\n                    }\n                    if (e.key === \"ArrowLeft\") {\n                        e.preventDefault();\n                        const prev = button.previousElementSibling;\n                        if (prev instanceof HTMLElement) {\n                            prev.click();\n                            prev.focus();\n                        }\n                    }\n                });\n\n                headers.appendChild(button);\n\n                // Initial state - hide all except first\n                if (panel instanceof HTMLElement) {\n                    panel.style.display = index === 0 ? \"block\" : \"none\";\n                }\n            });\n        }\n    }\n\n    customElements.define(\"ui-tabs\", TabsComponent);\n</script> <ui-tabs> <div class=\"tab-headers\" role=\"tablist\" aria-label=\"Tabbed Content\"></div> <div class=\"tab-content\"> <div class=\"tab-panel copy-container\" data-label=\"iOS (iPhone/iPad)\" data-astro-cid-nsrqe3q4> <ol>\n<li>Send the <code>.p12</code> file to yourself via <strong>AirDrop</strong> or save it to <strong>iCloud Drive</strong> (Files app).</li>\n<li>Tap on the file in the <strong>Files</strong> app.</li>\n<li>Go to <strong>Settings</strong> &gt; <strong>Profile Downloaded</strong> (appears at the top).</li>\n<li>Install the profile and enter your device passcode.</li>\n<li>Enter the certificate password.</li>\n<li>The certificate is now installed! Safari will automatically use it when accessing the site.</li>\n</ol>  </div> <div class=\"tab-panel copy-container\" data-label=\"macOS\" data-astro-cid-nsrqe3q4> <ol>\n<li>Double-click the <code>user.p12</code> file.</li>\n<li><strong>Keychain Access</strong> will open. You will be prompted for the <em>export password</em> you created earlier.</li>\n<li>Ensure the certificate is added to your “login” keychain.</li>\n<li>Restart your browser (Chrome/Safari). When you visit the site, macOS will prompt you to “Select a Certificate” to authenticate.</li>\n</ol>  </div> <div class=\"tab-panel copy-container\" data-label=\"Windows\" data-astro-cid-nsrqe3q4> <ol>\n<li>Double-click the <code>user.p12</code> file.</li>\n<li>The <strong>Certificate Import Wizard</strong> will launch.</li>\n<li>Select <strong>Current User</strong>.</li>\n<li>Enter the password.</li>\n<li>Allow it to automatically select the certificate store (usually “Personal”).</li>\n<li>Restart your browser.</li>\n</ol>  </div> <div class=\"tab-panel copy-container\" data-label=\"Android\" data-astro-cid-nsrqe3q4> <ol>\n<li>Save the <code>.p12</code> file to your device storage.</li>\n<li>Go to <strong>Settings</strong> &gt; <strong>Security</strong> &gt; <strong>Encryption &amp; credentials</strong> &gt; <strong>Install a certificate</strong>.</li>\n<li>Select <strong>VPN &amp; app user certificate</strong>.</li>\n<li>Navigate to the <code>.p12</code> file and select it.</li>\n<li>Enter the password and give the certificate a name.</li>\n</ol>  </div>  </div> </ui-tabs> \n<hr/>\n<h2 id=\"troubleshooting\">Troubleshooting</h2>\n<p>Here are the most common issues you might face.</p>\n<h3 id=\"400-bad-request-no-required-ssl-certificate\">400 Bad Request (No required SSL certificate…)</h3>\n<ul>\n<li><strong>Cause:</strong> The browser didn’t send a certificate.</li>\n<li><strong>Fix:</strong> Ensure the <code>.p12</code> is installed. Restart the browser completely. Try <strong>Incognito/Private</strong> mode, as browsers sometimes stick to a “no-cert” session state.</li>\n</ul>\n<h3 id=\"400-bad-request-the-ssl-certificate-error\">400 Bad Request (The SSL certificate error…)</h3>\n<ul>\n<li><strong>Cause:</strong> The certificate exists but Nginx doesn’t like it.</li>\n<li><strong>Fix:</strong> Nginx might not trust the CA. Check <code>ssl_client_certificate</code>. Ensure the chain is correct.</li>\n</ul>\n<h3 id=\"403-forbidden\">403 Forbidden</h3>\n<ul>\n<li><strong>Cause:</strong> The certificate was accepted, but access was denied later.</li>\n<li><strong>Fix:</strong>\n<ul>\n<li>If using CRL: The cert might be revoked.</li>\n<li>If using <code>map</code> (Access Control): The CN might not match. Check Nginx error logs (<code>/var/log/nginx/error.log</code>) to see the actual <code>$ssl_client_s_dn</code> being received.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"certificate-connection-dialog-loop\">”Certificate Connection” Dialog loop</h3>\n<ul>\n<li><strong>Cause:</strong> On macOS/iOS, sometimes the system prompts repeatedly.</li>\n<li><strong>Fix:</strong> Ensure the CA certificate is also trusted in the Keychain (though technically not required for client auth, it helps the OS validate the chain).</li>\n</ul>\n<hr/>\n<h2 id=\"conclusion\">Conclusion</h2>\n<p>You have now implemented military-grade authentication for your home server services. By combining Nginx’s <code>ssl_verify_client</code> with your own Certificate Authority, you’ve ensured that only trusted devices can even <em>see</em> your login screen.</p>\n<p>This setup is ideal for exposing sensitive services like TrueNAS, Home Assistant, or private Wikis to the internet without relying solely on their built-in login forms.</p> <div class=\"references-section\" data-astro-cid-rn7nvbl4><div class=\"header\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" class=\"header-icon\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:book-open-page-variant-outline\">   <symbol id=\"ai:mdi:book-open-page-variant-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"m19 1l-5 5v11l5-4.5zm2 4v13.5c-1.1-.35-2.3-.5-3.5-.5c-1.7 0-4.15.65-5.5 1.5V6c-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5c.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5c1.35-.85 3.8-1.5 5.5-1.5c1.65 0 3.35.3 4.75 1.05c.1.05.15.05.25.05c.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1M10 18.41C8.75 18.09 7.5 18 6.5 18c-1.06 0-2.32.19-3.5.5V7.13c.91-.4 2.14-.63 3.5-.63s2.59.23 3.5.63z\"/></symbol><use href=\"#ai:mdi:book-open-page-variant-outline\"></use>  </svg><h3 data-astro-cid-rn7nvbl4>Further Reading & Resources</h3></div><div class=\"references-grid\" data-astro-cid-rn7nvbl4><a href=\"https://smallstep.com/hello-mtls\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/smallstep_com.webp\" alt=\"smallstep.com favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <symbol id=\"ai:mdi:web\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2\"/></symbol><use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Smallstep&#39;s Hello mTLS</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>smallstep.com</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <symbol id=\"ai:mdi:arrow-top-right\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M5 17.59L15.59 7H9V5h10v10h-2V8.41L6.41 19z\"/></symbol><use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://www.okta.com/identity-101/authentication-vs-authorization/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/www_okta_com.webp\" alt=\"www.okta.com favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>authentication and authorization</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>www.okta.com</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://docs.openssl.org/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>`openssl`</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>docs.openssl.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://nginx.org/en/docs/http/ngx_http_ssl_module.html\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/nginx_org.webp\" alt=\"nginx.org favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Nginx SSL Module</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>nginx.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://www.cloudflare.com/learning/access-management/what-is-mutual-tls/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/www_cloudflare_com.webp\" alt=\"www.cloudflare.com favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Mutual TLS (mTLS)</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>www.cloudflare.com</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a></div></div> </div> </div> </article> <button id=\"toc-toggle-btn\" type=\"button\" class=\"toc-fab toc-trigger mobile-only\" aria-label=\"Table of Contents\" aria-haspopup=\"true\" aria-expanded=\"false\" data-astro-cid-ozdpo5e6><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"toc-icon\" data-astro-cid-ozdpo5e6=\"true\" data-icon=\"mdi:format-list-bulleted\">   <use href=\"#ai:mdi:format-list-bulleted\"></use>  </svg></button><div id=\"toc-drawer\" class=\"toc-drawer\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"toc-title\" aria-hidden=\"true\" inert data-astro-cid-ozdpo5e6><div class=\"toc-header\" data-astro-cid-ozdpo5e6><h2 id=\"toc-title\" data-astro-cid-ozdpo5e6>Table of Contents</h2><button id=\"toc-close-btn\" type=\"button\" class=\"toc-close\" aria-label=\"Close\" data-astro-cid-ozdpo5e6><svg width=\"1em\" height=\"1em\" data-astro-cid-ozdpo5e6=\"true\" data-icon=\"mdi:close\">   <symbol id=\"ai:mdi:close\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z\"/></symbol><use href=\"#ai:mdi:close\"></use>  </svg></button></div><nav class=\"toc-content\" data-astro-cid-ozdpo5e6><ul data-astro-cid-ozdpo5e6><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#how-it-works\" data-astro-cid-ozdpo5e6>How it Works</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#the-full-logic-flow\" data-astro-cid-ozdpo5e6>The Full Logic Flow</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#strategies-and-use-cases\" data-astro-cid-ozdpo5e6>Strategies and Use Cases</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#prerequisites\" data-astro-cid-ozdpo5e6>Prerequisites</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#step-1-create-your-certificate-authority-ca\" data-astro-cid-ozdpo5e6>Step 1: Create Your Certificate Authority (CA)</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#1-create-a-minimal-opensslcnf\" data-astro-cid-ozdpo5e6>1. Create a Minimal openssl.cnf</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#2-generate-the-ca-key-and-certificate\" data-astro-cid-ozdpo5e6>2. Generate the CA Key and Certificate</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#step-2-generate-client-certificates\" data-astro-cid-ozdpo5e6>Step 2: Generate Client Certificates</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#1-generate-user-private-key-and-csr\" data-astro-cid-ozdpo5e6>1. Generate User Private Key and CSR</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#2-sign-the-csr-with-your-ca\" data-astro-cid-ozdpo5e6>2. Sign the CSR with your CA</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#3-convert-to-pkcs12-p12\" data-astro-cid-ozdpo5e6>3. Convert to PKCS#12 (.p12)</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#step-3-configure-nginx\" data-astro-cid-ozdpo5e6>Step 3: Configure Nginx</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#test-and-reload\" data-astro-cid-ozdpo5e6>Test and Reload</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#step-4-advanced-access-control\" data-astro-cid-ozdpo5e6>Step 4: Advanced Access Control</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#step-5-revoking-certificates-crl\" data-astro-cid-ozdpo5e6>Step 5: Revoking Certificates (CRL)</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#1-revoke-a-certificate\" data-astro-cid-ozdpo5e6>1. Revoke a Certificate</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#2-generate-the-crl-file\" data-astro-cid-ozdpo5e6>2. Generate the CRL File</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#3-configure-nginx-to-check-the-crl\" data-astro-cid-ozdpo5e6>3. Configure Nginx to Check the CRL</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#step-6-installing-certificates-on-clients\" data-astro-cid-ozdpo5e6>Step 6: Installing Certificates on Clients</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#troubleshooting\" data-astro-cid-ozdpo5e6>Troubleshooting</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#400-bad-request-no-required-ssl-certificate\" data-astro-cid-ozdpo5e6>400 Bad Request (No required SSL certificate…)</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#400-bad-request-the-ssl-certificate-error\" data-astro-cid-ozdpo5e6>400 Bad Request (The SSL certificate error…)</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#403-forbidden\" data-astro-cid-ozdpo5e6>403 Forbidden</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#certificate-connection-dialog-loop\" data-astro-cid-ozdpo5e6>”Certificate Connection” Dialog loop</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#conclusion\" data-astro-cid-ozdpo5e6>Conclusion</a></li></ul></nav></div><div id=\"toc-backdrop\" class=\"toc-backdrop\" data-astro-cid-ozdpo5e6></div><script type=\"module\">function r(){const n=document.querySelectorAll(\".toc-trigger\"),e=document.getElementById(\"toc-drawer\"),s=document.getElementById(\"toc-close-btn\"),o=document.getElementById(\"toc-backdrop\"),i=e?.querySelectorAll(\"a\");if(!n.length||!e||!o)return;let d=null;const a=()=>{d=document.activeElement,e.classList.add(\"open\"),o.classList.add(\"open\"),n.forEach(t=>t.setAttribute(\"aria-expanded\",\"true\")),e.setAttribute(\"aria-hidden\",\"false\"),e.removeAttribute(\"inert\"),s&&s.focus(),window.innerWidth<1024&&(document.body.style.overflow=\"hidden\")},c=()=>{d?d.focus():n.length>0?n[0].focus():document.activeElement?.blur(),e.classList.remove(\"open\"),o.classList.remove(\"open\"),n.forEach(t=>t.setAttribute(\"aria-expanded\",\"false\")),e.setAttribute(\"aria-hidden\",\"true\"),e.setAttribute(\"inert\",\"\"),document.body.style.overflow=\"\"};n.forEach(t=>t.addEventListener(\"click\",a)),s?.addEventListener(\"click\",c),o.addEventListener(\"click\",c),i?.forEach(t=>{t.addEventListener(\"click\",()=>{c()})}),document.addEventListener(\"keydown\",t=>{t.key===\"Escape\"&&e.classList.contains(\"open\")&&c()})}document.addEventListener(\"DOMContentLoaded\",r);document.addEventListener(\"astro:after-swap\",r);</script>   </main> <footer data-astro-cid-sz7xmlte> <div class=\"container\" data-astro-cid-sz7xmlte> <p data-astro-cid-sz7xmlte>\n&copy; 2025 José Manuel Requena Plens. All rights reserved.\n</p> <div class=\"social-links\" data-astro-cid-sz7xmlte> <a href=\"https://github.com/jmrplens\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"GitHub\" title=\"GitHub\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"0.97em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-brands:github\">   <symbol id=\"ai:fa-brands:github\" viewBox=\"0 0 496 512\"><path fill=\"currentColor\" d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2\"/></symbol><use href=\"#ai:fa-brands:github\"></use>  </svg>   </a><a href=\"https://linkedin.com/in/jmrplens\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"LinkedIn\" title=\"LinkedIn\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"0.88em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-brands:linkedin\">   <symbol id=\"ai:fa-brands:linkedin\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9z\"/></symbol><use href=\"#ai:fa-brands:linkedin\"></use>  </svg>   </a><a href=\"https://mstdn.jmrp.io/@jmrplens\" target=\"_blank\" rel=\"me\" aria-label=\"Mastodon\" title=\"Mastodon\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"0.88em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-brands:mastodon\">   <symbol id=\"ai:fa-brands:mastodon\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M433 179.11c0-97.2-63.71-125.7-63.71-125.7c-62.52-28.7-228.56-28.4-290.48 0c0 0-63.72 28.5-63.72 125.7c0 115.7-6.6 259.4 105.63 289.1c40.51 10.7 75.32 13 103.33 11.4c50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.5 102.5 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7c56.12-6.7 105-41.3 111.23-72.9c9.8-49.8 9-121.5 9-121.5m-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175c25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5l11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1c23.71 27.3 18.4 53 18.4 175z\"/></symbol><use href=\"#ai:fa-brands:mastodon\"></use>  </svg>   </a><a href=\"https://scholar.google.com/citations?user=9b0kPaUAAAAJ\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Google Scholar\" title=\"Google Scholar\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"1.25em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-solid:graduation-cap\">   <symbol id=\"ai:fa-solid:graduation-cap\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87c.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6M352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47z\"/></symbol><use href=\"#ai:fa-solid:graduation-cap\"></use>  </svg>   </a><a href=\"https://matrix.to/#/@jmrplens:matrix.jmrp.io\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Matrix\" title=\"Matrix\" class=\"social-btn\" data-astro-cid-sz7xmlte>  <svg width=\"1em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"simple-icons:matrix\">   <symbol id=\"ai:simple-icons:matrix\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M.632.55v22.9H2.28V24H0V0h2.28v.55zm7.043 7.26v1.157h.033a3.3 3.3 0 0 1 1.117-1.024c.433-.245.936-.365 1.5-.365q.81.002 1.481.314c.448.208.785.582 1.02 1.108q.382-.562 1.034-.992q.651-.43 1.546-.43q.679 0 1.26.167c.388.11.716.286.993.53c.276.245.489.559.646.951q.229.587.23 1.417v5.728h-2.349V11.52q0-.43-.032-.812a1.8 1.8 0 0 0-.18-.66a1.1 1.1 0 0 0-.438-.448q-.292-.165-.785-.166q-.498 0-.803.189a1.4 1.4 0 0 0-.48.499a2 2 0 0 0-.231.696a6 6 0 0 0-.06.785v4.768h-2.35v-4.8q.002-.38-.018-.752a2.1 2.1 0 0 0-.143-.688a1.05 1.05 0 0 0-.415-.503c-.194-.125-.476-.19-.854-.19q-.168 0-.439.074c-.18.051-.36.143-.53.282a1.64 1.64 0 0 0-.439.595q-.18.39-.18 1.02v4.966H5.46V7.81zm15.693 15.64V.55H21.72V0H24v24h-2.28v-.55z\"/></symbol><use href=\"#ai:simple-icons:matrix\"></use>  </svg>  </a> </div> </div> </footer>   </body> </html> <script type=\"module\">document.addEventListener(\"DOMContentLoaded\",()=>{const o=document.querySelector(\".toc\");if(!o)return;new IntersectionObserver(e=>{e.forEach(s=>{s.isIntersecting?document.body.classList.remove(\"desktop-toc-visible\"):document.body.classList.add(\"desktop-toc-visible\")})},{rootMargin:`-${getComputedStyle(document.documentElement).getPropertyValue(\"--header-height\").trim()} 0px 0px 0px`,threshold:0}).observe(o)});document.addEventListener(\"DOMContentLoaded\",()=>{const o=document.querySelector(\".prose\");if(!o)return;o.querySelectorAll(\".expressive-code\").forEach(e=>{if(e.closest(\".file-content-wrapper\")||e.closest(\".tab-panel\")||e.closest(\".compare-block\"))return;const s=e.querySelector(\".copy\");if(s instanceof HTMLElement&&(s.style.display=\"none\"),e.querySelector(\".custom-code-copy-btn\"))return;const t=document.createElement(\"button\");t.className=\"custom-code-copy-btn\",t.setAttribute(\"aria-label\",\"Copy to clipboard\"),t.innerHTML=`\n                <svg class=\"copy-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\">\n                    <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\" />\n                </svg>\n                <svg class=\"success-icon hidden\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\">\n                    <path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\" />\n                </svg>\n            `,t.addEventListener(\"click\",()=>{const r=e.querySelector(\"code\"),i=r?r.textContent:null;if(!i){console.warn(\"No code element found in block.\");return}navigator.clipboard.writeText(i).then(()=>{const n=t.querySelector(\".copy-icon\"),c=t.querySelector(\".success-icon\");n instanceof HTMLElement&&c instanceof HTMLElement&&(n.classList.add(\"hidden\"),c.classList.remove(\"hidden\"),setTimeout(()=>{n.classList.remove(\"hidden\"),c.classList.add(\"hidden\")},2e3))},n=>{console.error(\"Failed to copy:\",n)})}),e instanceof HTMLElement&&(e.style.position=\"relative\"),e.appendChild(t)})});</script> "},{"filePath":"/var/www/jmrp.io_astro/dist/blog/serve-virtual-files-nginx/index.html","messages":[{"ruleId":"parser-error","severity":2,"message":"failed to tokenize \"/ integrit...\", expected attribute, \">\" or \"/>\".","offset":30485,"line":113,"column":146,"size":1,"selector":null}],"errorCount":1,"warningCount":0,"source":"<!DOCTYPE html><html lang=\"en\"> <head><!-- Global Metadata --><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"><link rel=\"icon\" type=\"image/webp\" href=\"/_astro/favicon.Bl59ql0s_Z1PAOVL.webp\"><link rel=\"apple-touch-icon\" href=\"/_astro/apple-touch-icon.BniYwoUE_1qR5s1.webp\"><!-- DNS Prefetch for external resources --><link rel=\"dns-prefetch\" href=\"https://www.google.com\"><link rel=\"manifest\" href=\"/site.webmanifest\"><link rel=\"sitemap\" href=\"/sitemap.xml\"><link rel=\"alternate\" type=\"application/rss+xml\" title=\"JMRP Blog RSS Feed\" href=\"/rss.xml\"><meta name=\"generator\" content=\"Astro v5.16.6\"><meta name=\"theme-color\" content=\"#B509AC\"><meta name=\"robots\" content=\"index, follow\"><!-- SEO --><meta name=\"keywords\" content=\"R&#38;D, Embedded Systems, Acoustics, Software Engineer, Portfolio, CV, Metamaterials, Research\"><meta name=\"author\" content=\"José Manuel Requena Plens\"><meta name=\"fediverse:creator\" content=\"@jmrplens@mstdn.jmrp.io\"><link rel=\"canonical\" href=\"https://jmrp.io/blog/serve-virtual-files-nginx/\"><!-- Primary Meta Tags --><title>Serve Virtual Files with Nginx: Beyond the Document Root | José Manuel Requena Plens</title><meta name=\"title\" content=\"Serve Virtual Files with Nginx: Beyond the Document Root\"><meta name=\"description\" content=\"Learn how to configure Nginx to serve dynamic or protected files like robots.txt, security.txt, and JSON responses without them physically existing in your web root. A practical guide for containerized apps and managed services.\"><!-- Open Graph / Facebook --><meta property=\"og:type\" content=\"article\"><meta property=\"og:url\" content=\"https://jmrp.io/blog/serve-virtual-files-nginx/\"><meta property=\"og:title\" content=\"Serve Virtual Files with Nginx: Beyond the Document Root\"><meta property=\"og:description\" content=\"Learn how to configure Nginx to serve dynamic or protected files like robots.txt, security.txt, and JSON responses without them physically existing in your web root. A practical guide for containerized apps and managed services.\"><meta property=\"og:image\" content=\"https://jmrp.io/_astro/mehome_landscape.Bz-Z1lGS_3nO6F.webp\"><meta property=\"og:image:width\" content=\"1200\"><meta property=\"og:image:height\" content=\"630\"><meta property=\"og:locale\" content=\"en_US\"><meta property=\"og:site_name\" content=\"José Manuel Requena Plens\"><!-- Article Specific OG Tags --><meta property=\"article:published_time\" content=\"2025-12-18T00:00:00.000Z\"><meta property=\"article:modified_time\" content=\"2025-12-18T00:00:00.000Z\"><meta property=\"article:author\" content=\"José Manuel Requena Plens\"><meta property=\"article:tag\" content=\"nginx\"><meta property=\"article:tag\" content=\"sysadmin\"><meta property=\"article:tag\" content=\"webperf\"><meta property=\"article:tag\" content=\"devops\"><meta property=\"article:tag\" content=\"tutorial\"><!-- Twitter --><meta property=\"twitter:card\" content=\"summary_large_image\"><meta property=\"twitter:site\" content=\"@jmrplens\"><meta property=\"twitter:creator\" content=\"@jmrplens\"><meta property=\"twitter:url\" content=\"https://jmrp.io/blog/serve-virtual-files-nginx/\"><meta property=\"twitter:title\" content=\"Serve Virtual Files with Nginx: Beyond the Document Root\"><meta property=\"twitter:description\" content=\"Learn how to configure Nginx to serve dynamic or protected files like robots.txt, security.txt, and JSON responses without them physically existing in your web root. A practical guide for containerized apps and managed services.\"><meta property=\"twitter:image\" content=\"https://jmrp.io/_astro/mehome_landscape.Bz-Z1lGS_3nO6F.webp\"><!-- JSON-LD --><script type=\"application/ld+json\">{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"https://jmrp.io/#website\",\"url\":\"https://jmrp.io\",\"name\":\"José M. Requena Plens\",\"description\":\"Academic and R&D Portfolio of José Manuel Requena Plens. Specializing in Embedded Systems, Acoustics, and Industrial Software Development.\",\"inLanguage\":\"en_US\",\"publisher\":{\"@type\":\"Person\",\"@id\":\"https://jmrp.io/#person\",\"name\":\"José Manuel Requena Plens\",\"url\":\"https://jmrp.io\",\"sameAs\":[\"https://twitter.com/jmrplens\"]}},{\"@type\":\"SiteNavigationElement\",\"name\":\"Home\",\"url\":\"https://jmrp.io/\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"CV\",\"url\":\"https://jmrp.io/cv\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Publications\",\"url\":\"https://jmrp.io/publications\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Repositories\",\"url\":\"https://jmrp.io/github\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Blog\",\"url\":\"https://jmrp.io/blog\"},{\"@type\":\"SiteNavigationElement\",\"name\":\"Services\",\"url\":\"https://jmrp.io/services\"},{\"@type\":\"BlogPosting\",\"@id\":\"https://jmrp.io/blog/serve-virtual-files-nginx#article\",\"headline\":\"Serve Virtual Files with Nginx: Beyond the Document Root\",\"description\":\"Learn how to configure Nginx to serve dynamic or protected files like robots.txt, security.txt, and JSON responses without them physically existing in your web root. A practical guide for containerized apps and managed services.\",\"datePublished\":\"2025-12-18T00:00:00.000Z\",\"dateModified\":\"2025-12-18T00:00:00.000Z\",\"author\":{\"@type\":\"Person\",\"@id\":\"https://jmrp.io/#person\"},\"image\":\"https://jmrp.io/default-blog-cover.jpg\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https://jmrp.io/blog/serve-virtual-files-nginx\"}},{\"@type\":\"BreadcrumbList\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Blog\",\"item\":\"https://jmrp.io/blog\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Serve Virtual Files with Nginx: Beyond the Document Root\",\"item\":\"https://jmrp.io/blog/serve-virtual-files-nginx\"}]}]}</script><script>\n            // Critical: Execute immediately to prevent FOUC\n            (function () {\n                const e = () => {\n                    if (\n                        typeof localStorage !== \"undefined\" &&\n                        localStorage.getItem(\"theme\")\n                    )\n                        return localStorage.getItem(\"theme\");\n                    return window.matchMedia(\"(prefers-color-scheme: light)\")\n                        .matches\n                        ? \"light\"\n                        : \"dark\";\n                };\n                const t = e();\n                document.documentElement.setAttribute(\"data-theme\", t);\n                if (t === \"light\") {\n                    document.documentElement.classList.add(\"light-mode\");\n                    document.documentElement.classList.remove(\"dark-mode\");\n                } else {\n                    document.documentElement.classList.add(\"dark-mode\");\n                    document.documentElement.classList.remove(\"light-mode\");\n                }\n            })();\n        </script><link rel=\"stylesheet\" href=\"/_astro/_slug_.DiOAQi95.css\" integrity=\"sha384-rwpS27cEV/5OO+XjtGT7RNbKonLSUHpWgri/68CS7DFcJ3TYe8cXBbq0L2DW4rBE\" crossorigin=\"anonymous\">\n<style>.callout[data-astro-cid-mrmim4ef]{display:flex;gap:1rem;padding:1rem 1.25rem;background:var(--callout-bg);border-left:4px solid var(--callout-color);border-radius:.5rem;margin:1.5rem 0}.icon[data-astro-cid-mrmim4ef]{color:var(--callout-color);flex-shrink:0;margin-top:.1rem}.content[data-astro-cid-mrmim4ef]{color:var(--color-text-body);font-size:.95rem;line-height:1.6}.content[data-astro-cid-mrmim4ef] p:last-child{margin-bottom:0}.content[data-astro-cid-mrmim4ef] p:first-child{margin-top:0}\nui-tabs{display:block;margin:1.5rem 0;background:var(--color-bg-subtle);border:var(--border-1);border-radius:var(--radius-md);overflow:hidden;position:relative}ui-tabs .tab-headers{display:flex;background:var(--color-bg-secondary);border-bottom:var(--border-1);overflow-x:auto;overflow-y:hidden;scrollbar-width:thin}ui-tabs .tab-headers::-webkit-scrollbar{height:4px}ui-tabs .tab-headers button{appearance:none;background:transparent;border:none;padding:.75rem 1.25rem;color:var(--color-text-muted);font-size:.9rem;font-weight:var(--fw-medium);cursor:pointer;transition:all .2s;border-bottom:2px solid transparent;white-space:nowrap;flex-shrink:0;border-right:var(--border-1)}ui-tabs .tab-headers button:hover{color:var(--color-text-body);background:#ffffff05}ui-tabs .tab-headers button[aria-selected=true]{color:var(--color-primary);border-bottom-color:var(--color-primary);background:var(--color-bg-subtle);margin-bottom:-1px}ui-tabs .tab-content{padding:0;max-width:100%;position:relative}.tab-panel{padding:1.5rem}.tab-panel.no-padding{padding:0}ui-tabs :global(pre),ui-tabs :global(.expressive-code),ui-tabs :global(.mermaid){max-width:100%!important;overflow-x:auto!important}ui-tabs img,ui-tabs svg{max-width:100%;height:auto}\n.tab-panel[data-astro-cid-nsrqe3q4]{position:relative}.tab-panel[data-astro-cid-nsrqe3q4] .panel-copy-button{position:absolute;top:.5rem;right:.5rem;z-index:10}.tab-panel[data-astro-cid-nsrqe3q4] .expressive-code .copy{display:none!important}\n</style>\n<link rel=\"stylesheet\" href=\"/_astro/_slug_.rqAQJTsE.css\" integrity=\"sha384-XyhFlbhFiwU+7U7btu+NULThYHNtd3UbBL7848dqcQzCYbnTTccV9m3ZsEKsgHAo\" crossorigin=\"anonymous\">\n<style>.copy-button[data-astro-cid-74lkg7sv]{position:absolute;top:.5rem;right:.5rem;background-color:var(--color-bg-subtle, rgba(255, 255, 255, .1));border:var(--border-1, 1px solid rgba(255, 255, 255, .1));border-radius:4px;padding:.3rem .5rem;cursor:pointer;opacity:.8;transition:all .2s ease;display:flex;align-items:center;justify-content:center;min-width:32px;min-height:32px;z-index:10}.copy-button[data-astro-cid-74lkg7sv]:hover{opacity:1;background-color:var(--color-bg-secondary, #222)}.copy-button[data-astro-cid-74lkg7sv]:active{transform:scale(.95)}.copy-icon[data-astro-cid-74lkg7sv],.success-icon[data-astro-cid-74lkg7sv]{font-size:1.2rem;width:1.2rem;height:1.2rem;color:var(--color-text-muted, #888);display:block}.success-icon[data-astro-cid-74lkg7sv]{color:var(--color-success, #2ea043)}.hidden[data-astro-cid-74lkg7sv]{display:none}\n</style><style>.file-content-wrapper[data-astro-cid-q77ummtg]{border:var(--border-1);border-radius:var(--radius-md);margin:1.5rem 0;overflow:hidden;background-color:var(--color-bg-secondary)}.file-header[data-astro-cid-q77ummtg]{display:flex;align-items:center;justify-content:space-between;gap:.5rem;padding:.5rem 1rem;background-color:var(--color-bg-subtle);border-bottom:var(--border-1);font-family:var(--font-mono);font-size:.85rem;color:var(--color-text-muted);min-height:48px}.file-info[data-astro-cid-q77ummtg]{display:flex;align-items:center;gap:.5rem}.file-icon[data-astro-cid-q77ummtg]{font-size:1.3rem}.file-name[data-astro-cid-q77ummtg]{font-weight:500}.file-body[data-astro-cid-q77ummtg] pre{margin:0!important;border-radius:0 0 var(--radius-md) var(--radius-md)!important;border:none!important;box-shadow:none!important}.file-body[data-astro-cid-q77ummtg] .expressive-code .copy{display:none!important}.file-header-copy-btn{position:static!important;background-color:transparent!important;border:1px solid var(--color-border)!important;opacity:.7}.file-header-copy-btn:hover{opacity:1;background-color:var(--color-bg-secondary)!important;border-color:var(--color-text-muted)!important}\n</style><style>.key-point[data-astro-cid-qhz4ifqf]{display:flex;align-items:flex-start;gap:1rem;background-color:var(--color-bg-subtle);border:var(--border-1);border-left:4px solid var(--color-primary);border-radius:var(--radius-md);padding:1.25rem;margin:1.5rem 0;color:var(--color-text-body)}.icon-wrapper[data-astro-cid-qhz4ifqf]{color:var(--color-primary);font-size:1.5rem;margin-top:.1rem}.content-wrapper[data-astro-cid-qhz4ifqf]{flex:1}.content-wrapper[data-astro-cid-qhz4ifqf] p{margin:0}.content-wrapper[data-astro-cid-qhz4ifqf] p:not(:last-child){margin-bottom:1rem}\n</style><style>.terminal-command-wrapper[data-astro-cid-sxp3owl6]{position:relative;background-color:var(--color-bg-secondary);border-radius:var(--radius-md);padding:.75rem 1rem;margin:1.5rem 0;border:var(--border-1);overflow:hidden;display:flex;align-items:center;justify-content:space-between;gap:1rem}.command-container[data-astro-cid-sxp3owl6]{display:flex;align-items:baseline;overflow-x:auto;-ms-overflow-style:none;scrollbar-width:none;flex-grow:1;min-width:0;padding-right:.5rem;border-radius:var(--radius-sm);transition:outline .2s}.command-container[data-astro-cid-sxp3owl6]:focus{outline:2px solid var(--color-primary);outline-offset:2px}.terminal-command-wrapper .copy-button{position:static!important;background-color:var(--color-bg-subtle)!important;border:1px solid var(--color-border)!important;flex-shrink:0;margin:0}.command-container[data-astro-cid-sxp3owl6]::-webkit-scrollbar{display:none}.prompt[data-astro-cid-sxp3owl6]{color:var(--color-text-muted);margin-right:.75rem;font-family:var(--font-mono);font-size:.9em}.command-container[data-astro-cid-sxp3owl6] pre[data-astro-cid-sxp3owl6]{margin:0;padding:0;background:none!important;border:none;flex-grow:1;overflow:visible}\n</style><style nonce=\"NGINX_CSP_NONCE\">.ec-2b7f17df{--0:#e1e4e8;--1:#24292e}.ec-3f830706{--0:#F97583;--1:#BF3441}.ec-4bcb7326{--0:#E1E4E8;--1:#24292E}.ec-60e18f03{--0:#99A0A6;--1:#616972}.ec-d91a2b09{--0:#DBEDFF;--1:#032F62}.ec-a8d21843{--0:#B392F0;--1:#6F42C1}.ec-efe5505b{--0:#79B8FF;--1:#005CC5}.ec-8ce8e394{--0:#9ECBFF;--1:#032F62}.ec-e985ffc4{--callout-color: #f59e0b;--callout-bg: rgba(245, 158, 11, 0.1);}.ec-e8e3777f{--callout-color: var(--color-primary);--callout-bg: rgba(59, 130, 246, 0.1);}</style></head> <body> <a href=\"#main-content\" class=\"skip-link\">Skip to content</a> <header data-astro-cid-3ef6ksr2> <nav class=\"container\" aria-label=\"Main Navigation\" data-astro-cid-3ef6ksr2> <a href=\"/\" class=\"logo\" aria-label=\"Home - JMRP\" data-astro-cid-3ef6ksr2> <span class=\"text-mono\" data-astro-cid-3ef6ksr2>&lt;JMRP /&gt;</span> </a> <div class=\"nav-right\" data-astro-cid-3ef6ksr2> <button id=\"menu-toggle\" type=\"button\" aria-label=\"Toggle Navigation\" aria-expanded=\"false\" class=\"menu-toggle\" data-astro-cid-3ef6ksr2> <span class=\"icon-container\" data-astro-cid-3ef6ksr2> <svg width=\"0.88em\" height=\"1em\" class=\"icon-bars\" data-astro-cid-3ef6ksr2=\"true\" data-icon=\"fa-solid:bars\">   <symbol id=\"ai:fa-solid:bars\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16m0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16m0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16\"/></symbol><use href=\"#ai:fa-solid:bars\"></use>  </svg> <svg width=\"0.69em\" height=\"1em\" class=\"icon-times\" data-astro-cid-3ef6ksr2=\"true\" data-icon=\"fa-solid:times\">   <symbol id=\"ai:fa-solid:times\" viewBox=\"0 0 352 512\"><path fill=\"currentColor\" d=\"m242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28L75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256L9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48z\"/></symbol><use href=\"#ai:fa-solid:times\"></use>  </svg> </span> </button> <ul id=\"nav-links\" class=\"nav-links\" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href=\"/\" data-astro-cid-3ef6ksr2>Home</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/cv\" data-astro-cid-3ef6ksr2>CV</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/publications\" data-astro-cid-3ef6ksr2>Publications</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/github\" data-astro-cid-3ef6ksr2>Repositories</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/blog\" data-astro-cid-3ef6ksr2>Blog</a> </li><li data-astro-cid-3ef6ksr2> <a href=\"/services\" data-astro-cid-3ef6ksr2>Services</a> </li> </ul> <button id=\"theme-toggle\" type=\"button\" class=\"theme-toggle\" aria-label=\"Toggle Dark Mode\" data-astro-cid-x3pjskd3> <span class=\"icon-sun\" data-astro-cid-x3pjskd3><svg width=\"1em\" height=\"1em\" data-astro-cid-x3pjskd3=\"true\" data-icon=\"fa-solid:sun\">   <symbol id=\"ai:fa-solid:sun\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96s96-43.1 96-96s-43.1-96-96-96m246.4 80.5l-94.7-47.3l33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5l-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4l-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3l-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5l47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7l100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4l94.7-47.3c13-6.5 13-24.7.2-31.1m-155.9 106c-49.9 49.9-131.1 49.9-181 0s-49.9-131.1 0-181s131.1-49.9 181 0s49.9 131.1 0 181\"/></symbol><use href=\"#ai:fa-solid:sun\"></use>  </svg></span> <span class=\"icon-moon\" data-astro-cid-x3pjskd3><svg width=\"1em\" height=\"1em\" data-astro-cid-x3pjskd3=\"true\" data-icon=\"fa-solid:moon\">   <symbol id=\"ai:fa-solid:moon\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M283.211 512c78.962 0 151.079-35.925 198.857-94.792c7.068-8.708-.639-21.43-11.562-19.35c-124.203 23.654-238.262-71.576-238.262-196.954c0-72.222 38.662-138.635 101.498-174.394c9.686-5.512 7.25-20.197-3.756-22.23A258 258 0 0 0 283.211 0c-141.309 0-256 114.511-256 256c0 141.309 114.511 256 256 256\"/></symbol><use href=\"#ai:fa-solid:moon\"></use>  </svg></span> </button>  <script src=\"/scripts/theme-toggle.js\" defer integrity=\"sha384-M6hHR0O8w+S63LqO9ItN9zQlQdmiaYlOvLLYHYLnm3iXQ4ZsFxSNLYvy1/14IgjX\" crossorigin=\"anonymous\"></script> </div> </nav> </header> <script src=\"/scripts/header.js\" defer integrity=\"sha384-Ntm3HR4so5CFACgs5lCmTess3N9BzWTqnZxLITG7D0Hn11Hor3eLdasEsegKvG0b\" crossorigin=\"anonymous\"></script>  <main id=\"main-content\" data-pagefind-body>  <article class=\"post-content\" data-astro-cid-7jjqptxk> <header class=\"post-header\" data-astro-cid-7jjqptxk> <div class=\"content-wrapper\" data-astro-cid-7jjqptxk> <a href=\"/blog\" class=\"back-link\" data-astro-cid-7jjqptxk> <svg width=\"1em\" height=\"1em\" data-astro-cid-7jjqptxk=\"true\" data-icon=\"mdi:arrow-left\">   <symbol id=\"ai:mdi:arrow-left\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M20 11v2H8l5.5 5.5l-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5L8 11z\"/></symbol><use href=\"#ai:mdi:arrow-left\"></use>  </svg> Back to Blog\n</a> <div class=\"meta\" data-astro-cid-7jjqptxk> <time datetime=\"2025-12-18T00:00:00.000Z\" data-astro-cid-7jjqptxk> December 18, 2025 </time> <span class=\"separator\" data-astro-cid-7jjqptxk>•</span> <div class=\"tags\" data-astro-cid-7jjqptxk> <span class=\"tag\" data-astro-cid-7jjqptxk>#nginx</span><span class=\"tag\" data-astro-cid-7jjqptxk>#sysadmin</span><span class=\"tag\" data-astro-cid-7jjqptxk>#webperf</span><span class=\"tag\" data-astro-cid-7jjqptxk>#devops</span><span class=\"tag\" data-astro-cid-7jjqptxk>#tutorial</span> </div> </div> <h1 data-astro-cid-7jjqptxk>Serve Virtual Files with Nginx: Beyond the Document Root</h1> <p class=\"lead\" data-astro-cid-7jjqptxk>Learn how to configure Nginx to serve dynamic or protected files like robots.txt, security.txt, and JSON responses without them physically existing in your web root. A practical guide for containerized apps and managed services.</p> </div> </header> <div class=\"layout-grid content-wrapper\" data-astro-cid-7jjqptxk> <aside class=\"toc-sidebar\" data-astro-cid-7jjqptxk> <nav class=\"toc\" aria-label=\"Table of Contents\" data-astro-cid-7jjqptxk> <h2 data-astro-cid-7jjqptxk>Table of Contents</h2> <ul data-astro-cid-7jjqptxk> <li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#the-core-techniques\" data-astro-cid-7jjqptxk> The Core Techniques </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#example-1-the-ubiquitous-robotstxt\" data-astro-cid-7jjqptxk> Example 1: The Ubiquitous robots.txt </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#method-a-serve-a-local-file-with-alias\" data-astro-cid-7jjqptxk> Method A: Serve a Local File with alias </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#method-b-generate-content-with-return\" data-astro-cid-7jjqptxk> Method B: Generate Content with return </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#example-2-securitytxt-for-responsible-disclosure\" data-astro-cid-7jjqptxk> Example 2: security.txt for Responsible Disclosure </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#example-3-humanstxt-for-credits\" data-astro-cid-7jjqptxk> Example 3: humans.txt for Credits </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#method-a-using-alias\" data-astro-cid-7jjqptxk> Method A: Using alias </a> </li><li class=\"toc-depth-3\" data-astro-cid-7jjqptxk> <a href=\"#method-b-using-return\" data-astro-cid-7jjqptxk> Method B: Using return </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#example-4-a-dynamic-json-health-check\" data-astro-cid-7jjqptxk> Example 4: A Dynamic JSON Health Check </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#example-5-lets-encrypt-http-01-challenges\" data-astro-cid-7jjqptxk> Example 5: Let’s Encrypt HTTP-01 Challenges </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#example-6-mobile-app-association-files\" data-astro-cid-7jjqptxk> Example 6: Mobile App Association Files </a> </li><li class=\"toc-depth-2\" data-astro-cid-7jjqptxk> <a href=\"#conclusion\" data-astro-cid-7jjqptxk> Conclusion </a> </li> </ul> </nav> <button class=\"desktop-toc-btn toc-trigger\" aria-label=\"Open Table of Contents\" data-astro-cid-7jjqptxk> <svg width=\"1em\" height=\"1em\" data-astro-cid-7jjqptxk=\"true\" data-icon=\"mdi:format-list-bulleted\">   <symbol id=\"ai:mdi:format-list-bulleted\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M7 5h14v2H7zm0 8v-2h14v2zM4 4.5A1.5 1.5 0 0 1 5.5 6A1.5 1.5 0 0 1 4 7.5A1.5 1.5 0 0 1 2.5 6A1.5 1.5 0 0 1 4 4.5m0 6A1.5 1.5 0 0 1 5.5 12A1.5 1.5 0 0 1 4 13.5A1.5 1.5 0 0 1 2.5 12A1.5 1.5 0 0 1 4 10.5M7 19v-2h14v2zm-3-2.5A1.5 1.5 0 0 1 5.5 18A1.5 1.5 0 0 1 4 19.5A1.5 1.5 0 0 1 2.5 18A1.5 1.5 0 0 1 4 16.5\"/></symbol><use href=\"#ai:mdi:format-list-bulleted\"></use>  </svg> <span data-astro-cid-7jjqptxk>Contents</span> </button> </aside> <div class=\"prose\" data-astro-cid-7jjqptxk> <p>When deploying a modern web application, especially a containerized one or a service running on a managed platform, you often don’t have easy access to its web root. What happens when you need to serve a standard file like <code>robots.txt</code> or <code>.well-known/security.txt</code>? You can’t just drop it into the folder.</p>\n<p>Fortunately, Nginx is more than just a reverse proxy; it’s a powerful tool for manipulating requests and responses. In this guide, we’ll explore how to use Nginx to serve files and content that don’t physically reside in the path of the service being exposed. This is perfect for adding standard files to applications where you can’t—or shouldn’t—modify the underlying image or file system.</p>\n<h2 id=\"the-core-techniques\">The Core Techniques</h2>\n<p>There are two primary methods to achieve this, each with its own use case.</p>\n<ol>\n<li>\n<p><strong>Using an <a href=\"https://nginx.org/en/docs/http/ngx_http_core_module.html#alias\" rel=\"external noopener\" target=\"_blank\"><code>alias</code></a></strong>: This directive tells Nginx to serve a request from a file located elsewhere on the filesystem. It’s ideal when you have a static file you want to serve, but it’s not in your application’s document root.</p>\n</li>\n<li>\n<p><strong>Using <a href=\"https://nginx.org/en/docs/http/ngx_http_rewrite_module.html#return\" rel=\"external noopener\" target=\"_blank\"><code>return</code></a></strong>: This directive can stop processing and immediately return a specific response code and content. It’s incredibly efficient for small, simple text files where creating a separate file feels like overkill.</p>\n</li>\n</ol>\n<div class=\"key-point\" role=\"note\" data-astro-cid-qhz4ifqf> <div class=\"icon-wrapper\" aria-hidden=\"true\" data-astro-cid-qhz4ifqf> <svg width=\"1em\" height=\"1em\" class=\"key-icon\" data-astro-cid-qhz4ifqf=\"true\" data-icon=\"mdi:vector-difference\">   <symbol id=\"ai:mdi:vector-difference\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M3 1c-1.11 0-2 .89-2 2v11c0 1.11.89 2 2 2h2v-2H3V3h11v2h2V3c0-1.11-.89-2-2-2zm6 6c-1.11 0-2 .89-2 2v2h2V9h2V7zm4 0v2h1v1h2V7zm5 0v2h2v11H9v-2H7v2c0 1.11.89 2 2 2h11c1.11 0 2-.89 2-2V9c0-1.11-.89-2-2-2zm-4 5v2h-2v2h2c1.11 0 2-.89 2-2v-2zm-7 1v3h3v-2H9v-1z\"/></symbol><use href=\"#ai:mdi:vector-difference\"></use>  </svg> </div> <div class=\"content-wrapper\" data-astro-cid-qhz4ifqf> <p><strong><code>root</code> vs. <code>alias</code></strong>: A common point of confusion is the difference between\n<code>root</code> and <code>alias</code>. With <code>root</code>, Nginx appends the request URI to the path you\nspecify. With <code>alias</code>, Nginx <em>discards</em> the matched part of the request URI\nand uses the path you specify directly. For serving a single file, <code>alias</code> is\noften more direct.</p> </div> </div> \n<hr/>\n<h2 id=\"example-1-the-ubiquitous-robotstxt\">Example 1: The Ubiquitous <code>robots.txt</code></h2>\n<p>The <a href=\"https://developers.google.com/search/docs/crawling-indexing/robots/intro\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Read the Google Search Central documentation on robots.txt\"><code>robots.txt</code></a> file tells web crawlers which parts of your site they should or shouldn’t access. It’s a fundamental part of SEO and site management.</p>\n<h3 id=\"method-a-serve-a-local-file-with-alias\">Method A: Serve a Local File with <code>alias</code></h3>\n<p>Let’s say your application runs from <code>/var/www/app</code>, but you want to manage all your configuration files, including <code>robots.txt</code>, from a central location like <code>/etc/nginx/assets/</code>.</p>\n<p>First, create your <code>robots.txt</code> file:</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: /etc/nginx/assets/robots.txt\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <symbol id=\"ai:devicon:nginx\" viewBox=\"0 0 128 128\"><path fill=\"#090\" d=\"M24.5 50.5c-1.5 0-2.5 1.2-2.5 2.7v14.1l-15.9-16c-.8-.8-2.2-1-3.2-.6S1 52.1 1 53.2v20.7c0 1.5 1.5 2.7 3 2.7s3-1.2 3-2.7V59.8l16.1 16c.5.5 1.2.8 1.9.8c.3 0 .4-.1.7-.2c1-.4 1.3-1.4 1.3-2.5V53.3c0-1.5-1-2.8-2.5-2.8m19.7 11.8c-1.4 0-2.7 1.4-2.7 2.8s1.3 2.8 2.7 2.8l6.6.4l-1.5 3.7h-8.5l-4.2-7.9l4.3-8.1H50l2.1 4h5.5L54 52.1l-.8-1.1H37.6l-.7 1.2L31 62.5l-.7 1.3l.7 1.3l5.8 10.3l.8 1.6h15.1l.7-1.7l4.3-9l1.9-4.3h-4.4zM65 50.5c-1.4 0-3 1.3-3 2.7V60h6v-6.7c0-1.5-1.6-2.8-3-2.8m30.4.3c-1-.4-2.4-.2-3.1.6L76 67.4V53.3c0-1.5-1-2.7-2.5-2.7S71 51.8 71 53.3V74c0 1.1.7 2.1 1.7 2.5c.3.1.7.2 1 .2c.7 0 1.6-.3 2.1-.8l16.2-16V74c0 1.5 1 2.7 2.5 2.7S97 75.5 97 74V53.3c0-1.1-.6-2.1-1.6-2.5m21.8 12.8l8.4-8.4c1.1-1.1 1.1-2.8 0-3.8c-1.1-1.1-2.8-1.1-3.8 0l-8.4 8.4l-8.4-8.4c-1.1-1.1-2.8-1.1-3.8 0c-1.1 1.1-1.1 2.8 0 3.8l8.4 8.4l-8.4 8.4c-1.1 1.1-1.1 2.8 0 3.8c.5.5 1.2.8 1.9.8s1.4-.3 1.9-.8l8.4-8.4l8.4 8.4c.5.5 1.2.8 1.9.8s1.4-.3 1.9-.8c1.1-1.1 1.1-2.8 0-3.8zM62 73.9c0 1.4 1.5 2.7 3 2.7c1.4 0 3-1.3 3-2.7V62h-6z\"/></symbol><use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>/etc/nginx/assets/robots.txt</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <symbol id=\"ai:mdi:clipboard-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-7 0a1 1 0 0 1 1 1a1 1 0 0 1-1 1a1 1 0 0 1-1-1a1 1 0 0 1 1-1M7 7h10V5h2v14H5V5h2z\"/></symbol><use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <symbol id=\"ai:mdi:check\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z\"/></symbol><use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.gmn06.css\"/ integrity=\"sha384-EvHBk7y/jI5X+qm7VnzfLWepclRlgAWQZD7xfwjGdJOb58CEIXGsErTVXjAJLdik\" crossorigin=\"anonymous\"><script type=\"module\" src=\"/_astro/ec.g1fg5.js\" integrity=\"sha384-M8ULzGSeei5Lc7d69Yvkm78ffAvmiqFZWToXjWVNFj1ueVvYDx5gZpo/aRwGXOLr\" crossorigin=\"anonymous\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"txt\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\">User-agent: * Allow: / Sitemap: https://www.example.com/sitemap.xml</span></div></div></code></pre></figure></div> </div> </div> \n<p>Now, configure your Nginx server block to intercept requests for <code>/robots.txt</code> and serve your custom file.</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: Nginx Site Configuration\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>Nginx Site Configuration</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">server</span><span class=\"ec-4bcb7326\"> {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">server_name </span><span class=\"ec-4bcb7326\">www.example.com;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># The `location =` block provides an exact match, which is highly efficient.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># See the Nginx docs for more on the `location` directive.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-3f830706\">=</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-d91a2b09\">/robots.txt </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">alias </span><span class=\"ec-4bcb7326\">/etc/nginx/assets/robots.txt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># Ensure the correct content type is served</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">add_header </span><span class=\"ec-4bcb7326\">Content-Type text/plain;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># All other requests go to your main application</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">/ </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">proxy_pass </span><span class=\"ec-4bcb7326\">http://localhost:3000;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># ... other proxy settings</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<h3 id=\"method-b-generate-content-with-return\">Method B: Generate Content with <code>return</code></h3>\n<p>If your <code>robots.txt</code> is very simple and you don’t want to manage another file, you can embed its content directly in the Nginx configuration. This is fantastic for container-based deployments where you want the entire configuration to be self-contained.</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: Nginx Site Configuration\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>Nginx Site Configuration</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">server</span><span class=\"ec-4bcb7326\"> {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">server_name </span><span class=\"ec-4bcb7326\">www.example.com;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-3f830706\">=</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-d91a2b09\">/robots.txt </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># The &#39;return 200&#39; sends a success status code with the content.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># The text must be a single string in Nginx.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-3f830706\">return</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-efe5505b\">200</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&quot;User-agent: *</span><span class=\"ec-efe5505b\">\\n</span><span class=\"ec-8ce8e394\">Disallow: /private/</span><span class=\"ec-efe5505b\">\\n</span><span class=\"ec-8ce8e394\">&quot;</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">add_header </span><span class=\"ec-4bcb7326\">Content-Type text/plain;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">/ </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">proxy_pass </span><span class=\"ec-4bcb7326\">http://localhost:3000;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<div class=\"callout callout-warning ec-e985ffc4\" data-astro-cid-mrmim4ef> <div class=\"icon ec-e985ffc4\" data-astro-cid-mrmim4ef> <svg width=\"24\" height=\"24\" data-astro-cid-mrmim4ef=\"true\" data-icon=\"mdi:alert-outline\">   <symbol id=\"ai:mdi:alert-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M12 2L1 21h22M12 6l7.53 13H4.47M11 10v4h2v-4m-2 6v2h2v-2\"/></symbol><use href=\"#ai:mdi:alert-outline\"></use>  </svg> </div> <div class=\"content ec-e985ffc4\" data-astro-cid-mrmim4ef> <p>The content in a <code>return</code> directive must be a single, unbroken string.\nNewlines (<code>\\n</code>) are permitted within the string to format the output.</p> </div> </div> \n<hr/>\n<h2 id=\"example-2-securitytxt-for-responsible-disclosure\">Example 2: <code>security.txt</code> for Responsible Disclosure</h2>\n<p>The <code>security.txt</code> file is a standard proposed by the <a href=\"https://securitytxt.org/\" rel=\"external noopener\" target=\"_blank\">security.txt project</a> that allows security researchers to easily find information on how to report vulnerabilities. It should be placed at the <code>/.well-known/security.txt</code> path.</p>\n<p>Let’s create the file content. Note the use of <code>\\n</code> for line breaks.</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: Nginx Site Configuration\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>Nginx Site Configuration</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">server</span><span class=\"ec-4bcb7326\"> {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ... server config ...</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># Use a case-sensitive match for the well-known path</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-3f830706\">=</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-d91a2b09\">/.well-known/security.txt </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-3f830706\">return</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-efe5505b\">200</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&quot;Contact: mailto:security@example.com</span><span class=\"ec-efe5505b\">\\n</span><span class=\"ec-8ce8e394\">Expires: 2026-12-31T23:59:59.000Z</span><span class=\"ec-efe5505b\">\\n</span><span class=\"ec-8ce8e394\">Preferred-Languages: en</span><span class=\"ec-efe5505b\">\\n</span><span class=\"ec-8ce8e394\">&quot;</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">add_header </span><span class=\"ec-4bcb7326\">Content-Type text/plain;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ... other locations ...</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<p>This configuration makes it easy for security researchers to get in touch, enhancing your site’s security posture, without touching your application code.</p>\n<hr/>\n<h2 id=\"example-3-humanstxt-for-credits\">Example 3: <code>humans.txt</code> for Credits</h2>\n<p>The <a href=\"https://humanstxt.org/\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Visit the humans.txt website\"><code>humans.txt</code></a> initiative is for giving credit to the people behind the website. It’s a simple, human-readable text file.</p>\n<h3 id=\"method-a-using-alias\">Method A: Using <code>alias</code></h3>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: /etc/nginx/assets/humans.txt\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>/etc/nginx/assets/humans.txt</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"txt\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\"># TEAM</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\"># Lead Developer: Jane Doe</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\"># Contact: mailto:jane@example.com</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\"># Twitter: @janedoe</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\"># SITE</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\"># Last update: 2025-12-18</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\"># Standards: HTML5, CSS3</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-2b7f17df\"># Software: Nginx, Astro</span></div></div></code></pre></figure></div> </div> </div> \n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: Nginx Site Configuration\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>Nginx Site Configuration</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-3f830706\">=</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-d91a2b09\">/humans.txt </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">alias </span><span class=\"ec-4bcb7326\">/etc/nginx/assets/humans.txt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">add_header </span><span class=\"ec-4bcb7326\">Content-Type text/plain;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<h3 id=\"method-b-using-return\">Method B: Using <code>return</code></h3>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: Nginx Site Configuration\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>Nginx Site Configuration</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-3f830706\">=</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-d91a2b09\">/humans.txt </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">return</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-efe5505b\">200</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&quot;# TEAM</span><span class=\"ec-efe5505b\">\\n</span><span class=\"ec-8ce8e394\">Lead Developer: Jane Doe</span><span class=\"ec-efe5505b\">\\n</span><span class=\"ec-8ce8e394\">Contact: mailto:jane@example.com</span><span class=\"ec-efe5505b\">\\n\\n</span><span class=\"ec-8ce8e394\"># SITE</span><span class=\"ec-efe5505b\">\\n</span><span class=\"ec-8ce8e394\">Last update: 2025-12-18</span><span class=\"ec-efe5505b\">\\n</span><span class=\"ec-8ce8e394\">&quot;</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">   <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">add_header </span><span class=\"ec-4bcb7326\">Content-Type text/plain;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<hr/>\n<h2 id=\"example-4-a-dynamic-json-health-check\">Example 4: A Dynamic JSON Health Check</h2>\n<p>Sometimes you need a simple health check endpoint that returns a JSON response, like <code>{&quot;status&quot;: &quot;ok&quot;}</code>. This is often used by load balancers or monitoring tools. Generating this with Nginx is far more efficient than waking up a full application instance just to respond.</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: Nginx Site Configuration\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>Nginx Site Configuration</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">server</span><span class=\"ec-4bcb7326\"> {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ...</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-3f830706\">=</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-d91a2b09\">/health </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># This directive is part of the standard HttpHeadersModule</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># See the docs for more on `add_header`.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">add_header </span><span class=\"ec-8ce8e394\">&#39;Content-Type&#39;</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&#39;application/json&#39;</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># Return a simple JSON object</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-3f830706\">return</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-efe5505b\">200</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&#39;{&quot;status&quot;:&quot;ok&quot;, &quot;version&quot;:&quot;1.2.3&quot;}&#39;</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># This location prevents the health check from appearing in access logs</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-3f830706\">=</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-d91a2b09\">/health </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">access_log </span><span class=\"ec-efe5505b\">off</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># ... content from previous block ...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ...</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<div class=\"callout callout-info ec-e8e3777f\" data-astro-cid-mrmim4ef> <div class=\"icon ec-e8e3777f\" data-astro-cid-mrmim4ef> <svg width=\"24\" height=\"24\" data-astro-cid-mrmim4ef=\"true\" data-icon=\"mdi:information-outline\">   <symbol id=\"ai:mdi:information-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M11 9h2V7h-2m1 13c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8m0-18A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2m-1 15h2v-6h-2z\"/></symbol><use href=\"#ai:mdi:information-outline\"></use>  </svg> </div> <div class=\"content ec-e8e3777f\" data-astro-cid-mrmim4ef> <p>To keep your logs clean, you can combine the location block with <code>access_log off;</code>. This prevents health check pings from spamming your access logs.</p> </div> </div> \n<hr/>\n<h2 id=\"example-5-lets-encrypt-http-01-challenges\">Example 5: Let’s Encrypt HTTP-01 Challenges</h2>\n<p>A very common and practical use case is handling validation for SSL certificates from <a href=\"https://letsencrypt.org/docs/challenge-types/#http-01-challenge\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Learn about HTTP-01 challenges on Let's Encrypt\">Let’s Encrypt</a>. The <code>http-01</code> challenge requires serving a specific file from the <code>/.well-known/acme-challenge/</code> directory. When running multiple services or Docker containers behind a single Nginx proxy, you can’t place the file in each application.</p>\n<p>The solution is to have Nginx intercept these requests and serve them from a common, shared directory that your ACME client (like <code>certbot</code>) can write to.</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: Nginx Site Configuration\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>Nginx Site Configuration</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">server</span><span class=\"ec-4bcb7326\"> {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ...</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-a8d21843\">/.well-known/acme-challenge/ </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># Point all requests to a common directory</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">root </span><span class=\"ec-4bcb7326\">/var/www/certbot;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ... all other locations for your app</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<p>With this configuration, no matter which <code>server_name</code> receives the validation request, Nginx will always look for the challenge file in <code>/var/www/certbot</code>. Just make sure your ACME client is configured to place its files there.</p>\n<hr/>\n<h2 id=\"example-6-mobile-app-association-files\">Example 6: Mobile App Association Files</h2>\n<p>To create seamless links between your website and your mobile app (<a href=\"https://developer.android.com/training/app-links/verify-applinks\" rel=\"external noopener\" target=\"_blank\">Android App Links</a> and <a href=\"https://developer.apple.com/documentation/xcode/supporting-associated-domains\" rel=\"external noopener\" target=\"_blank\">iOS Universal Links</a>), you need to host specific JSON files.</p>\n<ul>\n<li><strong>Android:</strong> <code>/.well-known/assetlinks.json</code></li>\n<li><strong>iOS:</strong> <code>/.well-known/apple-app-site-association</code> (note: no file extension)</li>\n</ul>\n<p>Nginx can serve both. The iOS file is particularly interesting because it <strong>must</strong> be served with the <code>application/json</code> content type.</p>\n<div class=\"file-content-wrapper copy-container\" role=\"group\" aria-label=\"Content of file: Nginx Site Configuration\" data-astro-cid-q77ummtg> <div class=\"file-header\" data-astro-cid-q77ummtg> <div class=\"file-info\" data-astro-cid-q77ummtg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 128 128\" class=\"file-icon\" data-astro-cid-q77ummtg=\"true\" data-icon=\"devicon:nginx\">   <use href=\"#ai:devicon:nginx\"></use>  </svg> <span class=\"file-name\" data-astro-cid-q77ummtg>Nginx Site Configuration</span> </div> <!-- Copy Button integrated into header --> <button class=\"copy-button file-header-copy-btn\" type=\"button\" aria-label=\"Copy to clipboard\" data-astro-cid-74lkg7sv> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"copy-icon\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:clipboard-outline\">   <use href=\"#ai:mdi:clipboard-outline\"></use>  </svg> <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"success-icon hidden\" aria-hidden=\"true\" data-astro-cid-74lkg7sv=\"true\" data-icon=\"mdi:check\">   <use href=\"#ai:mdi:check\"></use>  </svg> </button> <script lang=\"ts\">\n    document.querySelectorAll(\".copy-button\").forEach((button) => {\n        button.addEventListener(\"click\", () => {\n            let text = null;\n            const rawContent = button.getAttribute(\"data-content\");\n            if (rawContent && rawContent !== \"undefined\") {\n                try {\n                    text = decodeURIComponent(rawContent);\n                } catch (e) {\n                    console.error(\"Failed to decode data-content\", e);\n                }\n            }\n\n            if (!text) {\n                const wrapper =\n                    button.closest(\".copy-container\") || button.parentElement;\n                if (!wrapper) return;\n\n                const codeBlock = wrapper.querySelector(\"code, .copy-content\");\n                text = codeBlock\n                    ? codeBlock.innerText || codeBlock.textContent\n                    : null;\n\n                if (!text && codeBlock) text = codeBlock.textContent;\n            }\n\n            if (!text) {\n                console.warn(\"CopyButton: No code element found in wrapper.\");\n                return;\n            }\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    // Visual feedback\n                    const copyIcon = button.querySelector(\".copy-icon\");\n                    const successIcon = button.querySelector(\".success-icon\");\n\n                    if (copyIcon && successIcon) {\n                        copyIcon.classList.add(\"hidden\");\n                        successIcon.classList.remove(\"hidden\");\n\n                        setTimeout(() => {\n                            copyIcon.classList.remove(\"hidden\");\n                            successIcon.classList.add(\"hidden\");\n                        }, 1000);\n                    }\n                },\n                (err) => {\n                    console.error(\"Failed to copy:\", err);\n                    button.setAttribute(\"title\", \"Failed to copy!\");\n                },\n            );\n        });\n    });\n</script>  </div> <div class=\"file-body\" data-astro-cid-q77ummtg> <div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"nginx\"><code><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-3f830706\">server</span><span class=\"ec-4bcb7326\"> {</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ...</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># Android App Links</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-3f830706\">=</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-d91a2b09\">/.well-known/assetlinks.json </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">alias </span><span class=\"ec-4bcb7326\">/etc/nginx/assets/assetlinks.json;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">add_header </span><span class=\"ec-8ce8e394\">&#39;Content-Type&#39;</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&#39;application/json&#39;</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># iOS Universal Links</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-3f830706\">location</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-3f830706\">=</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-d91a2b09\">/.well-known/apple-app-site-association </span><span class=\"ec-4bcb7326\">{</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">alias </span><span class=\"ec-4bcb7326\">/etc/nginx/assets/apple-app-site-association;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span class=\"ec-60e18f03\"># iOS requires this specific content type</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">       <span class=\"ec-3f830706\"> </span></span><span class=\"ec-3f830706\">add_header </span><span class=\"ec-8ce8e394\">&#39;Content-Type&#39;</span><span class=\"ec-4bcb7326\"> </span><span class=\"ec-8ce8e394\">&#39;application/json&#39;</span><span class=\"ec-4bcb7326\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span class=\"ec-4bcb7326\">    </span></span><span class=\"ec-4bcb7326\">}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span class=\"ec-60e18f03\"># ...</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"ec-4bcb7326\">}</span></div></div></code></pre></figure></div> </div> </div> \n<hr/>\n<h2 id=\"conclusion\">Conclusion</h2>\n<p>By leveraging Nginx’s <code>alias</code> and <code>return</code> directives, you gain immense flexibility in how you serve content. This approach decouples standard web files from your application’s codebase, making it easier to manage deployments, secure your environment, and improve performance.</p>\n<p>Whether you’re running a Docker container, a managed Node.js service, or a complex Java application, Nginx can act as a powerful gatekeeper that serves these essential “virtual” files on your behalf, simply and efficiently.</p> <div class=\"references-section\" data-astro-cid-rn7nvbl4><div class=\"header\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" class=\"header-icon\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:book-open-page-variant-outline\">   <symbol id=\"ai:mdi:book-open-page-variant-outline\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"m19 1l-5 5v11l5-4.5zm2 4v13.5c-1.1-.35-2.3-.5-3.5-.5c-1.7 0-4.15.65-5.5 1.5V6c-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5c.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5c1.35-.85 3.8-1.5 5.5-1.5c1.65 0 3.35.3 4.75 1.05c.1.05.15.05.25.05c.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1M10 18.41C8.75 18.09 7.5 18 6.5 18c-1.06 0-2.32.19-3.5.5V7.13c.91-.4 2.14-.63 3.5-.63s2.59.23 3.5.63z\"/></symbol><use href=\"#ai:mdi:book-open-page-variant-outline\"></use>  </svg><h3 data-astro-cid-rn7nvbl4>Further Reading & Resources</h3></div><div class=\"references-grid\" data-astro-cid-rn7nvbl4><a href=\"https://nginx.org/en/docs/http/ngx_http_core_module.html#alias\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/nginx_org.webp\" alt=\"nginx.org favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <symbol id=\"ai:mdi:web\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2\"/></symbol><use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>`alias`</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>nginx.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <symbol id=\"ai:mdi:arrow-top-right\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M5 17.59L15.59 7H9V5h10v10h-2V8.41L6.41 19z\"/></symbol><use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://nginx.org/en/docs/http/ngx_http_rewrite_module.html#return\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/nginx_org.webp\" alt=\"nginx.org favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>`return`</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>nginx.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://securitytxt.org/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/securitytxt_org.webp\" alt=\"securitytxt.org favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>security.txt project</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>securitytxt.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://developer.android.com/training/app-links/verify-applinks\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Android App Links</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>developer.android.com</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://developer.apple.com/documentation/xcode/supporting-associated-domains\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>iOS Universal Links</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>developer.apple.com</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://developers.google.com/search/docs/crawling-indexing/robots/intro\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/developers_google_com.webp\" alt=\"developers.google.com favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>`robots.txt`</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>developers.google.com</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://humanstxt.org/\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><img class=\"ref-favicon\" src=\"/icons/humanstxt_org.webp\" alt=\"humanstxt.org favicon\" width=\"32\" height=\"32\" loading=\"lazy\" onerror=\"this.style.display='none'; this.nextElementSibling.classList.remove('hidden');\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon hidden\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>`humans.txt`</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>humanstxt.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a><a href=\"https://letsencrypt.org/docs/challenge-types/#http-01-challenge\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"reference-card\" data-astro-cid-rn7nvbl4><div class=\"card-icon\" data-astro-cid-rn7nvbl4><div class=\"fallback-icon \" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:web\">   <use href=\"#ai:mdi:web\"></use>  </svg></div></div><div class=\"card-content\" data-astro-cid-rn7nvbl4><span class=\"ref-text\" data-astro-cid-rn7nvbl4>Let&#39;s Encrypt</span><span class=\"ref-url\" data-astro-cid-rn7nvbl4>letsencrypt.org</span></div><div class=\"card-arrow\" data-astro-cid-rn7nvbl4><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" data-astro-cid-rn7nvbl4=\"true\" data-icon=\"mdi:arrow-top-right\">   <use href=\"#ai:mdi:arrow-top-right\"></use>  </svg></div></a></div></div> </div> </div> </article> <button id=\"toc-toggle-btn\" type=\"button\" class=\"toc-fab toc-trigger mobile-only\" aria-label=\"Table of Contents\" aria-haspopup=\"true\" aria-expanded=\"false\" data-astro-cid-ozdpo5e6><svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" class=\"toc-icon\" data-astro-cid-ozdpo5e6=\"true\" data-icon=\"mdi:format-list-bulleted\">   <use href=\"#ai:mdi:format-list-bulleted\"></use>  </svg></button><div id=\"toc-drawer\" class=\"toc-drawer\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"toc-title\" aria-hidden=\"true\" inert data-astro-cid-ozdpo5e6><div class=\"toc-header\" data-astro-cid-ozdpo5e6><h2 id=\"toc-title\" data-astro-cid-ozdpo5e6>Table of Contents</h2><button id=\"toc-close-btn\" type=\"button\" class=\"toc-close\" aria-label=\"Close\" data-astro-cid-ozdpo5e6><svg width=\"1em\" height=\"1em\" data-astro-cid-ozdpo5e6=\"true\" data-icon=\"mdi:close\">   <symbol id=\"ai:mdi:close\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z\"/></symbol><use href=\"#ai:mdi:close\"></use>  </svg></button></div><nav class=\"toc-content\" data-astro-cid-ozdpo5e6><ul data-astro-cid-ozdpo5e6><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#the-core-techniques\" data-astro-cid-ozdpo5e6>The Core Techniques</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#example-1-the-ubiquitous-robotstxt\" data-astro-cid-ozdpo5e6>Example 1: The Ubiquitous robots.txt</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#method-a-serve-a-local-file-with-alias\" data-astro-cid-ozdpo5e6>Method A: Serve a Local File with alias</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#method-b-generate-content-with-return\" data-astro-cid-ozdpo5e6>Method B: Generate Content with return</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#example-2-securitytxt-for-responsible-disclosure\" data-astro-cid-ozdpo5e6>Example 2: security.txt for Responsible Disclosure</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#example-3-humanstxt-for-credits\" data-astro-cid-ozdpo5e6>Example 3: humans.txt for Credits</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#method-a-using-alias\" data-astro-cid-ozdpo5e6>Method A: Using alias</a></li><li class=\"toc-depth-3\" data-astro-cid-ozdpo5e6><a href=\"#method-b-using-return\" data-astro-cid-ozdpo5e6>Method B: Using return</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#example-4-a-dynamic-json-health-check\" data-astro-cid-ozdpo5e6>Example 4: A Dynamic JSON Health Check</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#example-5-lets-encrypt-http-01-challenges\" data-astro-cid-ozdpo5e6>Example 5: Let’s Encrypt HTTP-01 Challenges</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#example-6-mobile-app-association-files\" data-astro-cid-ozdpo5e6>Example 6: Mobile App Association Files</a></li><li class=\"toc-depth-2\" data-astro-cid-ozdpo5e6><a href=\"#conclusion\" data-astro-cid-ozdpo5e6>Conclusion</a></li></ul></nav></div><div id=\"toc-backdrop\" class=\"toc-backdrop\" data-astro-cid-ozdpo5e6></div><script type=\"module\">function r(){const n=document.querySelectorAll(\".toc-trigger\"),e=document.getElementById(\"toc-drawer\"),s=document.getElementById(\"toc-close-btn\"),o=document.getElementById(\"toc-backdrop\"),i=e?.querySelectorAll(\"a\");if(!n.length||!e||!o)return;let d=null;const a=()=>{d=document.activeElement,e.classList.add(\"open\"),o.classList.add(\"open\"),n.forEach(t=>t.setAttribute(\"aria-expanded\",\"true\")),e.setAttribute(\"aria-hidden\",\"false\"),e.removeAttribute(\"inert\"),s&&s.focus(),window.innerWidth<1024&&(document.body.style.overflow=\"hidden\")},c=()=>{d?d.focus():n.length>0?n[0].focus():document.activeElement?.blur(),e.classList.remove(\"open\"),o.classList.remove(\"open\"),n.forEach(t=>t.setAttribute(\"aria-expanded\",\"false\")),e.setAttribute(\"aria-hidden\",\"true\"),e.setAttribute(\"inert\",\"\"),document.body.style.overflow=\"\"};n.forEach(t=>t.addEventListener(\"click\",a)),s?.addEventListener(\"click\",c),o.addEventListener(\"click\",c),i?.forEach(t=>{t.addEventListener(\"click\",()=>{c()})}),document.addEventListener(\"keydown\",t=>{t.key===\"Escape\"&&e.classList.contains(\"open\")&&c()})}document.addEventListener(\"DOMContentLoaded\",r);document.addEventListener(\"astro:after-swap\",r);</script>   </main> <footer data-astro-cid-sz7xmlte> <div class=\"container\" data-astro-cid-sz7xmlte> <p data-astro-cid-sz7xmlte>\n&copy; 2025 José Manuel Requena Plens. All rights reserved.\n</p> <div class=\"social-links\" data-astro-cid-sz7xmlte> <a href=\"https://github.com/jmrplens\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"GitHub\" title=\"GitHub\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"0.97em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-brands:github\">   <symbol id=\"ai:fa-brands:github\" viewBox=\"0 0 496 512\"><path fill=\"currentColor\" d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2\"/></symbol><use href=\"#ai:fa-brands:github\"></use>  </svg>   </a><a href=\"https://linkedin.com/in/jmrplens\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"LinkedIn\" title=\"LinkedIn\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"0.88em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-brands:linkedin\">   <symbol id=\"ai:fa-brands:linkedin\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9z\"/></symbol><use href=\"#ai:fa-brands:linkedin\"></use>  </svg>   </a><a href=\"https://mstdn.jmrp.io/@jmrplens\" target=\"_blank\" rel=\"me\" aria-label=\"Mastodon\" title=\"Mastodon\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"0.88em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-brands:mastodon\">   <symbol id=\"ai:fa-brands:mastodon\" viewBox=\"0 0 448 512\"><path fill=\"currentColor\" d=\"M433 179.11c0-97.2-63.71-125.7-63.71-125.7c-62.52-28.7-228.56-28.4-290.48 0c0 0-63.72 28.5-63.72 125.7c0 115.7-6.6 259.4 105.63 289.1c40.51 10.7 75.32 13 103.33 11.4c50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.5 102.5 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7c56.12-6.7 105-41.3 111.23-72.9c9.8-49.8 9-121.5 9-121.5m-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175c25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5l11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1c23.71 27.3 18.4 53 18.4 175z\"/></symbol><use href=\"#ai:fa-brands:mastodon\"></use>  </svg>   </a><a href=\"https://scholar.google.com/citations?user=9b0kPaUAAAAJ\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Google Scholar\" title=\"Google Scholar\" class=\"social-btn\" data-astro-cid-sz7xmlte> <svg width=\"1.25em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"fa-solid:graduation-cap\">   <symbol id=\"ai:fa-solid:graduation-cap\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87c.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6M352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47z\"/></symbol><use href=\"#ai:fa-solid:graduation-cap\"></use>  </svg>   </a><a href=\"https://matrix.to/#/@jmrplens:matrix.jmrp.io\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Matrix\" title=\"Matrix\" class=\"social-btn\" data-astro-cid-sz7xmlte>  <svg width=\"1em\" height=\"1em\" class=\"social-icon-svg\" data-astro-cid-sz7xmlte=\"true\" data-icon=\"simple-icons:matrix\">   <symbol id=\"ai:simple-icons:matrix\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M.632.55v22.9H2.28V24H0V0h2.28v.55zm7.043 7.26v1.157h.033a3.3 3.3 0 0 1 1.117-1.024c.433-.245.936-.365 1.5-.365q.81.002 1.481.314c.448.208.785.582 1.02 1.108q.382-.562 1.034-.992q.651-.43 1.546-.43q.679 0 1.26.167c.388.11.716.286.993.53c.276.245.489.559.646.951q.229.587.23 1.417v5.728h-2.349V11.52q0-.43-.032-.812a1.8 1.8 0 0 0-.18-.66a1.1 1.1 0 0 0-.438-.448q-.292-.165-.785-.166q-.498 0-.803.189a1.4 1.4 0 0 0-.48.499a2 2 0 0 0-.231.696a6 6 0 0 0-.06.785v4.768h-2.35v-4.8q.002-.38-.018-.752a2.1 2.1 0 0 0-.143-.688a1.05 1.05 0 0 0-.415-.503c-.194-.125-.476-.19-.854-.19q-.168 0-.439.074c-.18.051-.36.143-.53.282a1.64 1.64 0 0 0-.439.595q-.18.39-.18 1.02v4.966H5.46V7.81zm15.693 15.64V.55H21.72V0H24v24h-2.28v-.55z\"/></symbol><use href=\"#ai:simple-icons:matrix\"></use>  </svg>  </a> </div> </div> </footer>   </body> </html> <script type=\"module\">document.addEventListener(\"DOMContentLoaded\",()=>{const o=document.querySelector(\".toc\");if(!o)return;new IntersectionObserver(e=>{e.forEach(s=>{s.isIntersecting?document.body.classList.remove(\"desktop-toc-visible\"):document.body.classList.add(\"desktop-toc-visible\")})},{rootMargin:`-${getComputedStyle(document.documentElement).getPropertyValue(\"--header-height\").trim()} 0px 0px 0px`,threshold:0}).observe(o)});document.addEventListener(\"DOMContentLoaded\",()=>{const o=document.querySelector(\".prose\");if(!o)return;o.querySelectorAll(\".expressive-code\").forEach(e=>{if(e.closest(\".file-content-wrapper\")||e.closest(\".tab-panel\")||e.closest(\".compare-block\"))return;const s=e.querySelector(\".copy\");if(s instanceof HTMLElement&&(s.style.display=\"none\"),e.querySelector(\".custom-code-copy-btn\"))return;const t=document.createElement(\"button\");t.className=\"custom-code-copy-btn\",t.setAttribute(\"aria-label\",\"Copy to clipboard\"),t.innerHTML=`\n                <svg class=\"copy-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\">\n                    <path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\" />\n                </svg>\n                <svg class=\"success-icon hidden\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\">\n                    <path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\" />\n                </svg>\n            `,t.addEventListener(\"click\",()=>{const r=e.querySelector(\"code\"),i=r?r.textContent:null;if(!i){console.warn(\"No code element found in block.\");return}navigator.clipboard.writeText(i).then(()=>{const n=t.querySelector(\".copy-icon\"),c=t.querySelector(\".success-icon\");n instanceof HTMLElement&&c instanceof HTMLElement&&(n.classList.add(\"hidden\"),c.classList.remove(\"hidden\"),setTimeout(()=>{n.classList.remove(\"hidden\"),c.classList.add(\"hidden\")},2e3))},n=>{console.error(\"Failed to copy:\",n)})}),e instanceof HTMLElement&&(e.style.position=\"relative\"),e.appendChild(t)})});</script> "}]